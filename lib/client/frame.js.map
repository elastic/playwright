{"version":3,"sources":["../../src/client/frame.ts"],"names":["Frame","ChannelOwner","from","frame","_object","fromNullable","constructor","parent","type","guid","initializer","_eventEmitter","_loadStates","_parentFrame","_url","_name","_detached","_childFrames","Set","_page","EventEmitter","setMaxListeners","parentFrame","add","name","url","loadStates","_channel","on","event","emit","remove","delete","error","Events","Page","FrameNavigated","page","goto","options","_wrapApiCall","channel","waitUntil","verifyLoadState","undefined","network","Response","response","_setupNavigationWaiter","waiter","Waiter","isClosed","rejectImmediately","Error","rejectOnEvent","Close","Crash","FrameDetached","timeout","_timeoutSettings","navigationTimeout","rejectOnTimeout","waitForNavigation","toUrl","log","navigatedEvent","waitForEvent","context","_options","baseURL","e","stack","waitForPromise","Promise","reject","has","s","request","newDocument","Request","_finalRequest","dispose","waitForLoadState","state","waitForURL","frameElement","ElementHandle","element","evaluateHandle","pageFunction","arg","arguments","length","result","evaluateExpressionHandle","expression","String","isFunction","JSHandle","handle","evaluate","evaluateExpression","value","$","selector","querySelector","waitForSelector","visibility","waitFor","dispatchEvent","eventInit","$eval","evalOnSelector","$$eval","evalOnSelectorAll","$$","querySelectorAll","elements","map","content","setContent","html","childFrames","Array","isDetached","addScriptTag","copy","path","fs","promises","readFile","toString","replace","addStyleTag","click","dblclick","dragAndDrop","source","target","tap","fill","locator","Locator","focus","textContent","innerText","innerHTML","getAttribute","inputValue","isChecked","isDisabled","isEditable","isEnabled","isHidden","isVisible","hover","selectOption","values","setInputFiles","files","text","press","key","check","uncheck","waitForTimeout","fulfill","setTimeout","waitForFunction","polling","pollingInterval","title","kLifecycleEvents"],"mappings":"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","sourcesContent":["/**\n * Copyright 2017 Google Inc. All rights reserved.\n * Modifications copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '../utils/utils';\nimport * as channels from '../protocol/channels';\nimport { ChannelOwner } from './channelOwner';\nimport { Locator } from './locator';\nimport { ElementHandle, convertSelectOptionValues, convertInputFiles } from './elementHandle';\nimport { assertMaxArguments, JSHandle, serializeArgument, parseResult } from './jsHandle';\nimport fs from 'fs';\nimport * as network from './network';\nimport { Page } from './page';\nimport { EventEmitter } from 'events';\nimport { Waiter } from './waiter';\nimport { Events } from './events';\nimport { LifecycleEvent, URLMatch, SelectOption, SelectOptionOptions, FilePayload, WaitForFunctionOptions, kLifecycleEvents, StrictOptions } from './types';\nimport { urlMatches } from './clientHelper';\nimport * as api from '../../types/types';\nimport * as structs from '../../types/structs';\n\nexport type WaitForNavigationOptions = {\n  timeout?: number,\n  waitUntil?: LifecycleEvent,\n  url?: URLMatch,\n};\n\nexport class Frame extends ChannelOwner<channels.FrameChannel, channels.FrameInitializer> implements api.Frame {\n  _eventEmitter: EventEmitter;\n  _loadStates: Set<LifecycleEvent>;\n  _parentFrame: Frame | null = null;\n  _url = '';\n  _name = '';\n  _detached = false;\n  _childFrames = new Set<Frame>();\n  _page: Page | undefined;\n\n  static from(frame: channels.FrameChannel): Frame {\n    return (frame as any)._object;\n  }\n\n  static fromNullable(frame: channels.FrameChannel | undefined): Frame | null {\n    return frame ? Frame.from(frame) : null;\n  }\n\n  constructor(parent: ChannelOwner, type: string, guid: string, initializer: channels.FrameInitializer) {\n    super(parent, type, guid, initializer);\n    this._eventEmitter = new EventEmitter();\n    this._eventEmitter.setMaxListeners(0);\n    this._parentFrame = Frame.fromNullable(initializer.parentFrame);\n    if (this._parentFrame)\n      this._parentFrame._childFrames.add(this);\n    this._name = initializer.name;\n    this._url = initializer.url;\n    this._loadStates = new Set(initializer.loadStates);\n    this._channel.on('loadstate', event => {\n      if (event.add) {\n        this._loadStates.add(event.add);\n        this._eventEmitter.emit('loadstate', event.add);\n      }\n      if (event.remove)\n        this._loadStates.delete(event.remove);\n    });\n    this._channel.on('navigated', event => {\n      this._url = event.url;\n      this._name = event.name;\n      this._eventEmitter.emit('navigated', event);\n      if (!event.error && this._page)\n        this._page.emit(Events.Page.FrameNavigated, this);\n    });\n  }\n\n  page(): Page {\n    return this._page!;\n  }\n\n  async goto(url: string, options: channels.FrameGotoOptions = {}): Promise<network.Response | null> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      const waitUntil = verifyLoadState('waitUntil', options.waitUntil === undefined ? 'load' : options.waitUntil);\n      return network.Response.fromNullable((await channel.goto({ url, ...options, waitUntil })).response);\n    });\n  }\n\n  private _setupNavigationWaiter(options: { timeout?: number }): Waiter {\n    const waiter = new Waiter(this._page!, '');\n    if (this._page!.isClosed())\n      waiter.rejectImmediately(new Error('Navigation failed because page was closed!'));\n    waiter.rejectOnEvent(this._page!, Events.Page.Close, new Error('Navigation failed because page was closed!'));\n    waiter.rejectOnEvent(this._page!, Events.Page.Crash, new Error('Navigation failed because page crashed!'));\n    waiter.rejectOnEvent<Frame>(this._page!, Events.Page.FrameDetached, new Error('Navigating frame was detached!'), frame => frame === this);\n    const timeout = this._page!._timeoutSettings.navigationTimeout(options);\n    waiter.rejectOnTimeout(timeout, `Timeout ${timeout}ms exceeded.`);\n    return waiter;\n  }\n\n  async waitForNavigation(options: WaitForNavigationOptions = {}): Promise<network.Response | null> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      const waitUntil = verifyLoadState('waitUntil', options.waitUntil === undefined ? 'load' : options.waitUntil);\n      const waiter = this._setupNavigationWaiter(options);\n\n      const toUrl = typeof options.url === 'string' ? ` to \"${options.url}\"` : '';\n      waiter.log(`waiting for navigation${toUrl} until \"${waitUntil}\"`);\n\n      const navigatedEvent = await waiter.waitForEvent<channels.FrameNavigatedEvent>(this._eventEmitter, 'navigated', event => {\n        // Any failed navigation results in a rejection.\n        if (event.error)\n          return true;\n        waiter.log(`  navigated to \"${event.url}\"`);\n        return urlMatches(this._page?.context()._options.baseURL, event.url, options.url);\n      });\n      if (navigatedEvent.error) {\n        const e = new Error(navigatedEvent.error);\n        e.stack = '';\n        await waiter.waitForPromise(Promise.reject(e));\n      }\n\n      if (!this._loadStates.has(waitUntil)) {\n        await waiter.waitForEvent<LifecycleEvent>(this._eventEmitter, 'loadstate', s => {\n          waiter.log(`  \"${s}\" event fired`);\n          return s === waitUntil;\n        });\n      }\n\n      const request = navigatedEvent.newDocument ? network.Request.fromNullable(navigatedEvent.newDocument.request) : null;\n      const response = request ? await waiter.waitForPromise(request._finalRequest().response()) : null;\n      waiter.dispose();\n      return response;\n    });\n  }\n\n  async waitForLoadState(state: LifecycleEvent = 'load', options: { timeout?: number } = {}): Promise<void> {\n    state = verifyLoadState('state', state);\n    if (this._loadStates.has(state))\n      return;\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      const waiter = this._setupNavigationWaiter(options);\n      await waiter.waitForEvent<LifecycleEvent>(this._eventEmitter, 'loadstate', s => {\n        waiter.log(`  \"${s}\" event fired`);\n        return s === state;\n      });\n      waiter.dispose();\n    });\n  }\n\n  async waitForURL(url: URLMatch, options: { waitUntil?: LifecycleEvent, timeout?: number } = {}): Promise<void> {\n    if (urlMatches(this._page?.context()._options.baseURL, this.url(), url))\n      return await this.waitForLoadState(options?.waitUntil, options);\n    await this.waitForNavigation({ url, ...options });\n  }\n\n  async frameElement(): Promise<ElementHandle> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return ElementHandle.from((await channel.frameElement()).element);\n    });\n  }\n\n  async evaluateHandle<R, Arg>(pageFunction: structs.PageFunction<Arg, R>, arg?: Arg): Promise<structs.SmartHandle<R>> {\n    assertMaxArguments(arguments.length, 2);\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      const result = await channel.evaluateExpressionHandle({ expression: String(pageFunction), isFunction: typeof pageFunction === 'function', arg: serializeArgument(arg) });\n      return JSHandle.from(result.handle) as any as structs.SmartHandle<R>;\n    });\n  }\n\n  async evaluate<R, Arg>(pageFunction: structs.PageFunction<Arg, R>, arg?: Arg): Promise<R> {\n    assertMaxArguments(arguments.length, 2);\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      const result = await channel.evaluateExpression({ expression: String(pageFunction), isFunction: typeof pageFunction === 'function', arg: serializeArgument(arg) });\n      return parseResult(result.value);\n    });\n  }\n\n  async $(selector: string, options?: { strict?: boolean }): Promise<ElementHandle<SVGElement | HTMLElement> | null> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      const result = await channel.querySelector({ selector, ...options });\n      return ElementHandle.fromNullable(result.element) as ElementHandle<SVGElement | HTMLElement> | null;\n    });\n  }\n\n  waitForSelector(selector: string, options: channels.FrameWaitForSelectorOptions & { state: 'attached' | 'visible' }): Promise<ElementHandle<SVGElement | HTMLElement>>;\n  waitForSelector(selector: string, options?: channels.FrameWaitForSelectorOptions): Promise<ElementHandle<SVGElement | HTMLElement> | null>;\n  async waitForSelector(selector: string, options: channels.FrameWaitForSelectorOptions = {}): Promise<ElementHandle<SVGElement | HTMLElement> | null> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      if ((options as any).visibility)\n        throw new Error('options.visibility is not supported, did you mean options.state?');\n      if ((options as any).waitFor && (options as any).waitFor !== 'visible')\n        throw new Error('options.waitFor is not supported, did you mean options.state?');\n      const result = await channel.waitForSelector({ selector, ...options });\n      return ElementHandle.fromNullable(result.element) as ElementHandle<SVGElement | HTMLElement> | null;\n    });\n  }\n\n  async dispatchEvent(selector: string, type: string, eventInit?: any, options: channels.FrameDispatchEventOptions = {}): Promise<void> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      await channel.dispatchEvent({ selector, type, eventInit: serializeArgument(eventInit), ...options });\n    });\n  }\n\n  async $eval<R, Arg>(selector: string, pageFunction: structs.PageFunctionOn<Element, Arg, R>, arg?: Arg): Promise<R> {\n    assertMaxArguments(arguments.length, 3);\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      const result = await channel.evalOnSelector({ selector, expression: String(pageFunction), isFunction: typeof pageFunction === 'function', arg: serializeArgument(arg) });\n      return parseResult(result.value);\n    });\n  }\n\n  async $$eval<R, Arg>(selector: string, pageFunction: structs.PageFunctionOn<Element[], Arg, R>, arg?: Arg): Promise<R> {\n    assertMaxArguments(arguments.length, 3);\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      const result = await channel.evalOnSelectorAll({ selector, expression: String(pageFunction), isFunction: typeof pageFunction === 'function', arg: serializeArgument(arg) });\n      return parseResult(result.value);\n    });\n  }\n\n  async $$(selector: string): Promise<ElementHandle<SVGElement | HTMLElement>[]> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      const result = await channel.querySelectorAll({ selector });\n      return result.elements.map(e => ElementHandle.from(e) as ElementHandle<SVGElement | HTMLElement>);\n    });\n  }\n\n  async content(): Promise<string> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return (await channel.content()).value;\n    });\n  }\n\n  async setContent(html: string, options: channels.FrameSetContentOptions = {}): Promise<void> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      const waitUntil = verifyLoadState('waitUntil', options.waitUntil === undefined ? 'load' : options.waitUntil);\n      await channel.setContent({ html, ...options, waitUntil });\n    });\n  }\n\n  name(): string {\n    return this._name || '';\n  }\n\n  url(): string {\n    return this._url;\n  }\n\n  parentFrame(): Frame | null {\n    return this._parentFrame;\n  }\n\n  childFrames(): Frame[] {\n    return Array.from(this._childFrames);\n  }\n\n  isDetached(): boolean {\n    return this._detached;\n  }\n\n  async addScriptTag(options: { url?: string, path?: string, content?: string, type?: string } = {}): Promise<ElementHandle> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      const copy = { ...options };\n      if (copy.path) {\n        copy.content = (await fs.promises.readFile(copy.path)).toString();\n        copy.content += '//# sourceURL=' + copy.path.replace(/\\n/g, '');\n      }\n      return ElementHandle.from((await channel.addScriptTag({ ...copy })).element);\n    });\n  }\n\n  async addStyleTag(options: { url?: string; path?: string; content?: string; } = {}): Promise<ElementHandle> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      const copy = { ...options };\n      if (copy.path) {\n        copy.content = (await fs.promises.readFile(copy.path)).toString();\n        copy.content += '/*# sourceURL=' + copy.path.replace(/\\n/g, '') + '*/';\n      }\n      return ElementHandle.from((await channel.addStyleTag({ ...copy })).element);\n    });\n  }\n\n  async click(selector: string, options: channels.FrameClickOptions = {}) {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return await channel.click({ selector, ...options });\n    });\n  }\n\n  async dblclick(selector: string, options: channels.FrameDblclickOptions = {}) {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return await channel.dblclick({ selector, ...options });\n    });\n  }\n\n  async dragAndDrop(source: string, target: string, options: channels.FrameDragAndDropOptions = {}) {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return await channel.dragAndDrop({ source, target, ...options });\n    });\n  }\n\n  async tap(selector: string, options: channels.FrameTapOptions = {}) {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return await channel.tap({ selector, ...options });\n    });\n  }\n\n  async fill(selector: string, value: string, options: channels.FrameFillOptions = {}) {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return await channel.fill({ selector, value, ...options });\n    });\n  }\n\n  locator(selector: string): Locator {\n    return new Locator(this, selector);\n  }\n\n  async focus(selector: string, options: channels.FrameFocusOptions = {}) {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      await channel.focus({ selector, ...options });\n    });\n  }\n\n  async textContent(selector: string, options: channels.FrameTextContentOptions = {}): Promise<null|string> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      const value = (await channel.textContent({ selector, ...options })).value;\n      return value === undefined ? null : value;\n    });\n  }\n\n  async innerText(selector: string, options: channels.FrameInnerTextOptions = {}): Promise<string> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return (await channel.innerText({ selector, ...options })).value;\n    });\n  }\n\n  async innerHTML(selector: string, options: channels.FrameInnerHTMLOptions = {}): Promise<string> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return (await channel.innerHTML({ selector, ...options })).value;\n    });\n  }\n\n  async getAttribute(selector: string, name: string, options: channels.FrameGetAttributeOptions = {}): Promise<string | null> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      const value = (await channel.getAttribute({ selector, name, ...options })).value;\n      return value === undefined ? null : value;\n    });\n  }\n\n  async inputValue(selector: string, options: channels.FrameInputValueOptions = {}): Promise<string> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return (await channel.inputValue({ selector, ...options })).value;\n    });\n  }\n\n  async isChecked(selector: string, options: channels.FrameIsCheckedOptions = {}): Promise<boolean> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return (await channel.isChecked({ selector, ...options })).value;\n    });\n  }\n\n  async isDisabled(selector: string, options: channels.FrameIsDisabledOptions = {}): Promise<boolean> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return (await channel.isDisabled({ selector, ...options })).value;\n    });\n  }\n\n  async isEditable(selector: string, options: channels.FrameIsEditableOptions = {}): Promise<boolean> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return (await channel.isEditable({ selector, ...options })).value;\n    });\n  }\n\n  async isEnabled(selector: string, options: channels.FrameIsEnabledOptions = {}): Promise<boolean> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return (await channel.isEnabled({ selector, ...options })).value;\n    });\n  }\n\n  async isHidden(selector: string, options: channels.FrameIsHiddenOptions = {}): Promise<boolean> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return (await channel.isHidden({ selector, ...options })).value;\n    });\n  }\n\n  async isVisible(selector: string, options: channels.FrameIsVisibleOptions = {}): Promise<boolean> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return (await channel.isVisible({ selector, ...options })).value;\n    });\n  }\n\n  async hover(selector: string, options: channels.FrameHoverOptions = {}) {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      await channel.hover({ selector, ...options });\n    });\n  }\n\n  async selectOption(selector: string, values: string | api.ElementHandle | SelectOption | string[] | api.ElementHandle[] | SelectOption[] | null, options: SelectOptionOptions & StrictOptions = {}): Promise<string[]> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return (await channel.selectOption({ selector, ...convertSelectOptionValues(values), ...options })).values;\n    });\n  }\n\n  async setInputFiles(selector: string, files: string | FilePayload | string[] | FilePayload[], options: channels.FrameSetInputFilesOptions = {}): Promise<void> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      await channel.setInputFiles({ selector, files: await convertInputFiles(files), ...options });\n    });\n  }\n\n  async type(selector: string, text: string, options: channels.FrameTypeOptions = {}) {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      await channel.type({ selector, text, ...options });\n    });\n  }\n\n  async press(selector: string, key: string, options: channels.FramePressOptions = {}) {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      await channel.press({ selector, key, ...options });\n    });\n  }\n\n  async check(selector: string, options: channels.FrameCheckOptions = {}) {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      await channel.check({ selector, ...options });\n    });\n  }\n\n  async uncheck(selector: string, options: channels.FrameUncheckOptions = {}) {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      await channel.uncheck({ selector, ...options });\n    });\n  }\n\n  async waitForTimeout(timeout: number) {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      await new Promise(fulfill => setTimeout(fulfill, timeout));\n    });\n  }\n\n  async waitForFunction<R, Arg>(pageFunction: structs.PageFunction<Arg, R>, arg?: Arg, options: WaitForFunctionOptions = {}): Promise<structs.SmartHandle<R>> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      if (typeof options.polling === 'string')\n        assert(options.polling === 'raf', 'Unknown polling option: ' + options.polling);\n      const result = await channel.waitForFunction({\n        ...options,\n        pollingInterval: options.polling === 'raf' ? undefined : options.polling,\n        expression: String(pageFunction),\n        isFunction: typeof pageFunction === 'function',\n        arg: serializeArgument(arg),\n      });\n      return JSHandle.from(result.handle) as any as structs.SmartHandle<R>;\n    });\n  }\n\n  async title(): Promise<string> {\n    return this._wrapApiCall(async (channel: channels.FrameChannel) => {\n      return (await channel.title()).value;\n    });\n  }\n}\n\nexport function verifyLoadState(name: string, waitUntil: LifecycleEvent): LifecycleEvent {\n  if (waitUntil as unknown === 'networkidle0')\n    waitUntil = 'networkidle';\n  if (!kLifecycleEvents.has(waitUntil))\n    throw new Error(`${name}: expected one of (load|domcontentloaded|networkidle)`);\n  return waitUntil;\n}\n"],"file":"frame.js"}