{"version":3,"sources":["../../src/client/page.ts"],"names":["Page","ChannelOwner","from","page","_object","fromNullable","constructor","parent","type","guid","initializer","_browserContext","_ownedContext","_mainFrame","_frames","Set","_workers","_closed","_closedOrCrashedPromise","_viewportSize","_routes","accessibility","coverage","keyboard","mouse","touchscreen","_bindings","Map","_timeoutSettings","_video","_opener","TimeoutSettings","Accessibility","_channel","Keyboard","Mouse","Touchscreen","Frame","mainFrame","_page","add","viewportSize","isClosed","opener","on","binding","_onBinding","BindingCall","_onClose","message","emit","Events","Console","ConsoleMessage","_onCrash","dialog","Dialog","dismiss","catch","DOMContentLoaded","url","suggestedFilename","artifact","artifactObject","Artifact","_isRemote","_browser","_remoteType","Download","element","isMultiple","FileChooser","ElementHandle","frame","_onFrameAttached","_onFrameDetached","Load","error","PageError","route","request","_onRoute","Route","Request","_forceVideo","_artifactReady","webSocket","WebSocket","worker","_onWorker","Worker","Coverage","Promise","race","f","once","Close","Crash","_parentFrame","_childFrames","FrameAttached","delete","_detached","FrameDetached","handler","_options","baseURL","bindingCall","func","get","_initializer","name","call","_pages","_backgroundPages","context","frameSelector","undefined","frames","find","setDefaultNavigationTimeout","timeout","setDefaultNavigationTimeoutNoReply","setDefaultTimeout","setDefaultTimeoutNoReply","Video","video","recordVideo","$","selector","options","waitForSelector","dispatchEvent","eventInit","evaluateHandle","pageFunction","arg","arguments","length","$eval","$$eval","$$","addScriptTag","addStyleTag","exposeFunction","callback","_wrapApiCall","channel","exposeBinding","source","args","set","needsHandle","handle","setExtraHTTPHeaders","headers","content","setContent","html","goto","reload","waitUntil","Response","response","waitForLoadState","state","waitForNavigation","waitForURL","waitForRequest","urlOrPredicate","predicate","trimmedUrl","trimUrl","logLine","_waitForEvent","waitForResponse","waitForEvent","event","optionsOrPredicate","waiter","Waiter","createForEvent","log","rejectOnTimeout","rejectOnEvent","Error","result","dispose","goBack","goForward","emulateMedia","media","colorScheme","reducedMotion","setViewportSize","evaluate","addInitScript","script","unshift","setNetworkInterceptionEnabled","enabled","unroute","filter","screenshot","copy","buffer","Buffer","binary","path","fs","promises","writeFile","title","bringToFront","close","runBeforeUnload","e","click","dragAndDrop","target","dblclick","tap","fill","value","locator","focus","textContent","innerText","innerHTML","getAttribute","inputValue","isChecked","isDisabled","isEditable","isEnabled","isHidden","isVisible","hover","selectOption","values","setInputFiles","files","text","press","key","check","uncheck","waitForTimeout","waitForFunction","workers","listener","listenerCount","setFileChooserInterceptedNoReply","intercepted","addListener","off","removeListener","pause","pdf","transportOptions","margin","width","height","index","mkdir","dirname","recursive","JSHandle","map","parseResult","resolve","reject","trimEnd","s","substring","param","flags"],"mappings":"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","sourcesContent":["/**\n * Copyright 2017 Google Inc. All rights reserved.\n * Modifications copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Events } from './events';\nimport { assert } from '../utils/utils';\nimport { TimeoutSettings } from '../utils/timeoutSettings';\nimport * as channels from '../protocol/channels';\nimport { parseError, serializeError } from '../protocol/serializers';\nimport { Accessibility } from './accessibility';\nimport { BrowserContext } from './browserContext';\nimport { ChannelOwner } from './channelOwner';\nimport { ConsoleMessage } from './consoleMessage';\nimport { Dialog } from './dialog';\nimport { Download } from './download';\nimport { ElementHandle, determineScreenshotType } from './elementHandle';\nimport { Locator } from './locator';\nimport { Worker } from './worker';\nimport { Frame, verifyLoadState, WaitForNavigationOptions } from './frame';\nimport { Keyboard, Mouse, Touchscreen } from './input';\nimport { assertMaxArguments, serializeArgument, parseResult, JSHandle } from './jsHandle';\nimport { Request, Response, Route, RouteHandler, WebSocket, validateHeaders } from './network';\nimport { FileChooser } from './fileChooser';\nimport { Buffer } from 'buffer';\nimport { Coverage } from './coverage';\nimport { Waiter } from './waiter';\nimport * as api from '../../types/types';\nimport * as structs from '../../types/structs';\nimport fs from 'fs';\nimport path from 'path';\nimport { Size, URLMatch, Headers, LifecycleEvent, WaitForEventOptions, SelectOption, SelectOptionOptions, FilePayload, WaitForFunctionOptions } from './types';\nimport { evaluationScript, urlMatches } from './clientHelper';\nimport { isString, isRegExp, isObject, mkdirIfNeeded, headersObjectToArray } from '../utils/utils';\nimport { isSafeCloseError } from '../utils/errors';\nimport { Video } from './video';\nimport { Artifact } from './artifact';\n\ntype PDFOptions = Omit<channels.PagePdfParams, 'width' | 'height' | 'margin'> & {\n  width?: string | number,\n  height?: string | number,\n  margin?: {\n    top?: string | number,\n    bottom?: string | number,\n    left?: string | number,\n    right?: string | number\n  },\n  path?: string,\n};\ntype Listener = (...args: any[]) => void;\n\nexport class Page extends ChannelOwner<channels.PageChannel, channels.PageInitializer> implements api.Page {\n  private _browserContext: BrowserContext;\n  _ownedContext: BrowserContext | undefined;\n\n  private _mainFrame: Frame;\n  private _frames = new Set<Frame>();\n  _workers = new Set<Worker>();\n  private _closed = false;\n  _closedOrCrashedPromise: Promise<void>;\n  private _viewportSize: Size | null;\n  private _routes: { url: URLMatch, handler: RouteHandler }[] = [];\n\n  readonly accessibility: Accessibility;\n  readonly coverage: Coverage;\n  readonly keyboard: Keyboard;\n  readonly mouse: Mouse;\n  readonly touchscreen: Touchscreen;\n\n  readonly _bindings = new Map<string, (source: structs.BindingSource, ...args: any[]) => any>();\n  readonly _timeoutSettings: TimeoutSettings;\n  private _video: Video | null = null;\n  readonly _opener: Page | null;\n\n  static from(page: channels.PageChannel): Page {\n    return (page as any)._object;\n  }\n\n  static fromNullable(page: channels.PageChannel | undefined): Page | null {\n    return page ? Page.from(page) : null;\n  }\n\n  constructor(parent: ChannelOwner, type: string, guid: string, initializer: channels.PageInitializer) {\n    super(parent, type, guid, initializer);\n    this._browserContext = parent as BrowserContext;\n    this._timeoutSettings = new TimeoutSettings(this._browserContext._timeoutSettings);\n\n    this.accessibility = new Accessibility(this._channel);\n    this.keyboard = new Keyboard(this._channel);\n    this.mouse = new Mouse(this._channel);\n    this.touchscreen = new Touchscreen(this._channel);\n\n    this._mainFrame = Frame.from(initializer.mainFrame);\n    this._mainFrame._page = this;\n    this._frames.add(this._mainFrame);\n    this._viewportSize = initializer.viewportSize || null;\n    this._closed = initializer.isClosed;\n    this._opener = Page.fromNullable(initializer.opener);\n\n    this._channel.on('bindingCall', ({ binding }) => this._onBinding(BindingCall.from(binding)));\n    this._channel.on('close', () => this._onClose());\n    this._channel.on('console', ({ message }) => this.emit(Events.Page.Console, ConsoleMessage.from(message)));\n    this._channel.on('crash', () => this._onCrash());\n    this._channel.on('dialog', ({ dialog }) => {\n      if (!this.emit(Events.Page.Dialog, Dialog.from(dialog)))\n        dialog.dismiss().catch(() => {});\n    });\n    this._channel.on('domcontentloaded', () => this.emit(Events.Page.DOMContentLoaded, this));\n    this._channel.on('download', ({ url, suggestedFilename, artifact }) => {\n      const artifactObject = Artifact.from(artifact);\n      artifactObject._isRemote = !!this._browserContext._browser && !!this._browserContext._browser._remoteType;\n      this.emit(Events.Page.Download, new Download(this, url, suggestedFilename, artifactObject));\n    });\n    this._channel.on('fileChooser', ({ element, isMultiple }) => this.emit(Events.Page.FileChooser, new FileChooser(this, ElementHandle.from(element), isMultiple)));\n    this._channel.on('frameAttached', ({ frame }) => this._onFrameAttached(Frame.from(frame)));\n    this._channel.on('frameDetached', ({ frame }) => this._onFrameDetached(Frame.from(frame)));\n    this._channel.on('load', () => this.emit(Events.Page.Load, this));\n    this._channel.on('pageError', ({ error }) => this.emit(Events.Page.PageError, parseError(error)));\n    this._channel.on('route', ({ route, request }) => this._onRoute(Route.from(route), Request.from(request)));\n    this._channel.on('video', ({ artifact }) => {\n      const artifactObject = Artifact.from(artifact);\n      this._forceVideo()._artifactReady(artifactObject);\n    });\n    this._channel.on('webSocket', ({ webSocket }) => this.emit(Events.Page.WebSocket, WebSocket.from(webSocket)));\n    this._channel.on('worker', ({ worker }) => this._onWorker(Worker.from(worker)));\n\n    this.coverage = new Coverage(this._channel);\n\n    this._closedOrCrashedPromise = Promise.race([\n      new Promise<void>(f => this.once(Events.Page.Close, f)),\n      new Promise<void>(f => this.once(Events.Page.Crash, f)),\n    ]);\n  }\n\n  private _onFrameAttached(frame: Frame) {\n    frame._page = this;\n    this._frames.add(frame);\n    if (frame._parentFrame)\n      frame._parentFrame._childFrames.add(frame);\n    this.emit(Events.Page.FrameAttached, frame);\n  }\n\n  private _onFrameDetached(frame: Frame) {\n    this._frames.delete(frame);\n    frame._detached = true;\n    if (frame._parentFrame)\n      frame._parentFrame._childFrames.delete(frame);\n    this.emit(Events.Page.FrameDetached, frame);\n  }\n\n  private _onRoute(route: Route, request: Request) {\n    for (const {url, handler} of this._routes) {\n      if (urlMatches(this._browserContext._options.baseURL, request.url(), url)) {\n        handler(route, request);\n        return;\n      }\n    }\n    this._browserContext._onRoute(route, request);\n  }\n\n  async _onBinding(bindingCall: BindingCall) {\n    const func = this._bindings.get(bindingCall._initializer.name);\n    if (func) {\n      await bindingCall.call(func);\n      return;\n    }\n    await this._browserContext._onBinding(bindingCall);\n  }\n\n  _onWorker(worker: Worker): void {\n    this._workers.add(worker);\n    worker._page = this;\n    this.emit(Events.Page.Worker, worker);\n  }\n\n  _onClose() {\n    this._closed = true;\n    this._browserContext._pages.delete(this);\n    this._browserContext._backgroundPages.delete(this);\n    this.emit(Events.Page.Close, this);\n  }\n\n  private _onCrash() {\n    this.emit(Events.Page.Crash, this);\n  }\n\n  context(): BrowserContext {\n    return this._browserContext;\n  }\n\n  async opener(): Promise<Page | null> {\n    if (!this._opener || this._opener.isClosed())\n      return null;\n    return this._opener;\n  }\n\n  mainFrame(): Frame {\n    return this._mainFrame;\n  }\n\n  frame(frameSelector: string | { name?: string, url?: URLMatch }): Frame | null {\n    const name = isString(frameSelector) ? frameSelector : frameSelector.name;\n    const url = isObject(frameSelector) ? frameSelector.url : undefined;\n    assert(name || url, 'Either name or url matcher should be specified');\n    return this.frames().find(f => {\n      if (name)\n        return f.name() === name;\n      return urlMatches(this._browserContext._options.baseURL, f.url(), url);\n    }) || null;\n  }\n\n  frames(): Frame[] {\n    return [...this._frames];\n  }\n\n  setDefaultNavigationTimeout(timeout: number) {\n    this._timeoutSettings.setDefaultNavigationTimeout(timeout);\n    this._channel.setDefaultNavigationTimeoutNoReply({ timeout });\n  }\n\n  setDefaultTimeout(timeout: number) {\n    this._timeoutSettings.setDefaultTimeout(timeout);\n    this._channel.setDefaultTimeoutNoReply({ timeout });\n  }\n\n  private _forceVideo(): Video {\n    if (!this._video)\n      this._video = new Video(this);\n    return this._video;\n  }\n\n  video(): Video | null {\n    // Note: we are creating Video object lazily, because we do not know\n    // BrowserContextOptions when constructing the page - it is assigned\n    // too late during launchPersistentContext.\n    if (!this._browserContext._options.recordVideo)\n      return null;\n    return this._forceVideo();\n  }\n\n  async $(selector: string, options?: { strict?: boolean }): Promise<ElementHandle<SVGElement | HTMLElement> | null> {\n    return this._mainFrame.$(selector, options);\n  }\n\n  waitForSelector(selector: string, options: channels.FrameWaitForSelectorOptions & { state: 'attached' | 'visible' }): Promise<ElementHandle<SVGElement | HTMLElement>>;\n  waitForSelector(selector: string, options?: channels.FrameWaitForSelectorOptions): Promise<ElementHandle<SVGElement | HTMLElement> | null>;\n  async waitForSelector(selector: string, options?: channels.FrameWaitForSelectorOptions): Promise<ElementHandle<SVGElement | HTMLElement> | null> {\n    return this._mainFrame.waitForSelector(selector, options);\n  }\n\n  async dispatchEvent(selector: string, type: string, eventInit?: any, options?: channels.FrameDispatchEventOptions): Promise<void> {\n    return this._mainFrame.dispatchEvent(selector, type, eventInit, options);\n  }\n\n  async evaluateHandle<R, Arg>(pageFunction: structs.PageFunction<Arg, R>, arg?: Arg): Promise<structs.SmartHandle<R>> {\n    assertMaxArguments(arguments.length, 2);\n    return this._mainFrame.evaluateHandle(pageFunction, arg);\n  }\n\n  async $eval<R, Arg>(selector: string, pageFunction: structs.PageFunctionOn<Element, Arg, R>, arg?: Arg): Promise<R> {\n    assertMaxArguments(arguments.length, 3);\n    return this._mainFrame.$eval(selector, pageFunction, arg);\n  }\n\n  async $$eval<R, Arg>(selector: string, pageFunction: structs.PageFunctionOn<Element[], Arg, R>, arg?: Arg): Promise<R> {\n    assertMaxArguments(arguments.length, 3);\n    return this._mainFrame.$$eval(selector, pageFunction, arg);\n  }\n\n  async $$(selector: string): Promise<ElementHandle<SVGElement | HTMLElement>[]> {\n    return this._mainFrame.$$(selector);\n  }\n\n  async addScriptTag(options: { url?: string; path?: string; content?: string; type?: string; } = {}): Promise<ElementHandle> {\n    return this._mainFrame.addScriptTag(options);\n  }\n\n  async addStyleTag(options: { url?: string; path?: string; content?: string; } = {}): Promise<ElementHandle> {\n    return this._mainFrame.addStyleTag(options);\n  }\n\n  async exposeFunction(name: string, callback: Function) {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      await channel.exposeBinding({ name });\n      const binding = (source: structs.BindingSource, ...args: any[]) => callback(...args);\n      this._bindings.set(name, binding);\n    });\n  }\n\n  async exposeBinding(name: string, callback: (source: structs.BindingSource, ...args: any[]) => any, options: { handle?: boolean } = {}) {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      await channel.exposeBinding({ name, needsHandle: options.handle });\n      this._bindings.set(name, callback);\n    });\n  }\n\n  async setExtraHTTPHeaders(headers: Headers) {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      validateHeaders(headers);\n      await channel.setExtraHTTPHeaders({ headers: headersObjectToArray(headers) });\n    });\n  }\n\n  url(): string {\n    return this._mainFrame.url();\n  }\n\n  async content(): Promise<string> {\n    return this._mainFrame.content();\n  }\n\n  async setContent(html: string, options?: channels.FrameSetContentOptions): Promise<void> {\n    return this._mainFrame.setContent(html, options);\n  }\n\n  async goto(url: string, options?: channels.FrameGotoOptions): Promise<Response | null> {\n    return this._mainFrame.goto(url, options);\n  }\n\n  async reload(options: channels.PageReloadOptions = {}): Promise<Response | null> {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      const waitUntil = verifyLoadState('waitUntil', options.waitUntil === undefined ? 'load' : options.waitUntil);\n      return Response.fromNullable((await channel.reload({ ...options, waitUntil })).response);\n    });\n  }\n\n  async waitForLoadState(state?: LifecycleEvent, options?: { timeout?: number }): Promise<void> {\n    return this._mainFrame.waitForLoadState(state, options);\n  }\n\n  async waitForNavigation(options?: WaitForNavigationOptions): Promise<Response | null> {\n    return this._mainFrame.waitForNavigation(options);\n  }\n\n  async waitForURL(url: URLMatch, options?: { waitUntil?: LifecycleEvent, timeout?: number }): Promise<void> {\n    return this._mainFrame.waitForURL(url, options);\n  }\n\n  async waitForRequest(urlOrPredicate: string | RegExp | ((r: Request) => boolean | Promise<boolean>), options: { timeout?: number } = {}): Promise<Request> {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      const predicate = (request: Request) => {\n        if (isString(urlOrPredicate) || isRegExp(urlOrPredicate))\n          return urlMatches(this._browserContext._options.baseURL, request.url(), urlOrPredicate);\n        return urlOrPredicate(request);\n      };\n      const trimmedUrl = trimUrl(urlOrPredicate);\n      const logLine = trimmedUrl ? `waiting for request ${trimmedUrl}` : undefined;\n      return this._waitForEvent(Events.Page.Request, { predicate, timeout: options.timeout }, logLine);\n    });\n  }\n\n  async waitForResponse(urlOrPredicate: string | RegExp | ((r: Response) => boolean | Promise<boolean>), options: { timeout?: number } = {}): Promise<Response> {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      const predicate = (response: Response) => {\n        if (isString(urlOrPredicate) || isRegExp(urlOrPredicate))\n          return urlMatches(this._browserContext._options.baseURL, response.url(), urlOrPredicate);\n        return urlOrPredicate(response);\n      };\n      const trimmedUrl = trimUrl(urlOrPredicate);\n      const logLine = trimmedUrl ? `waiting for response ${trimmedUrl}` : undefined;\n      return this._waitForEvent(Events.Page.Response, { predicate, timeout: options.timeout }, logLine);\n    });\n  }\n\n  async waitForEvent(event: string, optionsOrPredicate: WaitForEventOptions = {}): Promise<any> {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      return this._waitForEvent(event, optionsOrPredicate, `waiting for event \"${event}\"`);\n    });\n  }\n\n  private async _waitForEvent(event: string, optionsOrPredicate: WaitForEventOptions, logLine?: string): Promise<any> {\n    const timeout = this._timeoutSettings.timeout(typeof optionsOrPredicate === 'function' ? {} : optionsOrPredicate);\n    const predicate = typeof optionsOrPredicate === 'function' ? optionsOrPredicate : optionsOrPredicate.predicate;\n    const waiter = Waiter.createForEvent(this, event);\n    if (logLine)\n      waiter.log(logLine);\n    waiter.rejectOnTimeout(timeout, `Timeout while waiting for event \"${event}\"`);\n    if (event !== Events.Page.Crash)\n      waiter.rejectOnEvent(this, Events.Page.Crash, new Error('Page crashed'));\n    if (event !== Events.Page.Close)\n      waiter.rejectOnEvent(this, Events.Page.Close, new Error('Page closed'));\n    const result = await waiter.waitForEvent(this, event, predicate as any);\n    waiter.dispose();\n    return result;\n  }\n\n  async goBack(options: channels.PageGoBackOptions = {}): Promise<Response | null> {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      const waitUntil = verifyLoadState('waitUntil', options.waitUntil === undefined ? 'load' : options.waitUntil);\n      return Response.fromNullable((await channel.goBack({ ...options, waitUntil })).response);\n    });\n  }\n\n  async goForward(options: channels.PageGoForwardOptions = {}): Promise<Response | null> {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      const waitUntil = verifyLoadState('waitUntil', options.waitUntil === undefined ? 'load' : options.waitUntil);\n      return Response.fromNullable((await channel.goForward({ ...options, waitUntil })).response);\n    });\n  }\n\n  async emulateMedia(options: { media?: 'screen' | 'print' | null, colorScheme?: 'dark' | 'light' | 'no-preference' | null, reducedMotion?: 'reduce' | 'no-preference' | null } = {}) {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      await channel.emulateMedia({\n        media: options.media === null ? 'null' : options.media,\n        colorScheme: options.colorScheme === null ? 'null' : options.colorScheme,\n        reducedMotion: options.reducedMotion === null ? 'null' : options.reducedMotion,\n      });\n    });\n  }\n\n  async setViewportSize(viewportSize: Size) {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      this._viewportSize = viewportSize;\n      await channel.setViewportSize({ viewportSize });\n    });\n  }\n\n  viewportSize(): Size | null {\n    return this._viewportSize;\n  }\n\n  async evaluate<R, Arg>(pageFunction: structs.PageFunction<Arg, R>, arg?: Arg): Promise<R> {\n    assertMaxArguments(arguments.length, 2);\n    return this._mainFrame.evaluate(pageFunction, arg);\n  }\n\n  async addInitScript(script: Function | string | { path?: string, content?: string }, arg?: any) {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      const source = await evaluationScript(script, arg);\n      await channel.addInitScript({ source });\n    });\n  }\n\n  async route(url: URLMatch, handler: RouteHandler): Promise<void> {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      this._routes.unshift({ url, handler });\n      if (this._routes.length === 1)\n        await channel.setNetworkInterceptionEnabled({ enabled: true });\n    });\n  }\n\n  async unroute(url: URLMatch, handler?: RouteHandler): Promise<void> {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      this._routes = this._routes.filter(route => route.url !== url || (handler && route.handler !== handler));\n      if (this._routes.length === 0)\n        await channel.setNetworkInterceptionEnabled({ enabled: false });\n    });\n  }\n\n  async screenshot(options: channels.PageScreenshotOptions & { path?: string } = {}): Promise<Buffer> {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      const copy = { ...options };\n      if (!copy.type)\n        copy.type = determineScreenshotType(options);\n      const result = await channel.screenshot(copy);\n      const buffer = Buffer.from(result.binary, 'base64');\n      if (options.path) {\n        await mkdirIfNeeded(options.path);\n        await fs.promises.writeFile(options.path, buffer);\n      }\n      return buffer;\n    });\n  }\n\n  async title(): Promise<string> {\n    return this._mainFrame.title();\n  }\n\n  async bringToFront(): Promise<void> {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      await channel.bringToFront();\n    });\n  }\n\n  async close(options: { runBeforeUnload?: boolean } = {runBeforeUnload: undefined}) {\n    try {\n      await this._wrapApiCall(async (channel: channels.PageChannel) => {\n        if (this._ownedContext)\n          await this._ownedContext.close();\n        else\n          await channel.close(options);\n      });\n    } catch (e) {\n      if (isSafeCloseError(e))\n        return;\n      throw e;\n    }\n  }\n\n  isClosed(): boolean {\n    return this._closed;\n  }\n\n  async click(selector: string, options?: channels.FrameClickOptions) {\n    return this._mainFrame.click(selector, options);\n  }\n\n  async dragAndDrop(source: string, target: string, options?: channels.FrameDragAndDropOptions) {\n    return this._mainFrame.dragAndDrop(source, target, options);\n  }\n\n  async dblclick(selector: string, options?: channels.FrameDblclickOptions) {\n    return this._mainFrame.dblclick(selector, options);\n  }\n\n  async tap(selector: string, options?: channels.FrameTapOptions) {\n    return this._mainFrame.tap(selector, options);\n  }\n\n  async fill(selector: string, value: string, options?: channels.FrameFillOptions) {\n    return this._mainFrame.fill(selector, value, options);\n  }\n\n  locator(selector: string): Locator {\n    return this.mainFrame().locator(selector);\n  }\n\n  async focus(selector: string, options?: channels.FrameFocusOptions) {\n    return this._mainFrame.focus(selector, options);\n  }\n\n  async textContent(selector: string, options?: channels.FrameTextContentOptions): Promise<null|string> {\n    return this._mainFrame.textContent(selector, options);\n  }\n\n  async innerText(selector: string, options?: channels.FrameInnerTextOptions): Promise<string> {\n    return this._mainFrame.innerText(selector, options);\n  }\n\n  async innerHTML(selector: string, options?: channels.FrameInnerHTMLOptions): Promise<string> {\n    return this._mainFrame.innerHTML(selector, options);\n  }\n\n  async getAttribute(selector: string, name: string, options?: channels.FrameGetAttributeOptions): Promise<string | null> {\n    return this._mainFrame.getAttribute(selector, name, options);\n  }\n\n  async inputValue(selector: string, options?: channels.FrameInputValueOptions): Promise<string> {\n    return this._mainFrame.inputValue(selector, options);\n  }\n\n  async isChecked(selector: string, options?: channels.FrameIsCheckedOptions): Promise<boolean> {\n    return this._mainFrame.isChecked(selector, options);\n  }\n\n  async isDisabled(selector: string, options?: channels.FrameIsDisabledOptions): Promise<boolean> {\n    return this._mainFrame.isDisabled(selector, options);\n  }\n\n  async isEditable(selector: string, options?: channels.FrameIsEditableOptions): Promise<boolean> {\n    return this._mainFrame.isEditable(selector, options);\n  }\n\n  async isEnabled(selector: string, options?: channels.FrameIsEnabledOptions): Promise<boolean> {\n    return this._mainFrame.isEnabled(selector, options);\n  }\n\n  async isHidden(selector: string, options?: channels.FrameIsHiddenOptions): Promise<boolean> {\n    return this._mainFrame.isHidden(selector, options);\n  }\n\n  async isVisible(selector: string, options?: channels.FrameIsVisibleOptions): Promise<boolean> {\n    return this._mainFrame.isVisible(selector, options);\n  }\n\n  async hover(selector: string, options?: channels.FrameHoverOptions) {\n    return this._mainFrame.hover(selector, options);\n  }\n\n  async selectOption(selector: string, values: string | api.ElementHandle | SelectOption | string[] | api.ElementHandle[] | SelectOption[] | null, options?: SelectOptionOptions): Promise<string[]> {\n    return this._mainFrame.selectOption(selector, values, options);\n  }\n\n  async setInputFiles(selector: string, files: string | FilePayload | string[] | FilePayload[], options?: channels.FrameSetInputFilesOptions): Promise<void> {\n    return this._mainFrame.setInputFiles(selector, files, options);\n  }\n\n  async type(selector: string, text: string, options?: channels.FrameTypeOptions) {\n    return this._mainFrame.type(selector, text, options);\n  }\n\n  async press(selector: string, key: string, options?: channels.FramePressOptions) {\n    return this._mainFrame.press(selector, key, options);\n  }\n\n  async check(selector: string, options?: channels.FrameCheckOptions) {\n    return this._mainFrame.check(selector, options);\n  }\n\n  async uncheck(selector: string, options?: channels.FrameUncheckOptions) {\n    return this._mainFrame.uncheck(selector, options);\n  }\n\n  async waitForTimeout(timeout: number) {\n    return this._mainFrame.waitForTimeout(timeout);\n  }\n\n  async waitForFunction<R, Arg>(pageFunction: structs.PageFunction<Arg, R>, arg?: Arg, options?: WaitForFunctionOptions): Promise<structs.SmartHandle<R>> {\n    return this._mainFrame.waitForFunction(pageFunction, arg, options);\n  }\n\n  workers(): Worker[] {\n    return [...this._workers];\n  }\n\n  on(event: string | symbol, listener: Listener): this {\n    if (event === Events.Page.FileChooser && !this.listenerCount(event))\n      this._channel.setFileChooserInterceptedNoReply({ intercepted: true });\n    super.on(event, listener);\n    return this;\n  }\n\n  addListener(event: string | symbol, listener: Listener): this {\n    if (event === Events.Page.FileChooser && !this.listenerCount(event))\n      this._channel.setFileChooserInterceptedNoReply({ intercepted: true });\n    super.addListener(event, listener);\n    return this;\n  }\n\n  off(event: string | symbol, listener: Listener): this {\n    super.off(event, listener);\n    if (event === Events.Page.FileChooser && !this.listenerCount(event))\n      this._channel.setFileChooserInterceptedNoReply({ intercepted: false });\n    return this;\n  }\n\n  removeListener(event: string | symbol, listener: Listener): this {\n    super.removeListener(event, listener);\n    if (event === Events.Page.FileChooser && !this.listenerCount(event))\n      this._channel.setFileChooserInterceptedNoReply({ intercepted: false });\n    return this;\n  }\n\n  async pause() {\n    return this.context()._wrapApiCall(async (channel: channels.BrowserContextChannel) => {\n      await channel.pause();\n    });\n  }\n\n  async pdf(options: PDFOptions = {}): Promise<Buffer> {\n    return this._wrapApiCall(async (channel: channels.PageChannel) => {\n      const transportOptions: channels.PagePdfParams = { ...options } as channels.PagePdfParams;\n      if (transportOptions.margin)\n        transportOptions.margin = { ...transportOptions.margin };\n      if (typeof options.width === 'number')\n        transportOptions.width = options.width + 'px';\n      if (typeof options.height === 'number')\n        transportOptions.height  = options.height + 'px';\n      for (const margin of ['top', 'right', 'bottom', 'left']) {\n        const index = margin as 'top' | 'right' | 'bottom' | 'left';\n        if (options.margin && typeof options.margin[index] === 'number')\n          transportOptions.margin![index] = transportOptions.margin![index] + 'px';\n      }\n      const result = await channel.pdf(transportOptions);\n      const buffer = Buffer.from(result.pdf, 'base64');\n      if (options.path) {\n        await fs.promises.mkdir(path.dirname(options.path), { recursive: true });\n        await fs.promises.writeFile(options.path, buffer);\n      }\n      return buffer;\n    });\n  }\n}\n\nexport class BindingCall extends ChannelOwner<channels.BindingCallChannel, channels.BindingCallInitializer> {\n  static from(channel: channels.BindingCallChannel): BindingCall {\n    return (channel as any)._object;\n  }\n\n  constructor(parent: ChannelOwner, type: string, guid: string, initializer: channels.BindingCallInitializer) {\n    super(parent, type, guid, initializer);\n  }\n\n  async call(func: (source: structs.BindingSource, ...args: any[]) => any) {\n    try {\n      const frame = Frame.from(this._initializer.frame);\n      const source = {\n        context: frame._page!.context(),\n        page: frame._page!,\n        frame\n      };\n      let result: any;\n      if (this._initializer.handle)\n        result = await func(source, JSHandle.from(this._initializer.handle));\n      else\n        result = await func(source, ...this._initializer.args!.map(parseResult));\n      this._channel.resolve({ result: serializeArgument(result) }).catch(() => {});\n    } catch (e) {\n      this._channel.reject({ error: serializeError(e) }).catch(() => {});\n    }\n  }\n}\n\nfunction trimEnd(s: string): string {\n  if (s.length > 50)\n    s = s.substring(0, 50) + '\\u2026';\n  return s;\n}\n\nfunction trimUrl(param: any): string | undefined {\n  if (isRegExp(param))\n    return `/${trimEnd(param.source)}/${param.flags}`;\n  if (isString(param))\n    return `\"${trimEnd(param)}\"`;\n}\n"],"file":"page.js"}