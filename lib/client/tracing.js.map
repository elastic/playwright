{"version":3,"sources":["../../src/client/tracing.ts"],"names":["Tracing","constructor","channel","_context","start","options","_wrapApiCall","tracingStart","_export","_doExport","path","stop","tracingStop","result","tracingExport","artifact","Artifact","from","browser","_remoteType","_isRemote","saveAs","delete"],"mappings":";;;;;;;AAkBA;;AAlBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAOO,MAAMA,OAAN,CAAqC;AAG1CC,EAAAA,WAAW,CAACC,OAAD,EAA0B;AAAA,SAF7BC,QAE6B;AACnC,SAAKA,QAAL,GAAgBD,OAAhB;AACD;;AAEU,QAALE,KAAK,CAACC,OAAsE,GAAG,EAA1E,EAA8E;AACvF,UAAM,KAAKF,QAAL,CAAcG,YAAd,CAA2B,MAAOJ,OAAP,IAAmD;AAClF,aAAO,MAAMA,OAAO,CAACK,YAAR,CAAqBF,OAArB,CAAb;AACD,KAFK,CAAN;AAGD;;AAEY,QAAPG,OAAO,CAACH,OAAD,EAA4B;AACvC,UAAM,KAAKF,QAAL,CAAcG,YAAd,CAA2B,MAAOJ,OAAP,IAAmD;AAClF,YAAM,KAAKO,SAAL,CAAeP,OAAf,EAAwBG,OAAO,CAACK,IAAhC,CAAN;AACD,KAFK,CAAN;AAGD;;AAES,QAAJC,IAAI,CAACN,OAA0B,GAAG,EAA9B,EAAkC;AAC1C,UAAM,KAAKF,QAAL,CAAcG,YAAd,CAA2B,MAAOJ,OAAP,IAAmD;AAClF,UAAIG,OAAO,CAACK,IAAZ,EACE,MAAM,KAAKD,SAAL,CAAeP,OAAf,EAAwBG,OAAO,CAACK,IAAhC,CAAN;AACF,YAAMR,OAAO,CAACU,WAAR,EAAN;AACD,KAJK,CAAN;AAKD;;AAEsB,QAATH,SAAS,CAACP,OAAD,EAA0CQ,IAA1C,EAAwD;AAAA;;AAC7E,UAAMG,MAAM,GAAG,MAAMX,OAAO,CAACY,aAAR,EAArB;;AACA,UAAMC,QAAQ,GAAGC,mBAASC,IAAT,CAAcJ,MAAM,CAACE,QAArB,CAAjB;;AACA,iCAAI,KAAKZ,QAAL,CAAce,OAAd,EAAJ,kDAAI,sBAAyBC,WAA7B,EACEJ,QAAQ,CAACK,SAAT,GAAqB,IAArB;AACF,UAAML,QAAQ,CAACM,MAAT,CAAgBX,IAAhB,CAAN;AACA,UAAMK,QAAQ,CAACO,MAAT,EAAN;AACD;;AAlCyC","sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as api from '../../types/types';\nimport * as channels from '../protocol/channels';\nimport { Artifact } from './artifact';\nimport { BrowserContext } from './browserContext';\n\nexport class Tracing implements api.Tracing {\n  private _context: BrowserContext;\n\n  constructor(channel: BrowserContext) {\n    this._context = channel;\n  }\n\n  async start(options: { name?: string, snapshots?: boolean, screenshots?: boolean } = {}) {\n    await this._context._wrapApiCall(async (channel: channels.BrowserContextChannel) => {\n      return await channel.tracingStart(options);\n    });\n  }\n\n  async _export(options: { path: string }) {\n    await this._context._wrapApiCall(async (channel: channels.BrowserContextChannel) => {\n      await this._doExport(channel, options.path);\n    });\n  }\n\n  async stop(options: { path?: string } = {}) {\n    await this._context._wrapApiCall(async (channel: channels.BrowserContextChannel) => {\n      if (options.path)\n        await this._doExport(channel, options.path);\n      await channel.tracingStop();\n    });\n  }\n\n  private async _doExport(channel: channels.BrowserContextChannel, path: string) {\n    const result = await channel.tracingExport();\n    const artifact = Artifact.from(result.artifact);\n    if (this._context.browser()?._remoteType)\n      artifact._isRemote = true;\n    await artifact.saveAs(path);\n    await artifact.delete();\n  }\n}\n"],"file":"tracing.js"}