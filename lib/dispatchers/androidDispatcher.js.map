{"version":3,"sources":["../../src/dispatchers/androidDispatcher.ts"],"names":["AndroidDispatcher","Dispatcher","constructor","scope","android","devices","params","_object","map","d","AndroidDeviceDispatcher","from","_scope","setDefaultTimeoutNoReply","setDefaultTimeout","timeout","device","result","model","serial","webView","webViews","_dispatchEvent","on","AndroidDevice","Events","WebViewAdded","WebViewRemoved","pid","wait","send","fill","selector","tap","drag","fling","longTap","pinchClose","pinchOpen","scroll","swipe","info","inputType","text","keyCodes","i","length","code","keyMap","get","toUpperCase","undefined","Error","push","Promise","all","keyCode","inputPress","has","key","inputTap","inputSwipe","inputDrag","screenshot","binary","toString","shell","command","open","metadata","socket","AndroidSocketDispatcher","installApk","Buffer","file","args","path","mode","launchBrowser","context","pkg","BrowserContextDispatcher","close","connectToWebView","sdkLanguage","data","_dispose","write","Map"],"mappings":";;;;;;;AAgBA;;AACA;;AAEA;;AAnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAQO,MAAMA,iBAAN,SAAgCC,sBAAhC,CAAoH;AACzHC,EAAAA,WAAW,CAACC,KAAD,EAAyBC,OAAzB,EAA2C;AACpD,UAAMD,KAAN,EAAaC,OAAb,EAAsB,SAAtB,EAAiC,EAAjC,EAAqC,IAArC;AACD;;AAEY,QAAPC,OAAO,CAACC,MAAD,EAAgF;AAC3F,UAAMD,OAAO,GAAG,MAAM,KAAKE,OAAL,CAAaF,OAAb,EAAtB;AACA,WAAO;AACLA,MAAAA,OAAO,EAAEA,OAAO,CAACG,GAAR,CAAYC,CAAC,IAAIC,uBAAuB,CAACC,IAAxB,CAA6B,KAAKC,MAAlC,EAA0CH,CAA1C,CAAjB;AADJ,KAAP;AAGD;;AAE6B,QAAxBI,wBAAwB,CAACP,MAAD,EAAyD;AACrF,SAAKC,OAAL,CAAaO,iBAAb,CAA+BR,MAAM,CAACS,OAAtC;AACD;;AAdwH;;;;AAiBpH,MAAML,uBAAN,SAAsCT,sBAAtC,CAA4I;AAEtI,SAAJU,IAAI,CAACR,KAAD,EAAyBa,MAAzB,EAAyE;AAClF,UAAMC,MAAM,GAAG,oCAA4CD,MAA5C,CAAf;AACA,WAAOC,MAAM,IAAI,IAAIP,uBAAJ,CAA4BP,KAA5B,EAAmCa,MAAnC,CAAjB;AACD;;AAEDd,EAAAA,WAAW,CAACC,KAAD,EAAyBa,MAAzB,EAAgD;AACzD,UAAMb,KAAN,EAAaa,MAAb,EAAqB,eAArB,EAAsC;AACpCE,MAAAA,KAAK,EAAEF,MAAM,CAACE,KADsB;AAEpCC,MAAAA,MAAM,EAAEH,MAAM,CAACG;AAFqB,KAAtC,EAGG,IAHH;;AAIA,SAAK,MAAMC,OAAX,IAAsBJ,MAAM,CAACK,QAAP,EAAtB,EACE,KAAKC,cAAL,CAAoB,cAApB,EAAoC;AAAEF,MAAAA;AAAF,KAApC;;AACFJ,IAAAA,MAAM,CAACO,EAAP,CAAUC,uBAAcC,MAAd,CAAqBC,YAA/B,EAA6CN,OAAO,IAAI,KAAKE,cAAL,CAAoB,cAApB,EAAoC;AAAEF,MAAAA;AAAF,KAApC,CAAxD;AACAJ,IAAAA,MAAM,CAACO,EAAP,CAAUC,uBAAcC,MAAd,CAAqBE,cAA/B,EAA+CC,GAAG,IAAI,KAAKN,cAAL,CAAoB,gBAApB,EAAsC;AAAEM,MAAAA;AAAF,KAAtC,CAAtD;AACD;;AAES,QAAJC,IAAI,CAACvB,MAAD,EAA2C;AACnD,UAAM,KAAKC,OAAL,CAAauB,IAAb,CAAkB,MAAlB,EAA0BxB,MAA1B,CAAN;AACD;;AAES,QAAJyB,IAAI,CAACzB,MAAD,EAA2C;AACnD,UAAM,KAAKC,OAAL,CAAauB,IAAb,CAAkB,OAAlB,EAA2B;AAAEE,MAAAA,QAAQ,EAAE1B,MAAM,CAAC0B;AAAnB,KAA3B,CAAN;AACA,UAAM,KAAKzB,OAAL,CAAauB,IAAb,CAAkB,MAAlB,EAA0BxB,MAA1B,CAAN;AACD;;AAEQ,QAAH2B,GAAG,CAAC3B,MAAD,EAA0C;AACjD,UAAM,KAAKC,OAAL,CAAauB,IAAb,CAAkB,OAAlB,EAA2BxB,MAA3B,CAAN;AACD;;AAES,QAAJ4B,IAAI,CAAC5B,MAAD,EAA2C;AACnD,UAAM,KAAKC,OAAL,CAAauB,IAAb,CAAkB,MAAlB,EAA0BxB,MAA1B,CAAN;AACD;;AAEU,QAAL6B,KAAK,CAAC7B,MAAD,EAA4C;AACrD,UAAM,KAAKC,OAAL,CAAauB,IAAb,CAAkB,OAAlB,EAA2BxB,MAA3B,CAAN;AACD;;AAEY,QAAP8B,OAAO,CAAC9B,MAAD,EAA8C;AACzD,UAAM,KAAKC,OAAL,CAAauB,IAAb,CAAkB,WAAlB,EAA+BxB,MAA/B,CAAN;AACD;;AAEe,QAAV+B,UAAU,CAAC/B,MAAD,EAAiD;AAC/D,UAAM,KAAKC,OAAL,CAAauB,IAAb,CAAkB,YAAlB,EAAgCxB,MAAhC,CAAN;AACD;;AAEc,QAATgC,SAAS,CAAChC,MAAD,EAAgD;AAC7D,UAAM,KAAKC,OAAL,CAAauB,IAAb,CAAkB,WAAlB,EAA+BxB,MAA/B,CAAN;AACD;;AAEW,QAANiC,MAAM,CAACjC,MAAD,EAA6C;AACvD,UAAM,KAAKC,OAAL,CAAauB,IAAb,CAAkB,QAAlB,EAA4BxB,MAA5B,CAAN;AACD;;AAEU,QAALkC,KAAK,CAAClC,MAAD,EAA4C;AACrD,UAAM,KAAKC,OAAL,CAAauB,IAAb,CAAkB,OAAlB,EAA2BxB,MAA3B,CAAN;AACD;;AAES,QAAJmC,IAAI,CAACnC,MAAD,EAAqF;AAC7F,WAAO;AAAEmC,MAAAA,IAAI,EAAE,MAAM,KAAKlC,OAAL,CAAauB,IAAb,CAAkB,MAAlB,EAA0BxB,MAA1B;AAAd,KAAP;AACD;;AAEc,QAAToC,SAAS,CAACpC,MAAD,EAAgD;AAC7D,UAAMqC,IAAI,GAAGrC,MAAM,CAACqC,IAApB;AACA,UAAMC,QAAkB,GAAG,EAA3B;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,IAAI,CAACG,MAAzB,EAAiC,EAAED,CAAnC,EAAsC;AACpC,YAAME,IAAI,GAAGC,MAAM,CAACC,GAAP,CAAWN,IAAI,CAACE,CAAD,CAAJ,CAAQK,WAAR,EAAX,CAAb;AACA,UAAIH,IAAI,KAAKI,SAAb,EACE,MAAM,IAAIC,KAAJ,CAAU,oBAAoBT,IAAI,CAACE,CAAD,CAAxB,GAA8B,QAAxC,CAAN;AACFD,MAAAA,QAAQ,CAACS,IAAT,CAAcN,IAAd;AACD;;AACD,UAAMO,OAAO,CAACC,GAAR,CAAYX,QAAQ,CAACpC,GAAT,CAAagD,OAAO,IAAI,KAAKjD,OAAL,CAAauB,IAAb,CAAkB,YAAlB,EAAgC;AAAE0B,MAAAA;AAAF,KAAhC,CAAxB,CAAZ,CAAN;AACD;;AAEe,QAAVC,UAAU,CAACnD,MAAD,EAAiD;AAC/D,QAAI,CAAC0C,MAAM,CAACU,GAAP,CAAWpD,MAAM,CAACqD,GAAlB,CAAL,EACE,MAAM,IAAIP,KAAJ,CAAU,kBAAkB9C,MAAM,CAACqD,GAAnC,CAAN;AACF,UAAM,KAAKpD,OAAL,CAAauB,IAAb,CAAkB,YAAlB,EAAgC;AAAE0B,MAAAA,OAAO,EAAER,MAAM,CAACC,GAAP,CAAW3C,MAAM,CAACqD,GAAlB;AAAX,KAAhC,CAAN;AACD;;AAEa,QAARC,QAAQ,CAACtD,MAAD,EAA+C;AAC3D,UAAM,KAAKC,OAAL,CAAauB,IAAb,CAAkB,YAAlB,EAAgCxB,MAAhC,CAAN;AACD;;AAEe,QAAVuD,UAAU,CAACvD,MAAD,EAAiD;AAC/D,UAAM,KAAKC,OAAL,CAAauB,IAAb,CAAkB,YAAlB,EAAgCxB,MAAhC,CAAN;AACD;;AAEc,QAATwD,SAAS,CAACxD,MAAD,EAAgD;AAC7D,UAAM,KAAKC,OAAL,CAAauB,IAAb,CAAkB,WAAlB,EAA+BxB,MAA/B,CAAN;AACD;;AAEe,QAAVyD,UAAU,CAACzD,MAAD,EAAkG;AAChH,WAAO;AAAE0D,MAAAA,MAAM,EAAE,CAAC,MAAM,KAAKzD,OAAL,CAAawD,UAAb,EAAP,EAAkCE,QAAlC,CAA2C,QAA3C;AAAV,KAAP;AACD;;AAEU,QAALC,KAAK,CAAC5D,MAAD,EAAwF;AACjG,WAAO;AAAEW,MAAAA,MAAM,EAAE,CAAC,MAAM,KAAKV,OAAL,CAAa2D,KAAb,CAAmB5D,MAAM,CAAC6D,OAA1B,CAAP,EAA2CF,QAA3C,CAAoD,QAApD;AAAV,KAAP;AACD;;AAES,QAAJG,IAAI,CAAC9D,MAAD,EAA2C+D,QAA3C,EAA8G;AACtH,UAAMC,MAAM,GAAG,MAAM,KAAK/D,OAAL,CAAa6D,IAAb,CAAkB9D,MAAM,CAAC6D,OAAzB,CAArB;AACA,WAAO;AAAEG,MAAAA,MAAM,EAAE,IAAIC,uBAAJ,CAA4B,KAAK3D,MAAjC,EAAyC0D,MAAzC;AAAV,KAAP;AACD;;AAEe,QAAVE,UAAU,CAAClE,MAAD,EAAiD;AAC/D,UAAM,KAAKC,OAAL,CAAaiE,UAAb,CAAwBC,MAAM,CAAC9D,IAAP,CAAYL,MAAM,CAACoE,IAAnB,EAAyB,QAAzB,CAAxB,EAA4D;AAAEC,MAAAA,IAAI,EAAErE,MAAM,CAACqE;AAAf,KAA5D,CAAN;AACD;;AAES,QAAJtB,IAAI,CAAC/C,MAAD,EAA2C;AACnD,UAAM,KAAKC,OAAL,CAAa8C,IAAb,CAAkBoB,MAAM,CAAC9D,IAAP,CAAYL,MAAM,CAACoE,IAAnB,EAAyB,QAAzB,CAAlB,EAAsDpE,MAAM,CAACsE,IAA7D,EAAmEtE,MAAM,CAACuE,IAA1E,CAAN;AACD;;AAEkB,QAAbC,aAAa,CAACxE,MAAD,EAAwG;AACzH,UAAMyE,OAAO,GAAG,MAAM,KAAKxE,OAAL,CAAauE,aAAb,CAA2BxE,MAAM,CAAC0E,GAAlC,EAAuC1E,MAAvC,CAAtB;AACA,WAAO;AAAEyE,MAAAA,OAAO,EAAE,IAAIE,kDAAJ,CAA6B,KAAKrE,MAAlC,EAA0CmE,OAA1C;AAAX,KAAP;AACD;;AAEU,QAALG,KAAK,CAAC5E,MAAD,EAA4C;AACrD,UAAM,KAAKC,OAAL,CAAa2E,KAAb,EAAN;AACD;;AAE6B,QAAxBrE,wBAAwB,CAACP,MAAD,EAA+D;AAC3F,SAAKC,OAAL,CAAaO,iBAAb,CAA+BR,MAAM,CAACS,OAAtC;AACD;;AAEqB,QAAhBoE,gBAAgB,CAAC7E,MAAD,EAA8G;AAClI,WAAO;AAAEyE,MAAAA,OAAO,EAAE,IAAIE,kDAAJ,CAA6B,KAAKrE,MAAlC,EAA0C,MAAM,KAAKL,OAAL,CAAa4E,gBAAb,CAA8B7E,MAAM,CAACsB,GAArC,EAA0CtB,MAAM,CAAC8E,WAAjD,CAAhD;AAAX,KAAP;AACD;;AAjIgJ;;;;AAoI5I,MAAMb,uBAAN,SAAsCtE,sBAAtC,CAA4I;AACjJC,EAAAA,WAAW,CAACC,KAAD,EAAyBmE,MAAzB,EAAgD;AACzD,UAAMnE,KAAN,EAAamE,MAAb,EAAqB,eAArB,EAAsC,EAAtC,EAA0C,IAA1C;AACAA,IAAAA,MAAM,CAAC/C,EAAP,CAAU,MAAV,EAAmB8D,IAAD,IAAkB,KAAK/D,cAAL,CAAoB,MAApB,EAA4B;AAAE+D,MAAAA,IAAI,EAAEA,IAAI,CAACpB,QAAL,CAAc,QAAd;AAAR,KAA5B,CAApC;AACAK,IAAAA,MAAM,CAAC/C,EAAP,CAAU,OAAV,EAAmB,MAAM;AACvB,WAAKD,cAAL,CAAoB,OAApB;;AACA,WAAKgE,QAAL;AACD,KAHD;AAID;;AAEU,QAALC,KAAK,CAACjF,MAAD,EAA4C+D,QAA5C,EAAmF;AAC5F,UAAM,KAAK9D,OAAL,CAAagF,KAAb,CAAmBd,MAAM,CAAC9D,IAAP,CAAYL,MAAM,CAAC+E,IAAnB,EAAyB,QAAzB,CAAnB,CAAN;AACD;;AAEU,QAALH,KAAK,CAAC5E,MAAD,EAA4C+D,QAA5C,EAAmF;AAC5F,SAAK9D,OAAL,CAAa2E,KAAb;AACD;;AAhBgJ;;;AAmBnJ,MAAMlC,MAAM,GAAG,IAAIwC,GAAJ,CAAwB,CACrC,CAAC,SAAD,EAAY,CAAZ,CADqC,EAErC,CAAC,UAAD,EAAa,CAAb,CAFqC,EAGrC,CAAC,WAAD,EAAc,CAAd,CAHqC,EAIrC,CAAC,MAAD,EAAS,CAAT,CAJqC,EAKrC,CAAC,MAAD,EAAS,CAAT,CALqC,EAMrC,CAAC,MAAD,EAAS,CAAT,CANqC,EAOrC,CAAC,SAAD,EAAY,CAAZ,CAPqC,EAQrC,CAAC,GAAD,EAAM,CAAN,CARqC,EASrC,CAAC,GAAD,EAAM,CAAN,CATqC,EAUrC,CAAC,GAAD,EAAM,CAAN,CAVqC,EAWrC,CAAC,GAAD,EAAM,EAAN,CAXqC,EAYrC,CAAC,GAAD,EAAM,EAAN,CAZqC,EAarC,CAAC,GAAD,EAAM,EAAN,CAbqC,EAcrC,CAAC,GAAD,EAAM,EAAN,CAdqC,EAerC,CAAC,GAAD,EAAM,EAAN,CAfqC,EAgBrC,CAAC,GAAD,EAAM,EAAN,CAhBqC,EAiBrC,CAAC,GAAD,EAAM,EAAN,CAjBqC,EAkBrC,CAAC,MAAD,EAAS,EAAT,CAlBqC,EAmBrC,CAAC,GAAD,EAAM,EAAN,CAnBqC,EAoBrC,CAAC,OAAD,EAAU,EAAV,CApBqC,EAqBrC,CAAC,GAAD,EAAM,EAAN,CArBqC,EAsBrC,CAAC,QAAD,EAAW,EAAX,CAtBqC,EAuBrC,CAAC,UAAD,EAAa,EAAb,CAvBqC,EAwBrC,CAAC,UAAD,EAAa,EAAb,CAxBqC,EAyBrC,CAAC,WAAD,EAAc,EAAd,CAzBqC,EA0BrC,CAAC,YAAD,EAAe,EAAf,CA1BqC,EA2BrC,CAAC,UAAD,EAAa,EAAb,CA3BqC,EA4BrC,CAAC,YAAD,EAAe,EAAf,CA5BqC,EA6BrC,CAAC,OAAD,EAAU,EAAV,CA7BqC,EA8BrC,CAAC,QAAD,EAAW,EAAX,CA9BqC,EA+BrC,CAAC,OAAD,EAAU,EAAV,CA/BqC,EAgCrC,CAAC,GAAD,EAAM,EAAN,CAhCqC,EAiCrC,CAAC,GAAD,EAAM,EAAN,CAjCqC,EAkCrC,CAAC,GAAD,EAAM,EAAN,CAlCqC,EAmCrC,CAAC,GAAD,EAAM,EAAN,CAnCqC,EAoCrC,CAAC,GAAD,EAAM,EAAN,CApCqC,EAqCrC,CAAC,GAAD,EAAM,EAAN,CArCqC,EAsCrC,CAAC,GAAD,EAAM,EAAN,CAtCqC,EAuCrC,CAAC,GAAD,EAAM,EAAN,CAvCqC,EAwCrC,CAAC,GAAD,EAAM,EAAN,CAxCqC,EAyCrC,CAAC,GAAD,EAAM,EAAN,CAzCqC,EA0CrC,CAAC,GAAD,EAAM,EAAN,CA1CqC,EA2CrC,CAAC,GAAD,EAAM,EAAN,CA3CqC,EA4CrC,CAAC,GAAD,EAAM,EAAN,CA5CqC,EA6CrC,CAAC,GAAD,EAAM,EAAN,CA7CqC,EA8CrC,CAAC,GAAD,EAAM,EAAN,CA9CqC,EA+CrC,CAAC,GAAD,EAAM,EAAN,CA/CqC,EAgDrC,CAAC,GAAD,EAAM,EAAN,CAhDqC,EAiDrC,CAAC,GAAD,EAAM,EAAN,CAjDqC,EAkDrC,CAAC,GAAD,EAAM,EAAN,CAlDqC,EAmDrC,CAAC,GAAD,EAAM,EAAN,CAnDqC,EAoDrC,CAAC,GAAD,EAAM,EAAN,CApDqC,EAqDrC,CAAC,GAAD,EAAM,EAAN,CArDqC,EAsDrC,CAAC,GAAD,EAAM,EAAN,CAtDqC,EAuDrC,CAAC,GAAD,EAAM,EAAN,CAvDqC,EAwDrC,CAAC,GAAD,EAAM,EAAN,CAxDqC,EAyDrC,CAAC,GAAD,EAAM,EAAN,CAzDqC,EA0DrC,CAAC,OAAD,EAAU,EAAV,CA1DqC,EA2DrC,CAAC,GAAD,EAAM,EAAN,CA3DqC,EA4DrC,CAAC,QAAD,EAAW,EAAX,CA5DqC,EA6DrC,CAAC,GAAD,EAAM,EAAN,CA7DqC,EA8DrC,CAAC,SAAD,EAAY,EAAZ,CA9DqC,EA+DrC,CAAC,UAAD,EAAa,EAAb,CA/DqC,EAgErC,CAAC,WAAD,EAAc,EAAd,CAhEqC,EAiErC,CAAC,YAAD,EAAe,EAAf,CAjEqC,EAkErC,CAAC,KAAD,EAAQ,EAAR,CAlEqC,EAmErC,CAAC,IAAD,EAAO,EAAP,CAnEqC,EAoErC,CAAC,OAAD,EAAU,EAAV,CApEqC,EAqErC,CAAC,GAAD,EAAM,EAAN,CArEqC,EAsErC,CAAC,KAAD,EAAQ,EAAR,CAtEqC,EAuErC,CAAC,UAAD,EAAa,EAAb,CAvEqC,EAwErC,CAAC,SAAD,EAAY,EAAZ,CAxEqC,EAyErC,CAAC,OAAD,EAAU,EAAV,CAzEqC,EA0ErC,CAAC,KAAD,EAAQ,EAAR,CA1EqC,EA2ErC,CAAC,OAAD,EAAU,EAAV,CA3EqC,EA4ErC,CAAC,OAAD,EAAU,EAAV,CA5EqC,EA6ErC,CAAC,GAAD,EAAM,EAAN,CA7EqC,EA8ErC,CAAC,QAAD,EAAW,EAAX,CA9EqC,EA+ErC,CAAC,GAAD,EAAM,EAAN,CA/EqC,EAgFrC,CAAC,aAAD,EAAgB,EAAhB,CAhFqC,EAiFrC,CAAC,GAAD,EAAM,EAAN,CAjFqC,EAkFrC,CAAC,cAAD,EAAiB,EAAjB,CAlFqC,EAmFrC,CAAC,GAAD,EAAM,EAAN,CAnFqC,EAoFrC,CAAC,WAAD,EAAc,EAAd,CApFqC,EAqFrC,CAAC,IAAD,EAAO,EAAP,CArFqC,EAsFrC,CAAC,WAAD,EAAc,EAAd,CAtFqC,EAuFrC,CAAC,GAAD,EAAM,EAAN,CAvFqC,EAwFrC,CAAC,YAAD,EAAe,EAAf,CAxFqC,EAyFrC,CAAC,GAAD,EAAM,EAAN,CAzFqC,EA0FrC,CAAC,OAAD,EAAU,EAAV,CA1FqC,EA2FrC,CAAC,GAAD,EAAM,EAAN,CA3FqC,EA4FrC,CAAC,IAAD,EAAO,EAAP,CA5FqC,EA6FrC,CAAC,GAAD,EAAM,EAAN,CA7FqC,EA8FrC,CAAC,KAAD,EAAQ,EAAR,CA9FqC,EA+FrC,CAAC,aAAD,EAAgB,EAAhB,CA/FqC,EAgGrC,CAAC,OAAD,EAAU,EAAV,CAhGqC,EAiGrC,CAAC,MAAD,EAAS,EAAT,CAjGqC,EAkGrC,CAAC,MAAD,EAAS,EAAT,CAlGqC,EAmGrC,CAAC,cAAD,EAAiB,EAAjB,CAnGqC,EAoGrC,CAAC,QAAD,EAAW,EAAX,CApGqC,EAqGrC,CAAC,WAAD,EAAc,GAAd,CArGqC,EAsGrC,CAAC,QAAD,EAAW,GAAX,CAtGqC,EAuGrC,CAAC,KAAD,EAAQ,GAAR,CAvGqC,EAwGrC,CAAC,MAAD,EAAS,GAAT,CAxGqC,EAyGrC,CAAC,OAAD,EAAU,GAAV,CAzGqC,CAAxB,CAAf","sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the 'License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Dispatcher, DispatcherScope, existingDispatcher } from './dispatcher';\nimport { Android, AndroidDevice, SocketBackend } from '../server/android/android';\nimport * as channels from '../protocol/channels';\nimport { BrowserContextDispatcher } from './browserContextDispatcher';\nimport { CallMetadata } from '../server/instrumentation';\n\nexport class AndroidDispatcher extends Dispatcher<Android, channels.AndroidInitializer> implements channels.AndroidChannel {\n  constructor(scope: DispatcherScope, android: Android) {\n    super(scope, android, 'Android', {}, true);\n  }\n\n  async devices(params: channels.AndroidDevicesParams): Promise<channels.AndroidDevicesResult> {\n    const devices = await this._object.devices();\n    return {\n      devices: devices.map(d => AndroidDeviceDispatcher.from(this._scope, d))\n    };\n  }\n\n  async setDefaultTimeoutNoReply(params: channels.AndroidSetDefaultTimeoutNoReplyParams) {\n    this._object.setDefaultTimeout(params.timeout);\n  }\n}\n\nexport class AndroidDeviceDispatcher extends Dispatcher<AndroidDevice, channels.AndroidDeviceInitializer> implements channels.AndroidDeviceChannel {\n\n  static from(scope: DispatcherScope, device: AndroidDevice): AndroidDeviceDispatcher {\n    const result = existingDispatcher<AndroidDeviceDispatcher>(device);\n    return result || new AndroidDeviceDispatcher(scope, device);\n  }\n\n  constructor(scope: DispatcherScope, device: AndroidDevice) {\n    super(scope, device, 'AndroidDevice', {\n      model: device.model,\n      serial: device.serial,\n    }, true);\n    for (const webView of device.webViews())\n      this._dispatchEvent('webViewAdded', { webView });\n    device.on(AndroidDevice.Events.WebViewAdded, webView => this._dispatchEvent('webViewAdded', { webView }));\n    device.on(AndroidDevice.Events.WebViewRemoved, pid => this._dispatchEvent('webViewRemoved', { pid }));\n  }\n\n  async wait(params: channels.AndroidDeviceWaitParams) {\n    await this._object.send('wait', params);\n  }\n\n  async fill(params: channels.AndroidDeviceFillParams) {\n    await this._object.send('click', { selector: params.selector });\n    await this._object.send('fill', params);\n  }\n\n  async tap(params: channels.AndroidDeviceTapParams) {\n    await this._object.send('click', params);\n  }\n\n  async drag(params: channels.AndroidDeviceDragParams) {\n    await this._object.send('drag', params);\n  }\n\n  async fling(params: channels.AndroidDeviceFlingParams) {\n    await this._object.send('fling', params);\n  }\n\n  async longTap(params: channels.AndroidDeviceLongTapParams) {\n    await this._object.send('longClick', params);\n  }\n\n  async pinchClose(params: channels.AndroidDevicePinchCloseParams) {\n    await this._object.send('pinchClose', params);\n  }\n\n  async pinchOpen(params: channels.AndroidDevicePinchOpenParams) {\n    await this._object.send('pinchOpen', params);\n  }\n\n  async scroll(params: channels.AndroidDeviceScrollParams) {\n    await this._object.send('scroll', params);\n  }\n\n  async swipe(params: channels.AndroidDeviceSwipeParams) {\n    await this._object.send('swipe', params);\n  }\n\n  async info(params: channels.AndroidDeviceTapParams): Promise<channels.AndroidDeviceInfoResult> {\n    return { info: await this._object.send('info', params) };\n  }\n\n  async inputType(params: channels.AndroidDeviceInputTypeParams) {\n    const text = params.text;\n    const keyCodes: number[] = [];\n    for (let i = 0; i < text.length; ++i) {\n      const code = keyMap.get(text[i].toUpperCase());\n      if (code === undefined)\n        throw new Error('No mapping for ' + text[i] + ' found');\n      keyCodes.push(code);\n    }\n    await Promise.all(keyCodes.map(keyCode => this._object.send('inputPress', { keyCode })));\n  }\n\n  async inputPress(params: channels.AndroidDeviceInputPressParams) {\n    if (!keyMap.has(params.key))\n      throw new Error('Unknown key: ' + params.key);\n    await this._object.send('inputPress', { keyCode: keyMap.get(params.key) });\n  }\n\n  async inputTap(params: channels.AndroidDeviceInputTapParams) {\n    await this._object.send('inputClick', params);\n  }\n\n  async inputSwipe(params: channels.AndroidDeviceInputSwipeParams) {\n    await this._object.send('inputSwipe', params);\n  }\n\n  async inputDrag(params: channels.AndroidDeviceInputDragParams) {\n    await this._object.send('inputDrag', params);\n  }\n\n  async screenshot(params: channels.AndroidDeviceScreenshotParams): Promise<channels.AndroidDeviceScreenshotResult> {\n    return { binary: (await this._object.screenshot()).toString('base64') };\n  }\n\n  async shell(params: channels.AndroidDeviceShellParams): Promise<channels.AndroidDeviceShellResult> {\n    return { result: (await this._object.shell(params.command)).toString('base64') };\n  }\n\n  async open(params: channels.AndroidDeviceOpenParams, metadata: CallMetadata): Promise<channels.AndroidDeviceOpenResult> {\n    const socket = await this._object.open(params.command);\n    return { socket: new AndroidSocketDispatcher(this._scope, socket) };\n  }\n\n  async installApk(params: channels.AndroidDeviceInstallApkParams) {\n    await this._object.installApk(Buffer.from(params.file, 'base64'), { args: params.args });\n  }\n\n  async push(params: channels.AndroidDevicePushParams) {\n    await this._object.push(Buffer.from(params.file, 'base64'), params.path, params.mode);\n  }\n\n  async launchBrowser(params: channels.AndroidDeviceLaunchBrowserParams): Promise<channels.AndroidDeviceLaunchBrowserResult> {\n    const context = await this._object.launchBrowser(params.pkg, params);\n    return { context: new BrowserContextDispatcher(this._scope, context) };\n  }\n\n  async close(params: channels.AndroidDeviceCloseParams) {\n    await this._object.close();\n  }\n\n  async setDefaultTimeoutNoReply(params: channels.AndroidDeviceSetDefaultTimeoutNoReplyParams) {\n    this._object.setDefaultTimeout(params.timeout);\n  }\n\n  async connectToWebView(params: channels.AndroidDeviceConnectToWebViewParams): Promise<channels.AndroidDeviceConnectToWebViewResult> {\n    return { context: new BrowserContextDispatcher(this._scope, await this._object.connectToWebView(params.pid, params.sdkLanguage)) };\n  }\n}\n\nexport class AndroidSocketDispatcher extends Dispatcher<SocketBackend, channels.AndroidSocketInitializer> implements channels.AndroidSocketChannel {\n  constructor(scope: DispatcherScope, socket: SocketBackend) {\n    super(scope, socket, 'AndroidSocket', {}, true);\n    socket.on('data', (data: Buffer) => this._dispatchEvent('data', { data: data.toString('base64') }));\n    socket.on('close', () => {\n      this._dispatchEvent('close');\n      this._dispose();\n    });\n  }\n\n  async write(params: channels.AndroidSocketWriteParams, metadata: CallMetadata): Promise<void> {\n    await this._object.write(Buffer.from(params.data, 'base64'));\n  }\n\n  async close(params: channels.AndroidSocketCloseParams, metadata: CallMetadata): Promise<void> {\n    this._object.close();\n  }\n}\n\nconst keyMap = new Map<string, number>([\n  ['Unknown', 0],\n  ['SoftLeft', 1],\n  ['SoftRight', 2],\n  ['Home', 3],\n  ['Back', 4],\n  ['Call', 5],\n  ['EndCall', 6],\n  ['0', 7],\n  ['1', 8],\n  ['2', 9],\n  ['3', 10],\n  ['4', 11],\n  ['5', 12],\n  ['6', 13],\n  ['7', 14],\n  ['8', 15],\n  ['9', 16],\n  ['Star', 17],\n  ['*', 17],\n  ['Pound', 18],\n  ['#', 18],\n  ['DialUp', 19],\n  ['DialDown', 20],\n  ['DialLeft', 21],\n  ['DialRight', 22],\n  ['DialCenter', 23],\n  ['VolumeUp', 24],\n  ['VolumeDown', 25],\n  ['Power', 26],\n  ['Camera', 27],\n  ['Clear', 28],\n  ['A', 29],\n  ['B', 30],\n  ['C', 31],\n  ['D', 32],\n  ['E', 33],\n  ['F', 34],\n  ['G', 35],\n  ['H', 36],\n  ['I', 37],\n  ['J', 38],\n  ['K', 39],\n  ['L', 40],\n  ['M', 41],\n  ['N', 42],\n  ['O', 43],\n  ['P', 44],\n  ['Q', 45],\n  ['R', 46],\n  ['S', 47],\n  ['T', 48],\n  ['U', 49],\n  ['V', 50],\n  ['W', 51],\n  ['X', 52],\n  ['Y', 53],\n  ['Z', 54],\n  ['Comma', 55],\n  [',', 55],\n  ['Period', 56],\n  ['.', 56],\n  ['AltLeft', 57],\n  ['AltRight', 58],\n  ['ShiftLeft', 59],\n  ['ShiftRight', 60],\n  ['Tab', 61],\n  ['\\t', 61],\n  ['Space', 62],\n  [' ', 62],\n  ['Sym', 63],\n  ['Explorer', 64],\n  ['Envelop', 65],\n  ['Enter', 66],\n  ['Del', 67],\n  ['Grave', 68],\n  ['Minus', 69],\n  ['-', 69],\n  ['Equals', 70],\n  ['=', 70],\n  ['LeftBracket', 71],\n  ['(', 71],\n  ['RightBracket', 72],\n  [')', 72],\n  ['Backslash', 73],\n  ['\\\\', 73],\n  ['Semicolon', 74],\n  [';', 74],\n  ['Apostrophe', 75],\n  ['`', 75],\n  ['Slash', 76],\n  ['/', 76],\n  ['At', 77],\n  ['@', 77],\n  ['Num', 78],\n  ['HeadsetHook', 79],\n  ['Focus', 80],\n  ['Plus', 81],\n  ['Menu', 82],\n  ['Notification', 83],\n  ['Search', 84],\n  ['AppSwitch', 187],\n  ['Assist', 219],\n  ['Cut', 277],\n  ['Copy', 278],\n  ['Paste', 279],\n]);\n"],"file":"androidDispatcher.js"}