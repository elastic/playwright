{"version":3,"sources":["../../src/dispatchers/pageDispatcher.ts"],"names":["PageDispatcher","Dispatcher","fromNullable","scope","page","undefined","result","constructor","mainFrame","FrameDispatcher","from","viewportSize","isClosed","opener","_page","on","Page","Events","Close","_dispatchEvent","_dispose","Console","message","ConsoleMessageDispatcher","_scope","Crash","DOMContentLoaded","Dialog","dialog","DialogDispatcher","Download","download","url","suggestedFilename","artifact","ArtifactDispatcher","FileChooser","fileChooser","element","ElementHandleDispatcher","isMultiple","FrameAttached","frame","_onFrameAttached","FrameDetached","_onFrameDetached","Load","PageError","error","WebSocket","webSocket","WebSocketDispatcher","Worker","worker","WorkerDispatcher","Video","_video","setDefaultNavigationTimeoutNoReply","params","metadata","setDefaultNavigationTimeout","timeout","setDefaultTimeoutNoReply","setDefaultTimeout","exposeBinding","name","needsHandle","source","args","binding","BindingCallDispatcher","promise","setExtraHTTPHeaders","headers","reload","response","goBack","goForward","emulateMedia","media","colorScheme","reducedMotion","setViewportSize","addInitScript","_addInitScriptExpression","setNetworkInterceptionEnabled","enabled","_setClientRequestInterceptor","route","request","RouteDispatcher","RequestDispatcher","screenshot","binary","toString","close","setFileChooserInterceptedNoReply","_setFileChooserIntercepted","intercepted","keyboardDown","keyboard","down","key","keyboardUp","up","keyboardInsertText","insertText","text","keyboardType","type","keyboardPress","press","mouseMove","mouse","move","x","y","mouseDown","mouseUp","mouseClick","click","touchscreenTap","touchscreen","tap","accessibilitySnapshot","rootAXNode","accessibility","snapshot","interestingOnly","root","_elementHandle","pdf","Error","buffer","bringToFront","startJSCoverage","coverage","stopJSCoverage","entries","startCSSCoverage","stopCSSCoverage","evaluateExpression","value","_object","expression","isFunction","arg","evaluateExpressionHandle","handle","fromJSHandle","guid","map","serializeResult","_resolve","_reject","_promise","Promise","resolve","reject"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BrowserContext } from '../server/browserContext';\nimport { Frame } from '../server/frames';\nimport { Page, Worker } from '../server/page';\nimport * as channels from '../protocol/channels';\nimport { Dispatcher, DispatcherScope, existingDispatcher, lookupDispatcher, lookupNullableDispatcher } from './dispatcher';\nimport { parseError, serializeError } from '../protocol/serializers';\nimport { ConsoleMessageDispatcher } from './consoleMessageDispatcher';\nimport { DialogDispatcher } from './dialogDispatcher';\nimport { FrameDispatcher } from './frameDispatcher';\nimport { RequestDispatcher, ResponseDispatcher, RouteDispatcher, WebSocketDispatcher } from './networkDispatchers';\nimport { serializeResult, parseArgument } from './jsHandleDispatcher';\nimport { ElementHandleDispatcher } from './elementHandlerDispatcher';\nimport { FileChooser } from '../server/fileChooser';\nimport { CRCoverage } from '../server/chromium/crCoverage';\nimport { JSHandle } from '../server/javascript';\nimport { CallMetadata } from '../server/instrumentation';\nimport { Artifact } from '../server/artifact';\nimport { ArtifactDispatcher } from './artifactDispatcher';\nimport { Download } from '../server/download';\nimport { createGuid } from '../utils/utils';\n\nexport class PageDispatcher extends Dispatcher<Page, channels.PageInitializer> implements channels.PageChannel {\n  private _page: Page;\n\n  static fromNullable(scope: DispatcherScope, page: Page | undefined): PageDispatcher | undefined {\n    if (!page)\n      return undefined;\n    const result = existingDispatcher<PageDispatcher>(page);\n    return result || new PageDispatcher(scope, page);\n  }\n\n  constructor(scope: DispatcherScope, page: Page) {\n    // TODO: theoretically, there could be more than one frame already.\n    // If we split pageCreated and pageReady, there should be no main frame during pageCreated.\n    super(scope, page, 'Page', {\n      mainFrame: FrameDispatcher.from(scope, page.mainFrame()),\n      viewportSize: page.viewportSize() || undefined,\n      isClosed: page.isClosed(),\n      opener: PageDispatcher.fromNullable(scope, page.opener())\n    }, true);\n    this._page = page;\n    page.on(Page.Events.Close, () => {\n      this._dispatchEvent('close');\n      this._dispose();\n    });\n    page.on(Page.Events.Console, message => this._dispatchEvent('console', { message: new ConsoleMessageDispatcher(this._scope, message) }));\n    page.on(Page.Events.Crash, () => this._dispatchEvent('crash'));\n    page.on(Page.Events.DOMContentLoaded, () => this._dispatchEvent('domcontentloaded'));\n    page.on(Page.Events.Dialog, dialog => this._dispatchEvent('dialog', { dialog: new DialogDispatcher(this._scope, dialog) }));\n    page.on(Page.Events.Download, (download: Download) => {\n      this._dispatchEvent('download', { url: download.url, suggestedFilename: download.suggestedFilename(), artifact: new ArtifactDispatcher(scope, download.artifact) });\n    });\n    this._page.on(Page.Events.FileChooser, (fileChooser: FileChooser) => this._dispatchEvent('fileChooser', {\n      element: ElementHandleDispatcher.from(this._scope, fileChooser.element()),\n      isMultiple: fileChooser.isMultiple()\n    }));\n    page.on(Page.Events.FrameAttached, frame => this._onFrameAttached(frame));\n    page.on(Page.Events.FrameDetached, frame => this._onFrameDetached(frame));\n    page.on(Page.Events.Load, () => this._dispatchEvent('load'));\n    page.on(Page.Events.PageError, error => this._dispatchEvent('pageError', { error: serializeError(error) }));\n    page.on(Page.Events.WebSocket, webSocket => this._dispatchEvent('webSocket', { webSocket: new WebSocketDispatcher(this._scope, webSocket) }));\n    page.on(Page.Events.Worker, worker => this._dispatchEvent('worker', { worker: new WorkerDispatcher(this._scope, worker) }));\n    page.on(Page.Events.Video, (artifact: Artifact) => this._dispatchEvent('video', { artifact: existingDispatcher<ArtifactDispatcher>(artifact) }));\n    if (page._video)\n      this._dispatchEvent('video', { artifact: existingDispatcher<ArtifactDispatcher>(page._video) });\n  }\n\n  page(): Page {\n    return this._page;\n  }\n\n  async setDefaultNavigationTimeoutNoReply(params: channels.PageSetDefaultNavigationTimeoutNoReplyParams, metadata: CallMetadata): Promise<void> {\n    this._page.setDefaultNavigationTimeout(params.timeout);\n  }\n\n  async setDefaultTimeoutNoReply(params: channels.PageSetDefaultTimeoutNoReplyParams, metadata: CallMetadata): Promise<void> {\n    this._page.setDefaultTimeout(params.timeout);\n  }\n\n  async exposeBinding(params: channels.PageExposeBindingParams, metadata: CallMetadata): Promise<void> {\n    await this._page.exposeBinding(params.name, !!params.needsHandle, (source, ...args) => {\n      const binding = new BindingCallDispatcher(this._scope, params.name, !!params.needsHandle, source, args);\n      this._dispatchEvent('bindingCall', { binding });\n      return binding.promise();\n    });\n  }\n\n  async setExtraHTTPHeaders(params: channels.PageSetExtraHTTPHeadersParams, metadata: CallMetadata): Promise<void> {\n    await this._page.setExtraHTTPHeaders(params.headers);\n  }\n\n  async reload(params: channels.PageReloadParams, metadata: CallMetadata): Promise<channels.PageReloadResult> {\n    return { response: lookupNullableDispatcher<ResponseDispatcher>(await this._page.reload(metadata, params)) };\n  }\n\n  async goBack(params: channels.PageGoBackParams, metadata: CallMetadata): Promise<channels.PageGoBackResult> {\n    return { response: lookupNullableDispatcher<ResponseDispatcher>(await this._page.goBack(metadata, params)) };\n  }\n\n  async goForward(params: channels.PageGoForwardParams, metadata: CallMetadata): Promise<channels.PageGoForwardResult> {\n    return { response: lookupNullableDispatcher<ResponseDispatcher>(await this._page.goForward(metadata, params)) };\n  }\n\n  async emulateMedia(params: channels.PageEmulateMediaParams, metadata: CallMetadata): Promise<void> {\n    await this._page.emulateMedia({\n      media: params.media === 'null' ? null : params.media,\n      colorScheme: params.colorScheme === 'null' ? null : params.colorScheme,\n      reducedMotion: params.reducedMotion === 'null' ? null : params.reducedMotion,\n    });\n  }\n\n  async setViewportSize(params: channels.PageSetViewportSizeParams, metadata: CallMetadata): Promise<void> {\n    await this._page.setViewportSize(params.viewportSize);\n  }\n\n  async addInitScript(params: channels.PageAddInitScriptParams, metadata: CallMetadata): Promise<void> {\n    await this._page._addInitScriptExpression(params.source);\n  }\n\n  async setNetworkInterceptionEnabled(params: channels.PageSetNetworkInterceptionEnabledParams, metadata: CallMetadata): Promise<void> {\n    if (!params.enabled) {\n      await this._page._setClientRequestInterceptor(undefined);\n      return;\n    }\n    await this._page._setClientRequestInterceptor((route, request) => {\n      this._dispatchEvent('route', { route: RouteDispatcher.from(this._scope, route), request: RequestDispatcher.from(this._scope, request) });\n    });\n  }\n\n  async screenshot(params: channels.PageScreenshotParams, metadata: CallMetadata): Promise<channels.PageScreenshotResult> {\n    return { binary: (await this._page.screenshot(metadata, params)).toString('base64') };\n  }\n\n  async close(params: channels.PageCloseParams, metadata: CallMetadata): Promise<void> {\n    await this._page.close(metadata, params);\n  }\n\n  async setFileChooserInterceptedNoReply(params: channels.PageSetFileChooserInterceptedNoReplyParams, metadata: CallMetadata): Promise<void> {\n    await this._page._setFileChooserIntercepted(params.intercepted);\n  }\n\n  async keyboardDown(params: channels.PageKeyboardDownParams, metadata: CallMetadata): Promise<void> {\n    await this._page.keyboard.down(params.key);\n  }\n\n  async keyboardUp(params: channels.PageKeyboardUpParams, metadata: CallMetadata): Promise<void> {\n    await this._page.keyboard.up(params.key);\n  }\n\n  async keyboardInsertText(params: channels.PageKeyboardInsertTextParams, metadata: CallMetadata): Promise<void> {\n    await this._page.keyboard.insertText(params.text);\n  }\n\n  async keyboardType(params: channels.PageKeyboardTypeParams, metadata: CallMetadata): Promise<void> {\n    await this._page.keyboard.type(params.text, params);\n  }\n\n  async keyboardPress(params: channels.PageKeyboardPressParams, metadata: CallMetadata): Promise<void> {\n    await this._page.keyboard.press(params.key, params);\n  }\n\n  async mouseMove(params: channels.PageMouseMoveParams, metadata: CallMetadata): Promise<void> {\n    await this._page.mouse.move(params.x, params.y, params);\n  }\n\n  async mouseDown(params: channels.PageMouseDownParams, metadata: CallMetadata): Promise<void> {\n    await this._page.mouse.down(params);\n  }\n\n  async mouseUp(params: channels.PageMouseUpParams, metadata: CallMetadata): Promise<void> {\n    await this._page.mouse.up(params);\n  }\n\n  async mouseClick(params: channels.PageMouseClickParams, metadata: CallMetadata): Promise<void> {\n    await this._page.mouse.click(params.x, params.y, params);\n  }\n\n  async touchscreenTap(params: channels.PageTouchscreenTapParams, metadata: CallMetadata): Promise<void> {\n    await this._page.touchscreen.tap(params.x, params.y);\n  }\n\n  async accessibilitySnapshot(params: channels.PageAccessibilitySnapshotParams, metadata: CallMetadata): Promise<channels.PageAccessibilitySnapshotResult> {\n    const rootAXNode = await this._page.accessibility.snapshot({\n      interestingOnly: params.interestingOnly,\n      root: params.root ? (params.root as ElementHandleDispatcher)._elementHandle : undefined\n    });\n    return { rootAXNode: rootAXNode || undefined };\n  }\n\n  async pdf(params: channels.PagePdfParams, metadata: CallMetadata): Promise<channels.PagePdfResult> {\n    if (!this._page.pdf)\n      throw new Error('PDF generation is only supported for Headless Chromium');\n    const buffer = await this._page.pdf(params);\n    return { pdf: buffer.toString('base64') };\n  }\n\n  async bringToFront(params: channels.PageBringToFrontParams, metadata: CallMetadata): Promise<void> {\n    await this._page.bringToFront();\n  }\n\n  async startJSCoverage(params: channels.PageStartJSCoverageParams, metadata: CallMetadata): Promise<void> {\n    const coverage = this._page.coverage as CRCoverage;\n    await coverage.startJSCoverage(params);\n  }\n\n  async stopJSCoverage(params: channels.PageStopJSCoverageParams, metadata: CallMetadata): Promise<channels.PageStopJSCoverageResult> {\n    const coverage = this._page.coverage as CRCoverage;\n    return { entries: await coverage.stopJSCoverage() };\n  }\n\n  async startCSSCoverage(params: channels.PageStartCSSCoverageParams, metadata: CallMetadata): Promise<void> {\n    const coverage = this._page.coverage as CRCoverage;\n    await coverage.startCSSCoverage(params);\n  }\n\n  async stopCSSCoverage(params: channels.PageStopCSSCoverageParams, metadata: CallMetadata): Promise<channels.PageStopCSSCoverageResult> {\n    const coverage = this._page.coverage as CRCoverage;\n    return { entries: await coverage.stopCSSCoverage() };\n  }\n\n  _onFrameAttached(frame: Frame) {\n    this._dispatchEvent('frameAttached', { frame: FrameDispatcher.from(this._scope, frame) });\n  }\n\n  _onFrameDetached(frame: Frame) {\n    this._dispatchEvent('frameDetached', { frame: lookupDispatcher<FrameDispatcher>(frame) });\n  }\n}\n\n\nexport class WorkerDispatcher extends Dispatcher<Worker, channels.WorkerInitializer> implements channels.WorkerChannel {\n  constructor(scope: DispatcherScope, worker: Worker) {\n    super(scope, worker, 'Worker', {\n      url: worker.url()\n    });\n    worker.on(Worker.Events.Close, () => this._dispatchEvent('close'));\n  }\n\n  async evaluateExpression(params: channels.WorkerEvaluateExpressionParams, metadata: CallMetadata): Promise<channels.WorkerEvaluateExpressionResult> {\n    return { value: serializeResult(await this._object.evaluateExpression(params.expression, params.isFunction, parseArgument(params.arg))) };\n  }\n\n  async evaluateExpressionHandle(params: channels.WorkerEvaluateExpressionHandleParams, metadata: CallMetadata): Promise<channels.WorkerEvaluateExpressionHandleResult> {\n    return { handle: ElementHandleDispatcher.fromJSHandle(this._scope, await this._object.evaluateExpressionHandle(params.expression, params.isFunction, parseArgument(params.arg))) };\n  }\n}\n\nexport class BindingCallDispatcher extends Dispatcher<{ guid: string }, channels.BindingCallInitializer> implements channels.BindingCallChannel {\n  private _resolve: ((arg: any) => void) | undefined;\n  private _reject: ((error: any) => void) | undefined;\n  private _promise: Promise<any>;\n\n  constructor(scope: DispatcherScope, name: string, needsHandle: boolean, source: { context: BrowserContext, page: Page, frame: Frame }, args: any[]) {\n    super(scope, { guid: createGuid() }, 'BindingCall', {\n      frame: lookupDispatcher<FrameDispatcher>(source.frame),\n      name,\n      args: needsHandle ? undefined : args.map(serializeResult),\n      handle: needsHandle ? ElementHandleDispatcher.fromJSHandle(scope, args[0] as JSHandle) : undefined,\n    });\n    this._promise = new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n  }\n\n  promise() {\n    return this._promise;\n  }\n\n  async resolve(params: channels.BindingCallResolveParams, metadata: CallMetadata): Promise<void> {\n    this._resolve!(parseArgument(params.result));\n  }\n\n  async reject(params: channels.BindingCallRejectParams, metadata: CallMetadata): Promise<void> {\n    this._reject!(parseError(params.error));\n  }\n}\n"],"file":"pageDispatcher.js"}