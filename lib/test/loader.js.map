{"version":3,"sources":["../../src/test/loader.ts"],"names":["Loader","constructor","defaultConfig","configOverrides","_defaultConfig","_configOverrides","_fullConfig","_config","_configFile","_projects","_fileSuites","Map","baseFullConfig","deserialize","data","loader","overrides","configFile","loadConfigFile","file","loadEmptyConfig","rootDir","Error","config","_requireOrImport","rawConfig","_processConfigObject","path","dirname","validateConfig","globalSetup","resolveScript","globalTeardown","configUse","use","testDir","undefined","resolve","projects","forbidOnly","takeFirst","globalTimeout","grep","grepInvert","maxFailures","preserveOutput","reporter","toReporters","resolveReporters","reportSlowTests","quiet","shard","updateSnapshots","workers","webServer","project","_addProject","map","p","loadTestFile","has","get","suite","Suite","relative","basename","_requireFile","location","line","column","set","loadGlobalHook","name","hook","loadReporter","func","fullConfig","fileSuites","serialize","projectConfig","isAbsolute","outputDir","process","cwd","fullProject","define","expect","repeatEach","retries","metadata","testIgnore","testMatch","timeout","push","ProjectImpl","length","revertBabelRequire","esmImport","eval","JSON","stringify","url","pathToFileURL","endsWith","require","e","code","error","SyntaxError","message","includes","args","arg","reporters","validateProject","Array","isArray","forEach","item","index","max","threshold","total","current","title","validateDefine","prop","value","test","fixtures","id","builtInReporters","paths","localPath","fs","existsSync"],"mappings":"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","sourcesContent":["/**\n * Copyright Microsoft Corporation. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { installTransform } from './transform';\nimport type { FullConfig, Config, FullProject, Project, ReporterDescription, PreserveOutput } from './types';\nimport { isRegExp, mergeObjects, errorWithFile } from './util';\nimport { setCurrentlyLoadingFileSuite } from './globals';\nimport { Suite } from './test';\nimport { SerializedLoaderData } from './ipc';\nimport * as path from 'path';\nimport * as url from 'url';\nimport * as fs from 'fs';\nimport { ProjectImpl } from './project';\nimport { Reporter } from '../../types/testReporter';\nimport { BuiltInReporter, builtInReporters } from './runner';\n\nexport class Loader {\n  private _defaultConfig: Config;\n  private _configOverrides: Config;\n  private _fullConfig: FullConfig;\n  private _config: Config = {};\n  private _configFile: string | undefined;\n  private _projects: ProjectImpl[] = [];\n  private _fileSuites = new Map<string, Suite>();\n\n  constructor(defaultConfig: Config, configOverrides: Config) {\n    this._defaultConfig = defaultConfig;\n    this._configOverrides = configOverrides;\n    this._fullConfig = baseFullConfig;\n  }\n\n  static async deserialize(data: SerializedLoaderData): Promise<Loader> {\n    const loader = new Loader(data.defaultConfig, data.overrides);\n    if ('file' in data.configFile)\n      await loader.loadConfigFile(data.configFile.file);\n    else\n      loader.loadEmptyConfig(data.configFile.rootDir);\n    return loader;\n  }\n\n  async loadConfigFile(file: string): Promise<Config> {\n    if (this._configFile)\n      throw new Error('Cannot load two config files');\n    let config = await this._requireOrImport(file);\n    if (config && typeof config === 'object' && ('default' in config))\n      config = config['default'];\n    this._config = config;\n    this._configFile = file;\n    const rawConfig = { ...config };\n    this._processConfigObject(path.dirname(file));\n    return rawConfig;\n  }\n\n  loadEmptyConfig(rootDir: string) {\n    this._config = {};\n    this._processConfigObject(rootDir);\n  }\n\n  private _processConfigObject(rootDir: string) {\n    validateConfig(this._configFile || '<default config>', this._config);\n\n    // Resolve script hooks relative to the root dir.\n    if (this._config.globalSetup)\n      this._config.globalSetup = resolveScript(this._config.globalSetup, rootDir);\n    if (this._config.globalTeardown)\n      this._config.globalTeardown = resolveScript(this._config.globalTeardown, rootDir);\n\n    const configUse = mergeObjects(this._defaultConfig.use, this._config.use);\n    this._config = mergeObjects(mergeObjects(this._defaultConfig, this._config), { use: configUse });\n\n    if (this._config.testDir !== undefined)\n      this._config.testDir = path.resolve(rootDir, this._config.testDir);\n    const projects: Project[] = ('projects' in this._config) && this._config.projects !== undefined ? this._config.projects : [this._config];\n\n    this._fullConfig.rootDir = this._config.testDir || rootDir;\n    this._fullConfig.forbidOnly = takeFirst(this._configOverrides.forbidOnly, this._config.forbidOnly, baseFullConfig.forbidOnly);\n    this._fullConfig.globalSetup = takeFirst(this._configOverrides.globalSetup, this._config.globalSetup, baseFullConfig.globalSetup);\n    this._fullConfig.globalTeardown = takeFirst(this._configOverrides.globalTeardown, this._config.globalTeardown, baseFullConfig.globalTeardown);\n    this._fullConfig.globalTimeout = takeFirst(this._configOverrides.globalTimeout, this._configOverrides.globalTimeout, this._config.globalTimeout, baseFullConfig.globalTimeout);\n    this._fullConfig.grep = takeFirst(this._configOverrides.grep, this._config.grep, baseFullConfig.grep);\n    this._fullConfig.grepInvert = takeFirst(this._configOverrides.grepInvert, this._config.grepInvert, baseFullConfig.grepInvert);\n    this._fullConfig.maxFailures = takeFirst(this._configOverrides.maxFailures, this._config.maxFailures, baseFullConfig.maxFailures);\n    this._fullConfig.preserveOutput = takeFirst<PreserveOutput>(this._configOverrides.preserveOutput, this._config.preserveOutput, baseFullConfig.preserveOutput);\n    this._fullConfig.reporter = takeFirst(toReporters(this._configOverrides.reporter as any), resolveReporters(this._config.reporter, rootDir), baseFullConfig.reporter);\n    this._fullConfig.reportSlowTests = takeFirst(this._configOverrides.reportSlowTests, this._config.reportSlowTests, baseFullConfig.reportSlowTests);\n    this._fullConfig.quiet = takeFirst(this._configOverrides.quiet, this._config.quiet, baseFullConfig.quiet);\n    this._fullConfig.shard = takeFirst(this._configOverrides.shard, this._config.shard, baseFullConfig.shard);\n    this._fullConfig.updateSnapshots = takeFirst(this._configOverrides.updateSnapshots, this._config.updateSnapshots, baseFullConfig.updateSnapshots);\n    this._fullConfig.workers = takeFirst(this._configOverrides.workers, this._config.workers, baseFullConfig.workers);\n    this._fullConfig.webServer = takeFirst(this._configOverrides.webServer, this._config.webServer, baseFullConfig.webServer);\n\n    for (const project of projects)\n      this._addProject(project, this._fullConfig.rootDir);\n    this._fullConfig.projects = this._projects.map(p => p.config);\n  }\n\n  async loadTestFile(file: string) {\n    if (this._fileSuites.has(file))\n      return this._fileSuites.get(file)!;\n    try {\n      const suite = new Suite(path.relative(this._fullConfig.rootDir, file) || path.basename(file));\n      suite._requireFile = file;\n      suite.location = { file, line: 0, column: 0 };\n      setCurrentlyLoadingFileSuite(suite);\n      await this._requireOrImport(file);\n      this._fileSuites.set(file, suite);\n      return suite;\n    } finally {\n      setCurrentlyLoadingFileSuite(undefined);\n    }\n  }\n\n  async loadGlobalHook(file: string, name: string): Promise<(config: FullConfig) => any> {\n    let hook = await this._requireOrImport(file);\n    if (hook && typeof hook === 'object' && ('default' in hook))\n      hook = hook['default'];\n    if (typeof hook !== 'function')\n      throw errorWithFile(file, `${name} file must export a single function.`);\n    return hook;\n  }\n\n  async loadReporter(file: string): Promise<new (arg?: any) => Reporter> {\n    let func = await this._requireOrImport(path.resolve(this._fullConfig.rootDir, file));\n    if (func && typeof func === 'object' && ('default' in func))\n      func = func['default'];\n    if (typeof func !== 'function')\n      throw errorWithFile(file, `reporter file must export a single class.`);\n    return func;\n  }\n\n  fullConfig(): FullConfig {\n    return this._fullConfig;\n  }\n\n  projects() {\n    return this._projects;\n  }\n\n  fileSuites() {\n    return this._fileSuites;\n  }\n\n  serialize(): SerializedLoaderData {\n    return {\n      defaultConfig: this._defaultConfig,\n      configFile: this._configFile ? { file: this._configFile } : { rootDir: this._fullConfig.rootDir },\n      overrides: this._configOverrides,\n    };\n  }\n\n  private _addProject(projectConfig: Project, rootDir: string) {\n    let testDir = takeFirst(projectConfig.testDir, rootDir);\n    if (!path.isAbsolute(testDir))\n      testDir = path.resolve(rootDir, testDir);\n    let outputDir = takeFirst(this._configOverrides.outputDir, projectConfig.outputDir, this._config.outputDir, path.resolve(process.cwd(), 'test-results'));\n    if (!path.isAbsolute(outputDir))\n      outputDir = path.resolve(rootDir, outputDir);\n    const fullProject: FullProject = {\n      define: takeFirst(this._configOverrides.define, projectConfig.define, this._config.define, []),\n      expect: takeFirst(this._configOverrides.expect, projectConfig.expect, this._config.expect, undefined),\n      outputDir,\n      repeatEach: takeFirst(this._configOverrides.repeatEach, projectConfig.repeatEach, this._config.repeatEach, 1),\n      retries: takeFirst(this._configOverrides.retries, projectConfig.retries, this._config.retries, 0),\n      metadata: takeFirst(this._configOverrides.metadata, projectConfig.metadata, this._config.metadata, undefined),\n      name: takeFirst(this._configOverrides.name, projectConfig.name, this._config.name, ''),\n      testDir,\n      testIgnore: takeFirst(this._configOverrides.testIgnore, projectConfig.testIgnore, this._config.testIgnore, []),\n      testMatch: takeFirst(this._configOverrides.testMatch, projectConfig.testMatch, this._config.testMatch, '**/?(*.)@(spec|test).@(ts|js|mjs)'),\n      timeout: takeFirst(this._configOverrides.timeout, projectConfig.timeout, this._config.timeout, 10000),\n      use: mergeObjects(mergeObjects(this._config.use, projectConfig.use), this._configOverrides.use),\n    };\n    this._projects.push(new ProjectImpl(fullProject, this._projects.length));\n  }\n\n\n  private async _requireOrImport(file: string) {\n    const revertBabelRequire = installTransform();\n    try {\n      const esmImport = () => eval(`import(${JSON.stringify(url.pathToFileURL(file))})`);\n      if (file.endsWith('.mjs')) {\n        return await esmImport();\n      } else {\n        try {\n          return require(file);\n        } catch (e) {\n          // Attempt to load this module as ESM if a normal require didn't work.\n          if (e.code === 'ERR_REQUIRE_ESM')\n            return await esmImport();\n          throw e;\n        }\n      }\n    } catch (error) {\n      if (error instanceof SyntaxError && error.message.includes('Cannot use import statement outside a module'))\n        throw errorWithFile(file, 'JavaScript files must end with .mjs to use import.');\n\n      throw error;\n    } finally {\n      revertBabelRequire();\n    }\n  }\n}\n\nfunction takeFirst<T>(...args: (T | undefined)[]): T {\n  for (const arg of args) {\n    if (arg !== undefined)\n      return arg;\n  }\n  return undefined as any as T;\n}\n\nfunction toReporters(reporters: BuiltInReporter | ReporterDescription[] | undefined): ReporterDescription[] | undefined {\n  if (!reporters)\n    return;\n  if (typeof reporters === 'string')\n    return [ [reporters] ];\n  return reporters;\n}\n\nfunction validateConfig(file: string, config: Config) {\n  if (typeof config !== 'object' || !config)\n    throw errorWithFile(file, `Configuration file must export a single object`);\n\n  validateProject(file, config, 'config');\n\n  if ('forbidOnly' in config && config.forbidOnly !== undefined) {\n    if (typeof config.forbidOnly !== 'boolean')\n      throw errorWithFile(file, `config.forbidOnly must be a boolean`);\n  }\n\n  if ('globalSetup' in config && config.globalSetup !== undefined) {\n    if (typeof config.globalSetup !== 'string')\n      throw errorWithFile(file, `config.globalSetup must be a string`);\n  }\n\n  if ('globalTeardown' in config && config.globalTeardown !== undefined) {\n    if (typeof config.globalTeardown !== 'string')\n      throw errorWithFile(file, `config.globalTeardown must be a string`);\n  }\n\n  if ('globalTimeout' in config && config.globalTimeout !== undefined) {\n    if (typeof config.globalTimeout !== 'number' || config.globalTimeout < 0)\n      throw errorWithFile(file, `config.globalTimeout must be a non-negative number`);\n  }\n\n  if ('grep' in config && config.grep !== undefined) {\n    if (Array.isArray(config.grep)) {\n      config.grep.forEach((item, index) => {\n        if (!isRegExp(item))\n          throw errorWithFile(file, `config.grep[${index}] must be a RegExp`);\n      });\n    } else if (!isRegExp(config.grep)) {\n      throw errorWithFile(file, `config.grep must be a RegExp`);\n    }\n  }\n\n  if ('grepInvert' in config && config.grepInvert !== undefined) {\n    if (Array.isArray(config.grepInvert)) {\n      config.grepInvert.forEach((item, index) => {\n        if (!isRegExp(item))\n          throw errorWithFile(file, `config.grepInvert[${index}] must be a RegExp`);\n      });\n    } else if (!isRegExp(config.grepInvert)) {\n      throw errorWithFile(file, `config.grep must be a RegExp`);\n    }\n  }\n\n  if ('maxFailures' in config && config.maxFailures !== undefined) {\n    if (typeof config.maxFailures !== 'number' || config.maxFailures < 0)\n      throw errorWithFile(file, `config.maxFailures must be a non-negative number`);\n  }\n\n  if ('preserveOutput' in config && config.preserveOutput !== undefined) {\n    if (typeof config.preserveOutput !== 'string' || !['always', 'never', 'failures-only'].includes(config.preserveOutput))\n      throw errorWithFile(file, `config.preserveOutput must be one of \"always\", \"never\" or \"failures-only\"`);\n  }\n\n  if ('projects' in config && config.projects !== undefined) {\n    if (!Array.isArray(config.projects))\n      throw errorWithFile(file, `config.projects must be an array`);\n    config.projects.forEach((project, index) => {\n      validateProject(file, project, `config.projects[${index}]`);\n    });\n  }\n\n  if ('quiet' in config && config.quiet !== undefined) {\n    if (typeof config.quiet !== 'boolean')\n      throw errorWithFile(file, `config.quiet must be a boolean`);\n  }\n\n  if ('reporter' in config && config.reporter !== undefined) {\n    if (Array.isArray(config.reporter)) {\n      config.reporter.forEach((item, index) => {\n        if (!Array.isArray(item) || item.length <= 0 || item.length > 2 || typeof item[0] !== 'string')\n          throw errorWithFile(file, `config.reporter[${index}] must be a tuple [name, optionalArgument]`);\n      });\n    } else if (typeof config.reporter !== 'string') {\n      throw errorWithFile(file, `config.reporter must be a string`);\n    }\n  }\n\n  if ('reportSlowTests' in config && config.reportSlowTests !== undefined && config.reportSlowTests !== null) {\n    if (!config.reportSlowTests || typeof config.reportSlowTests !== 'object')\n      throw errorWithFile(file, `config.reportSlowTests must be an object`);\n    if (!('max' in config.reportSlowTests) || typeof config.reportSlowTests.max !== 'number' || config.reportSlowTests.max < 0)\n      throw errorWithFile(file, `config.reportSlowTests.max must be a non-negative number`);\n    if (!('threshold' in config.reportSlowTests) || typeof config.reportSlowTests.threshold !== 'number' || config.reportSlowTests.threshold < 0)\n      throw errorWithFile(file, `config.reportSlowTests.threshold must be a non-negative number`);\n  }\n\n  if ('shard' in config && config.shard !== undefined && config.shard !== null) {\n    if (!config.shard || typeof config.shard !== 'object')\n      throw errorWithFile(file, `config.shard must be an object`);\n    if (!('total' in config.shard) || typeof config.shard.total !== 'number' || config.shard.total < 1)\n      throw errorWithFile(file, `config.shard.total must be a positive number`);\n    if (!('current' in config.shard) || typeof config.shard.current !== 'number' || config.shard.current < 1 || config.shard.current > config.shard.total)\n      throw errorWithFile(file, `config.shard.current must be a positive number, not greater than config.shard.total`);\n  }\n\n  if ('updateSnapshots' in config && config.updateSnapshots !== undefined) {\n    if (typeof config.updateSnapshots !== 'string' || !['all', 'none', 'missing'].includes(config.updateSnapshots))\n      throw errorWithFile(file, `config.updateSnapshots must be one of \"all\", \"none\" or \"missing\"`);\n  }\n\n  if ('workers' in config && config.workers !== undefined) {\n    if (typeof config.workers !== 'number' || config.workers <= 0)\n      throw errorWithFile(file, `config.workers must be a positive number`);\n  }\n}\n\nfunction validateProject(file: string, project: Project, title: string) {\n  if (typeof project !== 'object' || !project)\n    throw errorWithFile(file, `${title} must be an object`);\n\n  if ('define' in project && project.define !== undefined) {\n    if (Array.isArray(project.define)) {\n      project.define.forEach((item, index) => {\n        validateDefine(file, item, `${title}.define[${index}]`);\n      });\n    } else {\n      validateDefine(file, project.define, `${title}.define`);\n    }\n  }\n\n  if ('name' in project && project.name !== undefined) {\n    if (typeof project.name !== 'string')\n      throw errorWithFile(file, `${title}.name must be a string`);\n  }\n\n  if ('outputDir' in project && project.outputDir !== undefined) {\n    if (typeof project.outputDir !== 'string')\n      throw errorWithFile(file, `${title}.outputDir must be a string`);\n  }\n\n  if ('repeatEach' in project && project.repeatEach !== undefined) {\n    if (typeof project.repeatEach !== 'number' || project.repeatEach < 0)\n      throw errorWithFile(file, `${title}.repeatEach must be a non-negative number`);\n  }\n\n  if ('retries' in project && project.retries !== undefined) {\n    if (typeof project.retries !== 'number' || project.retries < 0)\n      throw errorWithFile(file, `${title}.retries must be a non-negative number`);\n  }\n\n  if ('testDir' in project && project.testDir !== undefined) {\n    if (typeof project.testDir !== 'string')\n      throw errorWithFile(file, `${title}.testDir must be a string`);\n  }\n\n  for (const prop of ['testIgnore', 'testMatch'] as const) {\n    if (prop in project && project[prop] !== undefined) {\n      const value = project[prop];\n      if (Array.isArray(value)) {\n        value.forEach((item, index) => {\n          if (typeof item !== 'string' && !isRegExp(item))\n            throw errorWithFile(file, `${title}.${prop}[${index}] must be a string or a RegExp`);\n        });\n      } else if (typeof value !== 'string' && !isRegExp(value)) {\n        throw errorWithFile(file, `${title}.${prop} must be a string or a RegExp`);\n      }\n    }\n  }\n\n  if ('timeout' in project && project.timeout !== undefined) {\n    if (typeof project.timeout !== 'number' || project.timeout < 0)\n      throw errorWithFile(file, `${title}.timeout must be a non-negative number`);\n  }\n\n  if ('use' in project && project.use !== undefined) {\n    if (!project.use || typeof project.use !== 'object')\n      throw errorWithFile(file, `${title}.use must be an object`);\n  }\n}\n\nfunction validateDefine(file: string, define: any, title: string) {\n  if (!define || typeof define !== 'object' || !define.test || !define.fixtures)\n    throw errorWithFile(file, `${title} must be an object with \"test\" and \"fixtures\" properties`);\n}\n\nconst baseFullConfig: FullConfig = {\n  forbidOnly: false,\n  globalSetup: null,\n  globalTeardown: null,\n  globalTimeout: 0,\n  grep: /.*/,\n  grepInvert: null,\n  maxFailures: 0,\n  preserveOutput: 'always',\n  projects: [],\n  reporter: [ ['list'] ],\n  reportSlowTests: null,\n  rootDir: path.resolve(process.cwd()),\n  quiet: false,\n  shard: null,\n  updateSnapshots: 'missing',\n  workers: 1,\n  webServer: null,\n};\n\nfunction resolveReporters(reporters: Config['reporter'], rootDir: string): ReporterDescription[]|undefined {\n  return toReporters(reporters as any)?.map(([id, arg]) => {\n    if (builtInReporters.includes(id as any))\n      return [id, arg];\n    return [require.resolve(id, { paths: [ rootDir ] }), arg];\n  });\n}\n\nfunction resolveScript(id: string, rootDir: string) {\n  const localPath = path.resolve(rootDir, id);\n  if (fs.existsSync(localPath))\n    return localPath;\n  return require.resolve(id, { paths: [rootDir] });\n}\n"],"file":"loader.js"}