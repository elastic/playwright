{"version":3,"sources":["../../../../src/server/supplements/recorder/java.ts"],"names":["JavaLanguageGenerator","id","fileName","highlighter","generateAction","actionInContext","action","pageAlias","formatter","JavaScriptFormatter","newLine","add","name","url","format","subject","isMainFrame","frameName","quote","frameUrl","signals","dialog","actionCall","_generateActionCall","code","popup","popupAlias","download","waitForNavigation","assertNavigation","isPage","Error","method","clickCount","modifiers","options","button","length","optionsText","formatClickOptions","selector","text","formatPath","files","shortcut","key","join","formatSelectOption","generateHeader","browserName","formatLaunchOptions","launchOptions","formatContextOptions","contextOptions","deviceName","generateFooter","saveStorage","storageStateLine","Array","isArray","map","s","lines","Object","keys","push","headless","channel","device","deviceDescriptors","acceptDownloads","bypassCSP","colorScheme","toUpperCase","deviceScaleFactor","geolocation","latitude","longitude","hasTouch","isMobile","locale","proxy","server","storageState","timezoneId","userAgent","viewport","width","height","m","unshift","char","replace"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { BrowserContextOptions } from '../../../..';\nimport { LanguageGenerator, LanguageGeneratorOptions, toSignalMap } from './language';\nimport { ActionInContext } from './codeGenerator';\nimport { Action, actionTitle } from './recorderActions';\nimport { MouseClickOptions, toModifiers } from './utils';\nimport deviceDescriptors from '../../deviceDescriptors';\nimport { JavaScriptFormatter } from './javascript';\n\nexport class JavaLanguageGenerator implements LanguageGenerator {\n  id = 'java';\n  fileName = 'Java';\n  highlighter = 'java';\n\n  generateAction(actionInContext: ActionInContext): string {\n    const { action, pageAlias } = actionInContext;\n    const formatter = new JavaScriptFormatter(6);\n    formatter.newLine();\n    formatter.add('// ' + actionTitle(action));\n\n    if (action.name === 'openPage') {\n      formatter.add(`Page ${pageAlias} = context.newPage();`);\n      if (action.url && action.url !== 'about:blank' && action.url !== 'chrome://newtab/')\n        formatter.add(`${pageAlias}.navigate(\"${action.url}\");`);\n      return formatter.format();\n    }\n\n    const subject = actionInContext.isMainFrame ? pageAlias :\n      (actionInContext.frameName ?\n        `${pageAlias}.frame(${quote(actionInContext.frameName)})` :\n        `${pageAlias}.frameByUrl(${quote(actionInContext.frameUrl)})`);\n\n    const signals = toSignalMap(action);\n\n    if (signals.dialog) {\n      formatter.add(`  ${pageAlias}.onceDialog(dialog -> {\n        System.out.println(String.format(\"Dialog message: %s\", dialog.message()));\n        dialog.dismiss();\n      });`);\n    }\n\n    const actionCall = this._generateActionCall(action, actionInContext.isMainFrame);\n    let code = `${subject}.${actionCall};`;\n\n    if (signals.popup) {\n      code = `Page ${signals.popup.popupAlias} = ${pageAlias}.waitForPopup(() -> {\n        ${code}\n      });`;\n    }\n\n    if (signals.download) {\n      code = `Download download = ${pageAlias}.waitForDownload(() -> {\n        ${code}\n      });`;\n    }\n\n    if (signals.waitForNavigation) {\n      code = `\n      // ${pageAlias}.waitForNavigation(new Page.WaitForNavigationOptions().setUrl(${quote(signals.waitForNavigation.url)}), () ->\n      ${pageAlias}.waitForNavigation(() -> {\n        ${code}\n      });`;\n    }\n\n    formatter.add(code);\n\n    if (signals.assertNavigation)\n      formatter.add(`// assert ${pageAlias}.url().equals(${quote(signals.assertNavigation.url)});`);\n    return formatter.format();\n  }\n\n  private _generateActionCall(action: Action, isPage: boolean): string {\n    switch (action.name) {\n      case 'openPage':\n        throw Error('Not reached');\n      case 'closePage':\n        return 'close()';\n      case 'click': {\n        let method = 'click';\n        if (action.clickCount === 2)\n          method = 'dblclick';\n        const modifiers = toModifiers(action.modifiers);\n        const options: MouseClickOptions = {};\n        if (action.button !== 'left')\n          options.button = action.button;\n        if (modifiers.length)\n          options.modifiers = modifiers;\n        if (action.clickCount > 2)\n          options.clickCount = action.clickCount;\n        const optionsText = formatClickOptions(options, isPage);\n        return `${method}(${quote(action.selector)}${optionsText ? ', ' : ''}${optionsText})`;\n      }\n      case 'check':\n        return `check(${quote(action.selector)})`;\n      case 'uncheck':\n        return `uncheck(${quote(action.selector)})`;\n      case 'fill':\n        return `fill(${quote(action.selector)}, ${quote(action.text)})`;\n      case 'setInputFiles':\n        return `setInputFiles(${quote(action.selector)}, ${formatPath(action.files.length === 1 ? action.files[0] : action.files)})`;\n      case 'press': {\n        const modifiers = toModifiers(action.modifiers);\n        const shortcut = [...modifiers, action.key].join('+');\n        return `press(${quote(action.selector)}, ${quote(shortcut)})`;\n      }\n      case 'navigate':\n        return `navigate(${quote(action.url)})`;\n      case 'select':\n        return `selectOption(${quote(action.selector)}, ${formatSelectOption(action.options.length > 1 ? action.options : action.options[0])})`;\n    }\n  }\n\n  generateHeader(options: LanguageGeneratorOptions): string {\n    const formatter = new JavaScriptFormatter();\n    formatter.add(`\n    import com.microsoft.playwright.*;\n    import com.microsoft.playwright.options.*;\n    import java.util.*;\n\n    public class Example {\n      public static void main(String[] args) {\n        try (Playwright playwright = Playwright.create()) {\n          Browser browser = playwright.${options.browserName}().launch(${formatLaunchOptions(options.launchOptions)});\n          BrowserContext context = browser.newContext(${formatContextOptions(options.contextOptions, options.deviceName)});`);\n    return formatter.format();\n  }\n\n  generateFooter(saveStorage: string | undefined): string {\n    const storageStateLine = saveStorage ? `\\n      context.storageState(new BrowserContext.StorageStateOptions().setPath(${quote(saveStorage)}));\\n` : '';\n    return `${storageStateLine}    }\n  }\n}`;\n  }\n}\n\nfunction formatPath(files: string | string[]): string {\n  if (Array.isArray(files)) {\n    if (files.length === 0)\n      return 'new Path[0]';\n    return `new Path[] {${files.map(s => 'Paths.get(' + quote(s) + ')').join(', ')}}`;\n  }\n  return `Paths.get(${quote(files)})`;\n}\n\nfunction formatSelectOption(options: string | string[]): string {\n  if (Array.isArray(options)) {\n    if (options.length === 0)\n      return 'new String[0]';\n    return `new String[] {${options.map(s => quote(s)).join(', ')}}`;\n  }\n  return quote(options);\n}\n\nfunction formatLaunchOptions(options: any): string {\n  const lines = [];\n  if (!Object.keys(options).length)\n    return '';\n  lines.push('new BrowserType.LaunchOptions()');\n  if (typeof options.headless === 'boolean')\n    lines.push(`  .setHeadless(false)`);\n  if (options.channel)\n    lines.push(`  .setChannel(\"${options.channel}\")`);\n  return lines.join('\\n');\n}\n\nfunction formatContextOptions(contextOptions: BrowserContextOptions, deviceName: string | undefined): string {\n  const lines = [];\n  if (!Object.keys(contextOptions).length && !deviceName)\n    return '';\n  const device = deviceName ? deviceDescriptors[deviceName] : {};\n  const options: BrowserContextOptions = { ...device, ...contextOptions };\n  lines.push('new Browser.NewContextOptions()');\n  if (options.acceptDownloads)\n    lines.push(`  .setAcceptDownloads(true)`);\n  if (options.bypassCSP)\n    lines.push(`  .setBypassCSP(true)`);\n  if (options.colorScheme)\n    lines.push(`  .setColorScheme(ColorScheme.${options.colorScheme.toUpperCase()})`);\n  if (options.deviceScaleFactor)\n    lines.push(`  .setDeviceScaleFactor(${options.deviceScaleFactor})`);\n  if (options.geolocation)\n    lines.push(`  .setGeolocation(${options.geolocation.latitude}, ${options.geolocation.longitude})`);\n  if (options.hasTouch)\n    lines.push(`  .setHasTouch(${options.hasTouch})`);\n  if (options.isMobile)\n    lines.push(`  .setIsMobile(${options.isMobile})`);\n  if (options.locale)\n    lines.push(`  .setLocale(\"${options.locale}\")`);\n  if (options.proxy)\n    lines.push(`  .setProxy(new Proxy(\"${options.proxy.server}\"))`);\n  if (options.storageState)\n    lines.push(`  .setStorageStatePath(Paths.get(${quote(options.storageState as string)}))`);\n  if (options.timezoneId)\n    lines.push(`  .setTimezoneId(\"${options.timezoneId}\")`);\n  if (options.userAgent)\n    lines.push(`  .setUserAgent(\"${options.userAgent}\")`);\n  if (options.viewport)\n    lines.push(`  .setViewportSize(${options.viewport.width}, ${options.viewport.height})`);\n  return lines.join('\\n');\n}\n\nfunction formatClickOptions(options: MouseClickOptions, isPage: boolean) {\n  const lines = [];\n  if (options.button)\n    lines.push(`  .setButton(MouseButton.${options.button.toUpperCase()})`);\n  if (options.modifiers)\n    lines.push(`  .setModifiers(Arrays.asList(${options.modifiers.map(m => `KeyboardModifier.${m.toUpperCase()}`).join(', ')}))`);\n  if (options.clickCount)\n    lines.push(`  .setClickCount(${options.clickCount})`);\n  if (!lines.length)\n    return '';\n  lines.unshift(`new ${isPage ? 'Page' : 'Frame'}.ClickOptions()`);\n  return lines.join('\\n');\n}\n\nfunction quote(text: string, char: string = '\\\"') {\n  if (char === '\\'')\n    return char + text.replace(/[']/g, '\\\\\\'') + char;\n  if (char === '\"')\n    return char + text.replace(/[\"]/g, '\\\\\"') + char;\n  if (char === '`')\n    return char + text.replace(/[`]/g, '\\\\`') + char;\n  throw new Error('Invalid escape char');\n}\n"],"file":"java.js"}