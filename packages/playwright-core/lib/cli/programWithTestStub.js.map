{"version":3,"file":"programWithTestStub.js","names":["_utils","require","_program","printPlaywrightTestError","command","packages","pkg","resolve","push","e","length","packageManager","getPackageManager","console","error","join","kExternalPlaywrightTestCommands","addExternalPlaywrightTestCommands","description","playwrightTest","program","allowUnknownOption","action","gracefullyProcessExitDoNotHang","process","env","PW_LANG_NAME"],"sources":["../../src/cli/programWithTestStub.ts"],"sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable no-console */\n\nimport { getPackageManager, gracefullyProcessExitDoNotHang } from '../utils';\nimport { program } from './program';\nexport { program } from './program';\n\nfunction printPlaywrightTestError(command: string) {\n  const packages: string[] = [];\n  for (const pkg of ['playwright', 'playwright-chromium', 'playwright-firefox', 'playwright-webkit']) {\n    try {\n      require.resolve(pkg);\n      packages.push(pkg);\n    } catch (e) {\n    }\n  }\n  if (!packages.length)\n    packages.push('playwright');\n  const packageManager = getPackageManager();\n  if (packageManager === 'yarn') {\n    console.error(`Please install @playwright/test package before running \"yarn playwright ${command}\"`);\n    console.error(`  yarn remove ${packages.join(' ')}`);\n    console.error('  yarn add -D @playwright/test');\n  } else if (packageManager === 'pnpm') {\n    console.error(`Please install @playwright/test package before running \"pnpm exec playwright ${command}\"`);\n    console.error(`  pnpm remove ${packages.join(' ')}`);\n    console.error('  pnpm add -D @playwright/test');\n  } else {\n    console.error(`Please install @playwright/test package before running \"npx playwright ${command}\"`);\n    console.error(`  npm uninstall ${packages.join(' ')}`);\n    console.error('  npm install -D @playwright/test');\n  }\n}\n\nconst kExternalPlaywrightTestCommands = [\n  ['test', 'Run tests with Playwright Test.'],\n  ['show-report', 'Show Playwright Test HTML report.'],\n  ['merge-reports', 'Merge Playwright Test Blob reports'],\n];\nfunction addExternalPlaywrightTestCommands() {\n  for (const [command, description] of kExternalPlaywrightTestCommands) {\n    const playwrightTest = program.command(command).allowUnknownOption(true);\n    playwrightTest.description(`${description} Available in @playwright/test package.`);\n    playwrightTest.action(async () => {\n      printPlaywrightTestError(command);\n      gracefullyProcessExitDoNotHang(1);\n    });\n  }\n}\n\nif (!process.env.PW_LANG_NAME)\n  addExternalPlaywrightTestCommands();\n"],"mappings":";;;;;;;;;;;AAkBA,IAAAA,MAAA,GAAAC,OAAA;AACA,IAAAC,QAAA,GAAAD,OAAA;AAnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAMA,SAASE,wBAAwBA,CAACC,OAAe,EAAE;EACjD,MAAMC,QAAkB,GAAG,EAAE;EAC7B,KAAK,MAAMC,GAAG,IAAI,CAAC,YAAY,EAAE,qBAAqB,EAAE,oBAAoB,EAAE,mBAAmB,CAAC,EAAE;IAClG,IAAI;MACFL,OAAO,CAACM,OAAO,CAACD,GAAG,CAAC;MACpBD,QAAQ,CAACG,IAAI,CAACF,GAAG,CAAC;IACpB,CAAC,CAAC,OAAOG,CAAC,EAAE,CACZ;EACF;EACA,IAAI,CAACJ,QAAQ,CAACK,MAAM,EAClBL,QAAQ,CAACG,IAAI,CAAC,YAAY,CAAC;EAC7B,MAAMG,cAAc,GAAG,IAAAC,wBAAiB,EAAC,CAAC;EAC1C,IAAID,cAAc,KAAK,MAAM,EAAE;IAC7BE,OAAO,CAACC,KAAK,CAAE,2EAA0EV,OAAQ,GAAE,CAAC;IACpGS,OAAO,CAACC,KAAK,CAAE,iBAAgBT,QAAQ,CAACU,IAAI,CAAC,GAAG,CAAE,EAAC,CAAC;IACpDF,OAAO,CAACC,KAAK,CAAC,gCAAgC,CAAC;EACjD,CAAC,MAAM,IAAIH,cAAc,KAAK,MAAM,EAAE;IACpCE,OAAO,CAACC,KAAK,CAAE,gFAA+EV,OAAQ,GAAE,CAAC;IACzGS,OAAO,CAACC,KAAK,CAAE,iBAAgBT,QAAQ,CAACU,IAAI,CAAC,GAAG,CAAE,EAAC,CAAC;IACpDF,OAAO,CAACC,KAAK,CAAC,gCAAgC,CAAC;EACjD,CAAC,MAAM;IACLD,OAAO,CAACC,KAAK,CAAE,0EAAyEV,OAAQ,GAAE,CAAC;IACnGS,OAAO,CAACC,KAAK,CAAE,mBAAkBT,QAAQ,CAACU,IAAI,CAAC,GAAG,CAAE,EAAC,CAAC;IACtDF,OAAO,CAACC,KAAK,CAAC,mCAAmC,CAAC;EACpD;AACF;AAEA,MAAME,+BAA+B,GAAG,CACtC,CAAC,MAAM,EAAE,iCAAiC,CAAC,EAC3C,CAAC,aAAa,EAAE,mCAAmC,CAAC,EACpD,CAAC,eAAe,EAAE,oCAAoC,CAAC,CACxD;AACD,SAASC,iCAAiCA,CAAA,EAAG;EAC3C,KAAK,MAAM,CAACb,OAAO,EAAEc,WAAW,CAAC,IAAIF,+BAA+B,EAAE;IACpE,MAAMG,cAAc,GAAGC,gBAAO,CAAChB,OAAO,CAACA,OAAO,CAAC,CAACiB,kBAAkB,CAAC,IAAI,CAAC;IACxEF,cAAc,CAACD,WAAW,CAAE,GAAEA,WAAY,yCAAwC,CAAC;IACnFC,cAAc,CAACG,MAAM,CAAC,YAAY;MAChCnB,wBAAwB,CAACC,OAAO,CAAC;MACjC,IAAAmB,qCAA8B,EAAC,CAAC,CAAC;IACnC,CAAC,CAAC;EACJ;AACF;AAEA,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,YAAY,EAC3BT,iCAAiC,CAAC,CAAC"}