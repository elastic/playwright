{"version":3,"file":"browserContextDispatcher.js","names":["_browserContext","require","_dispatcher","_pageDispatcher","_networkDispatchers","_crBrowser","_cdpSessionDispatcher","_recorder","_artifactDispatcher","_tracingDispatcher","fs","_interopRequireWildcard","path","_utils","_writableStreamDispatcher","_dialogDispatcher","_errors","_elementHandlerDispatcher","_recorderApp","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","BrowserContextDispatcher","Dispatcher","constructor","parentScope","context","requestContext","APIRequestContextDispatcher","from","fetchRequest","tracing","TracingDispatcher","isChromium","_browser","options","isLocalBrowserOnServer","_isCollocatedWithServer","_type_EventTarget","_type_BrowserContext","_context","_subscriptions","Set","adopt","onVideo","artifact","artifactDispatcher","ArtifactDispatcher","_dispatchEvent","addObjectListener","BrowserContext","Events","VideoStarted","video","_idToVideo","values","page","pages","PageDispatcher","Page","Close","_dispose","PageError","error","serializeError","Console","message","_shouldDispatchEvent","pageDispatcher","type","text","args","map","ElementHandleDispatcher","fromJSHandle","location","Dialog","dialog","DialogDispatcher","close","catch","name","backgroundPages","CRBrowserContext","CREvents","BackgroundPage","serviceWorker","serviceWorkers","worker","WorkerDispatcher","ServiceWorker","Request","request","_request$frame","redirectFromDispatcher","redirectedFrom","existingDispatcher","_shouldDispatchNetworkEvent","isNavigationRequest","requestDispatcher","RequestDispatcher","fromNullable","frame","_page","initializedOrUndefined","Response","response","_response$frame","ResponseDispatcher","RequestFailed","_request$frame2","failureText","_failureText","undefined","responseEndTiming","_responseEndTiming","RequestFinished","_request$frame3","event","_request$frame4","createTempFiles","params","dir","artifactsDir","tmpDir","join","createGuid","tempDirWithRootName","rootDirName","basename","promises","mkdir","recursive","_tempDirs","push","rootDir","WritableStreamDispatcher","writableStreams","Promise","all","items","item","dirname","file","createWriteStream","lastModifiedMs","setDefaultNavigationTimeoutNoReply","setDefaultNavigationTimeout","timeout","setDefaultTimeoutNoReply","setDefaultTimeout","exposeBinding","needsHandle","source","_disposed","binding","BindingCallDispatcher","promise","newPage","metadata","cookies","urls","addCookies","clearCookies","nameRe","nameRegexSource","nameRegexFlags","RegExp","domainRe","domainRegexSource","domainRegexFlags","pathRe","pathRegexSource","pathRegexFlags","domain","grantPermissions","permissions","origin","clearPermissions","setGeolocation","geolocation","setExtraHTTPHeaders","headers","setOffline","offline","setHTTPCredentials","httpCredentials","addInitScript","setNetworkInterceptionPatterns","patterns","length","setRequestInterceptor","urlMatchers","pattern","regexSource","regexFlags","glob","route","matchesSome","some","urlMatch","urlMatches","_options","baseURL","url","RouteDispatcher","storageState","potentiallyClosesScope","recorderSupplementEnable","Recorder","show","RecorderApp","factory","pause","newCDPSession","_object","Error","crBrowserContext","session","CDPSessionDispatcher","harStart","harId","_harStart","harExport","_harExport","clockFastForward","_ref","_params$ticksString","clock","fastForward","ticksString","ticksNumber","clockInstall","_ref2","_params$timeString","install","timeString","timeNumber","clockPauseAt","_ref3","_params$timeString2","pauseAt","clockResume","resume","clockRunFor","_ref4","_params$ticksString2","runFor","clockSetFixedTime","_ref5","_params$timeString3","setFixedTime","clockSetSystemTime","_ref6","_params$timeString4","setSystemTime","updateSubscription","enabled","add","delete","_onDispose","isClosingOrClosed","exports"],"sources":["../../../src/server/dispatchers/browserContextDispatcher.ts"],"sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the 'License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BrowserContext } from '../browserContext';\nimport { Dispatcher, existingDispatcher } from './dispatcher';\nimport type { DispatcherScope } from './dispatcher';\nimport { PageDispatcher, BindingCallDispatcher, WorkerDispatcher } from './pageDispatcher';\nimport type { FrameDispatcher } from './frameDispatcher';\nimport type * as channels from '@protocol/channels';\nimport { RouteDispatcher, RequestDispatcher, ResponseDispatcher, APIRequestContextDispatcher } from './networkDispatchers';\nimport { CRBrowserContext } from '../chromium/crBrowser';\nimport { CDPSessionDispatcher } from './cdpSessionDispatcher';\nimport { Recorder } from '../recorder';\nimport type { CallMetadata } from '../instrumentation';\nimport { ArtifactDispatcher } from './artifactDispatcher';\nimport type { Artifact } from '../artifact';\nimport type { Request, Response } from '../network';\nimport { TracingDispatcher } from './tracingDispatcher';\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { createGuid, urlMatches } from '../../utils';\nimport { WritableStreamDispatcher } from './writableStreamDispatcher';\nimport { DialogDispatcher } from './dialogDispatcher';\nimport type { Page } from '../page';\nimport type { Dialog } from '../dialog';\nimport type { ConsoleMessage } from '../console';\nimport { serializeError } from '../errors';\nimport { ElementHandleDispatcher } from './elementHandlerDispatcher';\nimport { RecorderApp } from '../recorder/recorderApp';\n\nexport class BrowserContextDispatcher extends Dispatcher<BrowserContext, channels.BrowserContextChannel, DispatcherScope> implements channels.BrowserContextChannel {\n  _type_EventTarget = true;\n  _type_BrowserContext = true;\n  private _context: BrowserContext;\n  private _subscriptions = new Set<channels.BrowserContextUpdateSubscriptionParams['event']>();\n\n  constructor(parentScope: DispatcherScope, context: BrowserContext) {\n    // We will reparent these to the context below.\n    const requestContext = APIRequestContextDispatcher.from(parentScope as BrowserContextDispatcher, context.fetchRequest);\n    const tracing = TracingDispatcher.from(parentScope as BrowserContextDispatcher, context.tracing);\n\n    super(parentScope, context, 'BrowserContext', {\n      isChromium: context._browser.options.isChromium,\n      isLocalBrowserOnServer: context._browser._isCollocatedWithServer,\n      requestContext,\n      tracing,\n    });\n\n    this.adopt(requestContext);\n    this.adopt(tracing);\n\n    this._context = context;\n    // Note: when launching persistent context, dispatcher is created very late,\n    // so we can already have pages, videos and everything else.\n\n    const onVideo = (artifact: Artifact) => {\n      // Note: Video must outlive Page and BrowserContext, so that client can saveAs it\n      // after closing the context. We use |scope| for it.\n      const artifactDispatcher = ArtifactDispatcher.from(parentScope, artifact);\n      this._dispatchEvent('video', { artifact: artifactDispatcher });\n    };\n    this.addObjectListener(BrowserContext.Events.VideoStarted, onVideo);\n    for (const video of context._browser._idToVideo.values()) {\n      if (video.context === context)\n        onVideo(video.artifact);\n    }\n\n    for (const page of context.pages())\n      this._dispatchEvent('page', { page: PageDispatcher.from(this, page) });\n    this.addObjectListener(BrowserContext.Events.Page, page => {\n      this._dispatchEvent('page', { page: PageDispatcher.from(this, page) });\n    });\n    this.addObjectListener(BrowserContext.Events.Close, () => {\n      this._dispatchEvent('close');\n      this._dispose();\n    });\n    this.addObjectListener(BrowserContext.Events.PageError, (error: Error, page: Page) => {\n      this._dispatchEvent('pageError', { error: serializeError(error), page: PageDispatcher.from(this, page) });\n    });\n    this.addObjectListener(BrowserContext.Events.Console, (message: ConsoleMessage) => {\n      const page = message.page()!;\n      if (this._shouldDispatchEvent(page, 'console')) {\n        const pageDispatcher = PageDispatcher.from(this, page);\n        this._dispatchEvent('console', {\n          page: pageDispatcher,\n          type: message.type(),\n          text: message.text(),\n          args: message.args().map(a => ElementHandleDispatcher.fromJSHandle(pageDispatcher, a)),\n          location: message.location(),\n        });\n      }\n    });\n    this.addObjectListener(BrowserContext.Events.Dialog, (dialog: Dialog) => {\n      if (this._shouldDispatchEvent(dialog.page(), 'dialog'))\n        this._dispatchEvent('dialog', { dialog: new DialogDispatcher(this, dialog) });\n      else\n        dialog.close().catch(() => {});\n    });\n\n    if (context._browser.options.name === 'chromium') {\n      for (const page of (context as CRBrowserContext).backgroundPages())\n        this._dispatchEvent('backgroundPage', { page: PageDispatcher.from(this, page) });\n      this.addObjectListener(CRBrowserContext.CREvents.BackgroundPage, page => this._dispatchEvent('backgroundPage', { page: PageDispatcher.from(this, page) }));\n      for (const serviceWorker of (context as CRBrowserContext).serviceWorkers())\n        this._dispatchEvent('serviceWorker', { worker: new WorkerDispatcher(this, serviceWorker) });\n      this.addObjectListener(CRBrowserContext.CREvents.ServiceWorker, serviceWorker => this._dispatchEvent('serviceWorker', { worker: new WorkerDispatcher(this, serviceWorker) }));\n    }\n    this.addObjectListener(BrowserContext.Events.Request, (request: Request) =>  {\n      // Create dispatcher, if:\n      // - There are listeners to the requests.\n      // - We are redirected from a reported request so that redirectedTo was updated on client.\n      // - We are a navigation request and dispatcher will be reported as a part of the goto return value and newDocument param anyways.\n      //   By the time requestFinished is triggered to update the request, we should have a request on the client already.\n      const redirectFromDispatcher = request.redirectedFrom() && existingDispatcher(request.redirectedFrom());\n      if (!redirectFromDispatcher && !this._shouldDispatchNetworkEvent(request, 'request') && !request.isNavigationRequest())\n        return;\n      const requestDispatcher = RequestDispatcher.from(this, request);\n      this._dispatchEvent('request', {\n        request: requestDispatcher,\n        page: PageDispatcher.fromNullable(this, request.frame()?._page.initializedOrUndefined())\n      });\n    });\n    this.addObjectListener(BrowserContext.Events.Response, (response: Response) => {\n      const requestDispatcher = existingDispatcher<RequestDispatcher>(response.request());\n      if (!requestDispatcher && !this._shouldDispatchNetworkEvent(response.request(), 'response'))\n        return;\n      this._dispatchEvent('response', {\n        response: ResponseDispatcher.from(this, response),\n        page: PageDispatcher.fromNullable(this, response.frame()?._page.initializedOrUndefined())\n      });\n    });\n    this.addObjectListener(BrowserContext.Events.RequestFailed, (request: Request) => {\n      const requestDispatcher = existingDispatcher<RequestDispatcher>(request);\n      if (!requestDispatcher && !this._shouldDispatchNetworkEvent(request, 'requestFailed'))\n        return;\n      this._dispatchEvent('requestFailed', {\n        request: RequestDispatcher.from(this, request),\n        failureText: request._failureText || undefined,\n        responseEndTiming: request._responseEndTiming,\n        page: PageDispatcher.fromNullable(this, request.frame()?._page.initializedOrUndefined())\n      });\n    });\n    this.addObjectListener(BrowserContext.Events.RequestFinished, ({ request, response }: { request: Request, response: Response | null }) => {\n      const requestDispatcher = existingDispatcher<RequestDispatcher>(request);\n      if (!requestDispatcher && !this._shouldDispatchNetworkEvent(request, 'requestFinished'))\n        return;\n      this._dispatchEvent('requestFinished', {\n        request: RequestDispatcher.from(this, request),\n        response: ResponseDispatcher.fromNullable(this, response),\n        responseEndTiming: request._responseEndTiming,\n        page: PageDispatcher.fromNullable(this, request.frame()?._page.initializedOrUndefined()),\n      });\n    });\n  }\n\n  private _shouldDispatchNetworkEvent(request: Request, event: channels.BrowserContextUpdateSubscriptionParams['event'] & channels.PageUpdateSubscriptionParams['event']): boolean {\n    return this._shouldDispatchEvent(request.frame()?._page?.initializedOrUndefined(), event);\n  }\n\n  private _shouldDispatchEvent(page: Page | undefined, event: channels.BrowserContextUpdateSubscriptionParams['event'] & channels.PageUpdateSubscriptionParams['event']): boolean {\n    if (this._subscriptions.has(event))\n      return true;\n    const pageDispatcher = page ? existingDispatcher<PageDispatcher>(page) : undefined;\n    if (pageDispatcher?._subscriptions.has(event))\n      return true;\n    return false;\n  }\n\n  async createTempFiles(params: channels.BrowserContextCreateTempFilesParams): Promise<channels.BrowserContextCreateTempFilesResult> {\n    const dir = this._context._browser.options.artifactsDir;\n    const tmpDir = path.join(dir, 'upload-' + createGuid());\n    const tempDirWithRootName = params.rootDirName ? path.join(tmpDir, path.basename(params.rootDirName)) : tmpDir;\n    await fs.promises.mkdir(tempDirWithRootName, { recursive: true });\n    this._context._tempDirs.push(tmpDir);\n    return {\n      rootDir: params.rootDirName ? new WritableStreamDispatcher(this, tempDirWithRootName) : undefined,\n      writableStreams: await Promise.all(params.items.map(async item => {\n        await fs.promises.mkdir(path.dirname(path.join(tempDirWithRootName, item.name)), { recursive: true });\n        const file = fs.createWriteStream(path.join(tempDirWithRootName, item.name));\n        return new WritableStreamDispatcher(this, file, item.lastModifiedMs);\n      }))\n    };\n  }\n\n  async setDefaultNavigationTimeoutNoReply(params: channels.BrowserContextSetDefaultNavigationTimeoutNoReplyParams) {\n    this._context.setDefaultNavigationTimeout(params.timeout);\n  }\n\n  async setDefaultTimeoutNoReply(params: channels.BrowserContextSetDefaultTimeoutNoReplyParams) {\n    this._context.setDefaultTimeout(params.timeout);\n  }\n\n  async exposeBinding(params: channels.BrowserContextExposeBindingParams): Promise<void> {\n    await this._context.exposeBinding(params.name, !!params.needsHandle, (source, ...args) => {\n      // When reusing the context, we might have some bindings called late enough,\n      // after context and page dispatchers have been disposed.\n      if (this._disposed)\n        return;\n      const pageDispatcher = PageDispatcher.from(this, source.page);\n      const binding = new BindingCallDispatcher(pageDispatcher, params.name, !!params.needsHandle, source, args);\n      this._dispatchEvent('bindingCall', { binding });\n      return binding.promise();\n    });\n  }\n\n  async newPage(params: channels.BrowserContextNewPageParams, metadata: CallMetadata): Promise<channels.BrowserContextNewPageResult> {\n    return { page: PageDispatcher.from(this, await this._context.newPage(metadata)) };\n  }\n\n  async cookies(params: channels.BrowserContextCookiesParams): Promise<channels.BrowserContextCookiesResult> {\n    return { cookies: await this._context.cookies(params.urls) };\n  }\n\n  async addCookies(params: channels.BrowserContextAddCookiesParams): Promise<void> {\n    await this._context.addCookies(params.cookies);\n  }\n\n  async clearCookies(params: channels.BrowserContextClearCookiesParams): Promise<void> {\n    const nameRe = params.nameRegexSource !== undefined && params.nameRegexFlags !== undefined ? new RegExp(params.nameRegexSource, params.nameRegexFlags) : undefined;\n    const domainRe = params.domainRegexSource !== undefined && params.domainRegexFlags !== undefined ? new RegExp(params.domainRegexSource, params.domainRegexFlags) : undefined;\n    const pathRe = params.pathRegexSource !== undefined && params.pathRegexFlags !== undefined ? new RegExp(params.pathRegexSource, params.pathRegexFlags) : undefined;\n    await this._context.clearCookies({\n      name: nameRe || params.name,\n      domain: domainRe || params.domain,\n      path: pathRe || params.path,\n    });\n  }\n\n  async grantPermissions(params: channels.BrowserContextGrantPermissionsParams): Promise<void> {\n    await this._context.grantPermissions(params.permissions, params.origin);\n  }\n\n  async clearPermissions(): Promise<void> {\n    await this._context.clearPermissions();\n  }\n\n  async setGeolocation(params: channels.BrowserContextSetGeolocationParams): Promise<void> {\n    await this._context.setGeolocation(params.geolocation);\n  }\n\n  async setExtraHTTPHeaders(params: channels.BrowserContextSetExtraHTTPHeadersParams): Promise<void> {\n    await this._context.setExtraHTTPHeaders(params.headers);\n  }\n\n  async setOffline(params: channels.BrowserContextSetOfflineParams): Promise<void> {\n    await this._context.setOffline(params.offline);\n  }\n\n  async setHTTPCredentials(params: channels.BrowserContextSetHTTPCredentialsParams): Promise<void> {\n    await this._context.setHTTPCredentials(params.httpCredentials);\n  }\n\n  async addInitScript(params: channels.BrowserContextAddInitScriptParams): Promise<void> {\n    await this._context.addInitScript(params.source);\n  }\n\n  async setNetworkInterceptionPatterns(params: channels.BrowserContextSetNetworkInterceptionPatternsParams): Promise<void> {\n    if (!params.patterns.length) {\n      await this._context.setRequestInterceptor(undefined);\n      return;\n    }\n    const urlMatchers = params.patterns.map(pattern => pattern.regexSource ? new RegExp(pattern.regexSource, pattern.regexFlags!) : pattern.glob!);\n    await this._context.setRequestInterceptor((route, request) => {\n      const matchesSome = urlMatchers.some(urlMatch => urlMatches(this._context._options.baseURL, request.url(), urlMatch));\n      if (!matchesSome)\n        return false;\n      this._dispatchEvent('route', { route: RouteDispatcher.from(RequestDispatcher.from(this, request), route) });\n      return true;\n    });\n  }\n\n  async storageState(params: channels.BrowserContextStorageStateParams, metadata: CallMetadata): Promise<channels.BrowserContextStorageStateResult> {\n    return await this._context.storageState();\n  }\n\n  async close(params: channels.BrowserContextCloseParams, metadata: CallMetadata): Promise<void> {\n    metadata.potentiallyClosesScope = true;\n    await this._context.close(params);\n  }\n\n  async recorderSupplementEnable(params: channels.BrowserContextRecorderSupplementEnableParams): Promise<void> {\n    await Recorder.show(this._context, RecorderApp.factory(this._context), params);\n  }\n\n  async pause(params: channels.BrowserContextPauseParams, metadata: CallMetadata) {\n    // Debugger will take care of this.\n  }\n\n  async newCDPSession(params: channels.BrowserContextNewCDPSessionParams): Promise<channels.BrowserContextNewCDPSessionResult> {\n    if (!this._object._browser.options.isChromium)\n      throw new Error(`CDP session is only available in Chromium`);\n    if (!params.page && !params.frame || params.page && params.frame)\n      throw new Error(`CDP session must be initiated with either Page or Frame, not none or both`);\n    const crBrowserContext = this._object as CRBrowserContext;\n    return { session: new CDPSessionDispatcher(this, await crBrowserContext.newCDPSession((params.page ? params.page as PageDispatcher : params.frame as FrameDispatcher)._object)) };\n  }\n\n  async harStart(params: channels.BrowserContextHarStartParams): Promise<channels.BrowserContextHarStartResult> {\n    const harId = await this._context._harStart(params.page ? (params.page as PageDispatcher)._object : null, params.options);\n    return { harId };\n  }\n\n  async harExport(params: channels.BrowserContextHarExportParams): Promise<channels.BrowserContextHarExportResult> {\n    const artifact = await this._context._harExport(params.harId);\n    if (!artifact)\n      throw new Error('No HAR artifact. Ensure record.harPath is set.');\n    return { artifact: ArtifactDispatcher.from(this, artifact) };\n  }\n\n  async clockFastForward(params: channels.BrowserContextClockFastForwardParams, metadata?: CallMetadata | undefined): Promise<channels.BrowserContextClockFastForwardResult> {\n    await this._context.clock.fastForward(params.ticksString ?? params.ticksNumber ?? 0);\n  }\n\n  async clockInstall(params: channels.BrowserContextClockInstallParams, metadata?: CallMetadata | undefined): Promise<channels.BrowserContextClockInstallResult> {\n    await this._context.clock.install(params.timeString ?? params.timeNumber ?? undefined);\n  }\n\n  async clockPauseAt(params: channels.BrowserContextClockPauseAtParams, metadata?: CallMetadata | undefined): Promise<channels.BrowserContextClockPauseAtResult> {\n    await this._context.clock.pauseAt(params.timeString ?? params.timeNumber ?? 0);\n  }\n\n  async clockResume(params: channels.BrowserContextClockResumeParams, metadata?: CallMetadata | undefined): Promise<channels.BrowserContextClockResumeResult> {\n    await this._context.clock.resume();\n  }\n\n  async clockRunFor(params: channels.BrowserContextClockRunForParams, metadata?: CallMetadata | undefined): Promise<channels.BrowserContextClockRunForResult> {\n    await this._context.clock.runFor(params.ticksString ?? params.ticksNumber ?? 0);\n  }\n\n  async clockSetFixedTime(params: channels.BrowserContextClockSetFixedTimeParams, metadata?: CallMetadata | undefined): Promise<channels.BrowserContextClockSetFixedTimeResult> {\n    await this._context.clock.setFixedTime(params.timeString ?? params.timeNumber ?? 0);\n  }\n\n  async clockSetSystemTime(params: channels.BrowserContextClockSetSystemTimeParams, metadata?: CallMetadata | undefined): Promise<channels.BrowserContextClockSetSystemTimeResult> {\n    await this._context.clock.setSystemTime(params.timeString ?? params.timeNumber ?? 0);\n  }\n\n  async updateSubscription(params: channels.BrowserContextUpdateSubscriptionParams): Promise<void> {\n    if (params.enabled)\n      this._subscriptions.add(params.event);\n    else\n      this._subscriptions.delete(params.event);\n  }\n\n  override _onDispose() {\n    // Avoid protocol calls for the closed context.\n    if (!this._context.isClosingOrClosed())\n      this._context.setRequestInterceptor(undefined).catch(() => {});\n  }\n}\n"],"mappings":";;;;;;AAgBA,IAAAA,eAAA,GAAAC,OAAA;AACA,IAAAC,WAAA,GAAAD,OAAA;AAEA,IAAAE,eAAA,GAAAF,OAAA;AAGA,IAAAG,mBAAA,GAAAH,OAAA;AACA,IAAAI,UAAA,GAAAJ,OAAA;AACA,IAAAK,qBAAA,GAAAL,OAAA;AACA,IAAAM,SAAA,GAAAN,OAAA;AAEA,IAAAO,mBAAA,GAAAP,OAAA;AAGA,IAAAQ,kBAAA,GAAAR,OAAA;AACA,IAAAS,EAAA,GAAAC,uBAAA,CAAAV,OAAA;AACA,IAAAW,IAAA,GAAAD,uBAAA,CAAAV,OAAA;AACA,IAAAY,MAAA,GAAAZ,OAAA;AACA,IAAAa,yBAAA,GAAAb,OAAA;AACA,IAAAc,iBAAA,GAAAd,OAAA;AAIA,IAAAe,OAAA,GAAAf,OAAA;AACA,IAAAgB,yBAAA,GAAAhB,OAAA;AACA,IAAAiB,YAAA,GAAAjB,OAAA;AAAsD,SAAAkB,yBAAAC,CAAA,6BAAAC,OAAA,mBAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,CAAAC,CAAA,WAAAA,CAAA,GAAAG,CAAA,GAAAD,CAAA,KAAAF,CAAA;AAAA,SAAAT,wBAAAS,CAAA,EAAAE,CAAA,SAAAA,CAAA,IAAAF,CAAA,IAAAA,CAAA,CAAAI,UAAA,SAAAJ,CAAA,eAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,WAAAK,OAAA,EAAAL,CAAA,QAAAG,CAAA,GAAAJ,wBAAA,CAAAG,CAAA,OAAAC,CAAA,IAAAA,CAAA,CAAAG,GAAA,CAAAN,CAAA,UAAAG,CAAA,CAAAI,GAAA,CAAAP,CAAA,OAAAQ,CAAA,KAAAC,SAAA,UAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,CAAA,IAAAd,CAAA,oBAAAc,CAAA,IAAAH,MAAA,CAAAI,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAjB,CAAA,EAAAc,CAAA,SAAAI,CAAA,GAAAR,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAb,CAAA,EAAAc,CAAA,UAAAI,CAAA,KAAAA,CAAA,CAAAX,GAAA,IAAAW,CAAA,CAAAC,GAAA,IAAAR,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAI,CAAA,IAAAV,CAAA,CAAAM,CAAA,IAAAd,CAAA,CAAAc,CAAA,YAAAN,CAAA,CAAAH,OAAA,GAAAL,CAAA,EAAAG,CAAA,IAAAA,CAAA,CAAAgB,GAAA,CAAAnB,CAAA,EAAAQ,CAAA,GAAAA,CAAA;AAzCtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AA6BO,MAAMY,wBAAwB,SAASC,sBAAU,CAA4G;EAMlKC,WAAWA,CAACC,WAA4B,EAAEC,OAAuB,EAAE;IACjE;IACA,MAAMC,cAAc,GAAGC,+CAA2B,CAACC,IAAI,CAACJ,WAAW,EAA8BC,OAAO,CAACI,YAAY,CAAC;IACtH,MAAMC,OAAO,GAAGC,oCAAiB,CAACH,IAAI,CAACJ,WAAW,EAA8BC,OAAO,CAACK,OAAO,CAAC;IAEhG,KAAK,CAACN,WAAW,EAAEC,OAAO,EAAE,gBAAgB,EAAE;MAC5CO,UAAU,EAAEP,OAAO,CAACQ,QAAQ,CAACC,OAAO,CAACF,UAAU;MAC/CG,sBAAsB,EAAEV,OAAO,CAACQ,QAAQ,CAACG,uBAAuB;MAChEV,cAAc;MACdI;IACF,CAAC,CAAC;IAAC,KAfLO,iBAAiB,GAAG,IAAI;IAAA,KACxBC,oBAAoB,GAAG,IAAI;IAAA,KACnBC,QAAQ;IAAA,KACRC,cAAc,GAAG,IAAIC,GAAG,CAA2D,CAAC;IAc1F,IAAI,CAACC,KAAK,CAAChB,cAAc,CAAC;IAC1B,IAAI,CAACgB,KAAK,CAACZ,OAAO,CAAC;IAEnB,IAAI,CAACS,QAAQ,GAAGd,OAAO;IACvB;IACA;;IAEA,MAAMkB,OAAO,GAAIC,QAAkB,IAAK;MACtC;MACA;MACA,MAAMC,kBAAkB,GAAGC,sCAAkB,CAAClB,IAAI,CAACJ,WAAW,EAAEoB,QAAQ,CAAC;MACzE,IAAI,CAACG,cAAc,CAAC,OAAO,EAAE;QAAEH,QAAQ,EAAEC;MAAmB,CAAC,CAAC;IAChE,CAAC;IACD,IAAI,CAACG,iBAAiB,CAACC,8BAAc,CAACC,MAAM,CAACC,YAAY,EAAER,OAAO,CAAC;IACnE,KAAK,MAAMS,KAAK,IAAI3B,OAAO,CAACQ,QAAQ,CAACoB,UAAU,CAACC,MAAM,CAAC,CAAC,EAAE;MACxD,IAAIF,KAAK,CAAC3B,OAAO,KAAKA,OAAO,EAC3BkB,OAAO,CAACS,KAAK,CAACR,QAAQ,CAAC;IAC3B;IAEA,KAAK,MAAMW,IAAI,IAAI9B,OAAO,CAAC+B,KAAK,CAAC,CAAC,EAChC,IAAI,CAACT,cAAc,CAAC,MAAM,EAAE;MAAEQ,IAAI,EAAEE,8BAAc,CAAC7B,IAAI,CAAC,IAAI,EAAE2B,IAAI;IAAE,CAAC,CAAC;IACxE,IAAI,CAACP,iBAAiB,CAACC,8BAAc,CAACC,MAAM,CAACQ,IAAI,EAAEH,IAAI,IAAI;MACzD,IAAI,CAACR,cAAc,CAAC,MAAM,EAAE;QAAEQ,IAAI,EAAEE,8BAAc,CAAC7B,IAAI,CAAC,IAAI,EAAE2B,IAAI;MAAE,CAAC,CAAC;IACxE,CAAC,CAAC;IACF,IAAI,CAACP,iBAAiB,CAACC,8BAAc,CAACC,MAAM,CAACS,KAAK,EAAE,MAAM;MACxD,IAAI,CAACZ,cAAc,CAAC,OAAO,CAAC;MAC5B,IAAI,CAACa,QAAQ,CAAC,CAAC;IACjB,CAAC,CAAC;IACF,IAAI,CAACZ,iBAAiB,CAACC,8BAAc,CAACC,MAAM,CAACW,SAAS,EAAE,CAACC,KAAY,EAAEP,IAAU,KAAK;MACpF,IAAI,CAACR,cAAc,CAAC,WAAW,EAAE;QAAEe,KAAK,EAAE,IAAAC,sBAAc,EAACD,KAAK,CAAC;QAAEP,IAAI,EAAEE,8BAAc,CAAC7B,IAAI,CAAC,IAAI,EAAE2B,IAAI;MAAE,CAAC,CAAC;IAC3G,CAAC,CAAC;IACF,IAAI,CAACP,iBAAiB,CAACC,8BAAc,CAACC,MAAM,CAACc,OAAO,EAAGC,OAAuB,IAAK;MACjF,MAAMV,IAAI,GAAGU,OAAO,CAACV,IAAI,CAAC,CAAE;MAC5B,IAAI,IAAI,CAACW,oBAAoB,CAACX,IAAI,EAAE,SAAS,CAAC,EAAE;QAC9C,MAAMY,cAAc,GAAGV,8BAAc,CAAC7B,IAAI,CAAC,IAAI,EAAE2B,IAAI,CAAC;QACtD,IAAI,CAACR,cAAc,CAAC,SAAS,EAAE;UAC7BQ,IAAI,EAAEY,cAAc;UACpBC,IAAI,EAAEH,OAAO,CAACG,IAAI,CAAC,CAAC;UACpBC,IAAI,EAAEJ,OAAO,CAACI,IAAI,CAAC,CAAC;UACpBC,IAAI,EAAEL,OAAO,CAACK,IAAI,CAAC,CAAC,CAACC,GAAG,CAAC5D,CAAC,IAAI6D,iDAAuB,CAACC,YAAY,CAACN,cAAc,EAAExD,CAAC,CAAC,CAAC;UACtF+D,QAAQ,EAAET,OAAO,CAACS,QAAQ,CAAC;QAC7B,CAAC,CAAC;MACJ;IACF,CAAC,CAAC;IACF,IAAI,CAAC1B,iBAAiB,CAACC,8BAAc,CAACC,MAAM,CAACyB,MAAM,EAAGC,MAAc,IAAK;MACvE,IAAI,IAAI,CAACV,oBAAoB,CAACU,MAAM,CAACrB,IAAI,CAAC,CAAC,EAAE,QAAQ,CAAC,EACpD,IAAI,CAACR,cAAc,CAAC,QAAQ,EAAE;QAAE6B,MAAM,EAAE,IAAIC,kCAAgB,CAAC,IAAI,EAAED,MAAM;MAAE,CAAC,CAAC,CAAC,KAE9EA,MAAM,CAACE,KAAK,CAAC,CAAC,CAACC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;IAClC,CAAC,CAAC;IAEF,IAAItD,OAAO,CAACQ,QAAQ,CAACC,OAAO,CAAC8C,IAAI,KAAK,UAAU,EAAE;MAChD,KAAK,MAAMzB,IAAI,IAAK9B,OAAO,CAAsBwD,eAAe,CAAC,CAAC,EAChE,IAAI,CAAClC,cAAc,CAAC,gBAAgB,EAAE;QAAEQ,IAAI,EAAEE,8BAAc,CAAC7B,IAAI,CAAC,IAAI,EAAE2B,IAAI;MAAE,CAAC,CAAC;MAClF,IAAI,CAACP,iBAAiB,CAACkC,2BAAgB,CAACC,QAAQ,CAACC,cAAc,EAAE7B,IAAI,IAAI,IAAI,CAACR,cAAc,CAAC,gBAAgB,EAAE;QAAEQ,IAAI,EAAEE,8BAAc,CAAC7B,IAAI,CAAC,IAAI,EAAE2B,IAAI;MAAE,CAAC,CAAC,CAAC;MAC1J,KAAK,MAAM8B,aAAa,IAAK5D,OAAO,CAAsB6D,cAAc,CAAC,CAAC,EACxE,IAAI,CAACvC,cAAc,CAAC,eAAe,EAAE;QAAEwC,MAAM,EAAE,IAAIC,gCAAgB,CAAC,IAAI,EAAEH,aAAa;MAAE,CAAC,CAAC;MAC7F,IAAI,CAACrC,iBAAiB,CAACkC,2BAAgB,CAACC,QAAQ,CAACM,aAAa,EAAEJ,aAAa,IAAI,IAAI,CAACtC,cAAc,CAAC,eAAe,EAAE;QAAEwC,MAAM,EAAE,IAAIC,gCAAgB,CAAC,IAAI,EAAEH,aAAa;MAAE,CAAC,CAAC,CAAC;IAC/K;IACA,IAAI,CAACrC,iBAAiB,CAACC,8BAAc,CAACC,MAAM,CAACwC,OAAO,EAAGC,OAAgB,IAAM;MAAA,IAAAC,cAAA;MAC3E;MACA;MACA;MACA;MACA;MACA,MAAMC,sBAAsB,GAAGF,OAAO,CAACG,cAAc,CAAC,CAAC,IAAI,IAAAC,8BAAkB,EAACJ,OAAO,CAACG,cAAc,CAAC,CAAC,CAAC;MACvG,IAAI,CAACD,sBAAsB,IAAI,CAAC,IAAI,CAACG,2BAA2B,CAACL,OAAO,EAAE,SAAS,CAAC,IAAI,CAACA,OAAO,CAACM,mBAAmB,CAAC,CAAC,EACpH;MACF,MAAMC,iBAAiB,GAAGC,qCAAiB,CAACvE,IAAI,CAAC,IAAI,EAAE+D,OAAO,CAAC;MAC/D,IAAI,CAAC5C,cAAc,CAAC,SAAS,EAAE;QAC7B4C,OAAO,EAAEO,iBAAiB;QAC1B3C,IAAI,EAAEE,8BAAc,CAAC2C,YAAY,CAAC,IAAI,GAAAR,cAAA,GAAED,OAAO,CAACU,KAAK,CAAC,CAAC,cAAAT,cAAA,uBAAfA,cAAA,CAAiBU,KAAK,CAACC,sBAAsB,CAAC,CAAC;MACzF,CAAC,CAAC;IACJ,CAAC,CAAC;IACF,IAAI,CAACvD,iBAAiB,CAACC,8BAAc,CAACC,MAAM,CAACsD,QAAQ,EAAGC,QAAkB,IAAK;MAAA,IAAAC,eAAA;MAC7E,MAAMR,iBAAiB,GAAG,IAAAH,8BAAkB,EAAoBU,QAAQ,CAACd,OAAO,CAAC,CAAC,CAAC;MACnF,IAAI,CAACO,iBAAiB,IAAI,CAAC,IAAI,CAACF,2BAA2B,CAACS,QAAQ,CAACd,OAAO,CAAC,CAAC,EAAE,UAAU,CAAC,EACzF;MACF,IAAI,CAAC5C,cAAc,CAAC,UAAU,EAAE;QAC9B0D,QAAQ,EAAEE,sCAAkB,CAAC/E,IAAI,CAAC,IAAI,EAAE6E,QAAQ,CAAC;QACjDlD,IAAI,EAAEE,8BAAc,CAAC2C,YAAY,CAAC,IAAI,GAAAM,eAAA,GAAED,QAAQ,CAACJ,KAAK,CAAC,CAAC,cAAAK,eAAA,uBAAhBA,eAAA,CAAkBJ,KAAK,CAACC,sBAAsB,CAAC,CAAC;MAC1F,CAAC,CAAC;IACJ,CAAC,CAAC;IACF,IAAI,CAACvD,iBAAiB,CAACC,8BAAc,CAACC,MAAM,CAAC0D,aAAa,EAAGjB,OAAgB,IAAK;MAAA,IAAAkB,eAAA;MAChF,MAAMX,iBAAiB,GAAG,IAAAH,8BAAkB,EAAoBJ,OAAO,CAAC;MACxE,IAAI,CAACO,iBAAiB,IAAI,CAAC,IAAI,CAACF,2BAA2B,CAACL,OAAO,EAAE,eAAe,CAAC,EACnF;MACF,IAAI,CAAC5C,cAAc,CAAC,eAAe,EAAE;QACnC4C,OAAO,EAAEQ,qCAAiB,CAACvE,IAAI,CAAC,IAAI,EAAE+D,OAAO,CAAC;QAC9CmB,WAAW,EAAEnB,OAAO,CAACoB,YAAY,IAAIC,SAAS;QAC9CC,iBAAiB,EAAEtB,OAAO,CAACuB,kBAAkB;QAC7C3D,IAAI,EAAEE,8BAAc,CAAC2C,YAAY,CAAC,IAAI,GAAAS,eAAA,GAAElB,OAAO,CAACU,KAAK,CAAC,CAAC,cAAAQ,eAAA,uBAAfA,eAAA,CAAiBP,KAAK,CAACC,sBAAsB,CAAC,CAAC;MACzF,CAAC,CAAC;IACJ,CAAC,CAAC;IACF,IAAI,CAACvD,iBAAiB,CAACC,8BAAc,CAACC,MAAM,CAACiE,eAAe,EAAE,CAAC;MAAExB,OAAO;MAAEc;IAA0D,CAAC,KAAK;MAAA,IAAAW,eAAA;MACxI,MAAMlB,iBAAiB,GAAG,IAAAH,8BAAkB,EAAoBJ,OAAO,CAAC;MACxE,IAAI,CAACO,iBAAiB,IAAI,CAAC,IAAI,CAACF,2BAA2B,CAACL,OAAO,EAAE,iBAAiB,CAAC,EACrF;MACF,IAAI,CAAC5C,cAAc,CAAC,iBAAiB,EAAE;QACrC4C,OAAO,EAAEQ,qCAAiB,CAACvE,IAAI,CAAC,IAAI,EAAE+D,OAAO,CAAC;QAC9Cc,QAAQ,EAAEE,sCAAkB,CAACP,YAAY,CAAC,IAAI,EAAEK,QAAQ,CAAC;QACzDQ,iBAAiB,EAAEtB,OAAO,CAACuB,kBAAkB;QAC7C3D,IAAI,EAAEE,8BAAc,CAAC2C,YAAY,CAAC,IAAI,GAAAgB,eAAA,GAAEzB,OAAO,CAACU,KAAK,CAAC,CAAC,cAAAe,eAAA,uBAAfA,eAAA,CAAiBd,KAAK,CAACC,sBAAsB,CAAC,CAAC;MACzF,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEQP,2BAA2BA,CAACL,OAAgB,EAAE0B,KAAgH,EAAW;IAAA,IAAAC,eAAA;IAC/K,OAAO,IAAI,CAACpD,oBAAoB,EAAAoD,eAAA,GAAC3B,OAAO,CAACU,KAAK,CAAC,CAAC,cAAAiB,eAAA,gBAAAA,eAAA,GAAfA,eAAA,CAAiBhB,KAAK,cAAAgB,eAAA,uBAAtBA,eAAA,CAAwBf,sBAAsB,CAAC,CAAC,EAAEc,KAAK,CAAC;EAC3F;EAEQnD,oBAAoBA,CAACX,IAAsB,EAAE8D,KAAgH,EAAW;IAC9K,IAAI,IAAI,CAAC7E,cAAc,CAACjC,GAAG,CAAC8G,KAAK,CAAC,EAChC,OAAO,IAAI;IACb,MAAMlD,cAAc,GAAGZ,IAAI,GAAG,IAAAwC,8BAAkB,EAAiBxC,IAAI,CAAC,GAAGyD,SAAS;IAClF,IAAI7C,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAE3B,cAAc,CAACjC,GAAG,CAAC8G,KAAK,CAAC,EAC3C,OAAO,IAAI;IACb,OAAO,KAAK;EACd;EAEA,MAAME,eAAeA,CAACC,MAAoD,EAAyD;IACjI,MAAMC,GAAG,GAAG,IAAI,CAAClF,QAAQ,CAACN,QAAQ,CAACC,OAAO,CAACwF,YAAY;IACvD,MAAMC,MAAM,GAAGlI,IAAI,CAACmI,IAAI,CAACH,GAAG,EAAE,SAAS,GAAG,IAAAI,iBAAU,EAAC,CAAC,CAAC;IACvD,MAAMC,mBAAmB,GAAGN,MAAM,CAACO,WAAW,GAAGtI,IAAI,CAACmI,IAAI,CAACD,MAAM,EAAElI,IAAI,CAACuI,QAAQ,CAACR,MAAM,CAACO,WAAW,CAAC,CAAC,GAAGJ,MAAM;IAC9G,MAAMpI,EAAE,CAAC0I,QAAQ,CAACC,KAAK,CAACJ,mBAAmB,EAAE;MAAEK,SAAS,EAAE;IAAK,CAAC,CAAC;IACjE,IAAI,CAAC5F,QAAQ,CAAC6F,SAAS,CAACC,IAAI,CAACV,MAAM,CAAC;IACpC,OAAO;MACLW,OAAO,EAAEd,MAAM,CAACO,WAAW,GAAG,IAAIQ,kDAAwB,CAAC,IAAI,EAAET,mBAAmB,CAAC,GAAGd,SAAS;MACjGwB,eAAe,EAAE,MAAMC,OAAO,CAACC,GAAG,CAAClB,MAAM,CAACmB,KAAK,CAACpE,GAAG,CAAC,MAAMqE,IAAI,IAAI;QAChE,MAAMrJ,EAAE,CAAC0I,QAAQ,CAACC,KAAK,CAACzI,IAAI,CAACoJ,OAAO,CAACpJ,IAAI,CAACmI,IAAI,CAACE,mBAAmB,EAAEc,IAAI,CAAC5D,IAAI,CAAC,CAAC,EAAE;UAAEmD,SAAS,EAAE;QAAK,CAAC,CAAC;QACrG,MAAMW,IAAI,GAAGvJ,EAAE,CAACwJ,iBAAiB,CAACtJ,IAAI,CAACmI,IAAI,CAACE,mBAAmB,EAAEc,IAAI,CAAC5D,IAAI,CAAC,CAAC;QAC5E,OAAO,IAAIuD,kDAAwB,CAAC,IAAI,EAAEO,IAAI,EAAEF,IAAI,CAACI,cAAc,CAAC;MACtE,CAAC,CAAC;IACJ,CAAC;EACH;EAEA,MAAMC,kCAAkCA,CAACzB,MAAuE,EAAE;IAChH,IAAI,CAACjF,QAAQ,CAAC2G,2BAA2B,CAAC1B,MAAM,CAAC2B,OAAO,CAAC;EAC3D;EAEA,MAAMC,wBAAwBA,CAAC5B,MAA6D,EAAE;IAC5F,IAAI,CAACjF,QAAQ,CAAC8G,iBAAiB,CAAC7B,MAAM,CAAC2B,OAAO,CAAC;EACjD;EAEA,MAAMG,aAAaA,CAAC9B,MAAkD,EAAiB;IACrF,MAAM,IAAI,CAACjF,QAAQ,CAAC+G,aAAa,CAAC9B,MAAM,CAACxC,IAAI,EAAE,CAAC,CAACwC,MAAM,CAAC+B,WAAW,EAAE,CAACC,MAAM,EAAE,GAAGlF,IAAI,KAAK;MACxF;MACA;MACA,IAAI,IAAI,CAACmF,SAAS,EAChB;MACF,MAAMtF,cAAc,GAAGV,8BAAc,CAAC7B,IAAI,CAAC,IAAI,EAAE4H,MAAM,CAACjG,IAAI,CAAC;MAC7D,MAAMmG,OAAO,GAAG,IAAIC,qCAAqB,CAACxF,cAAc,EAAEqD,MAAM,CAACxC,IAAI,EAAE,CAAC,CAACwC,MAAM,CAAC+B,WAAW,EAAEC,MAAM,EAAElF,IAAI,CAAC;MAC1G,IAAI,CAACvB,cAAc,CAAC,aAAa,EAAE;QAAE2G;MAAQ,CAAC,CAAC;MAC/C,OAAOA,OAAO,CAACE,OAAO,CAAC,CAAC;IAC1B,CAAC,CAAC;EACJ;EAEA,MAAMC,OAAOA,CAACrC,MAA4C,EAAEsC,QAAsB,EAAiD;IACjI,OAAO;MAAEvG,IAAI,EAAEE,8BAAc,CAAC7B,IAAI,CAAC,IAAI,EAAE,MAAM,IAAI,CAACW,QAAQ,CAACsH,OAAO,CAACC,QAAQ,CAAC;IAAE,CAAC;EACnF;EAEA,MAAMC,OAAOA,CAACvC,MAA4C,EAAiD;IACzG,OAAO;MAAEuC,OAAO,EAAE,MAAM,IAAI,CAACxH,QAAQ,CAACwH,OAAO,CAACvC,MAAM,CAACwC,IAAI;IAAE,CAAC;EAC9D;EAEA,MAAMC,UAAUA,CAACzC,MAA+C,EAAiB;IAC/E,MAAM,IAAI,CAACjF,QAAQ,CAAC0H,UAAU,CAACzC,MAAM,CAACuC,OAAO,CAAC;EAChD;EAEA,MAAMG,YAAYA,CAAC1C,MAAiD,EAAiB;IACnF,MAAM2C,MAAM,GAAG3C,MAAM,CAAC4C,eAAe,KAAKpD,SAAS,IAAIQ,MAAM,CAAC6C,cAAc,KAAKrD,SAAS,GAAG,IAAIsD,MAAM,CAAC9C,MAAM,CAAC4C,eAAe,EAAE5C,MAAM,CAAC6C,cAAc,CAAC,GAAGrD,SAAS;IAClK,MAAMuD,QAAQ,GAAG/C,MAAM,CAACgD,iBAAiB,KAAKxD,SAAS,IAAIQ,MAAM,CAACiD,gBAAgB,KAAKzD,SAAS,GAAG,IAAIsD,MAAM,CAAC9C,MAAM,CAACgD,iBAAiB,EAAEhD,MAAM,CAACiD,gBAAgB,CAAC,GAAGzD,SAAS;IAC5K,MAAM0D,MAAM,GAAGlD,MAAM,CAACmD,eAAe,KAAK3D,SAAS,IAAIQ,MAAM,CAACoD,cAAc,KAAK5D,SAAS,GAAG,IAAIsD,MAAM,CAAC9C,MAAM,CAACmD,eAAe,EAAEnD,MAAM,CAACoD,cAAc,CAAC,GAAG5D,SAAS;IAClK,MAAM,IAAI,CAACzE,QAAQ,CAAC2H,YAAY,CAAC;MAC/BlF,IAAI,EAAEmF,MAAM,IAAI3C,MAAM,CAACxC,IAAI;MAC3B6F,MAAM,EAAEN,QAAQ,IAAI/C,MAAM,CAACqD,MAAM;MACjCpL,IAAI,EAAEiL,MAAM,IAAIlD,MAAM,CAAC/H;IACzB,CAAC,CAAC;EACJ;EAEA,MAAMqL,gBAAgBA,CAACtD,MAAqD,EAAiB;IAC3F,MAAM,IAAI,CAACjF,QAAQ,CAACuI,gBAAgB,CAACtD,MAAM,CAACuD,WAAW,EAAEvD,MAAM,CAACwD,MAAM,CAAC;EACzE;EAEA,MAAMC,gBAAgBA,CAAA,EAAkB;IACtC,MAAM,IAAI,CAAC1I,QAAQ,CAAC0I,gBAAgB,CAAC,CAAC;EACxC;EAEA,MAAMC,cAAcA,CAAC1D,MAAmD,EAAiB;IACvF,MAAM,IAAI,CAACjF,QAAQ,CAAC2I,cAAc,CAAC1D,MAAM,CAAC2D,WAAW,CAAC;EACxD;EAEA,MAAMC,mBAAmBA,CAAC5D,MAAwD,EAAiB;IACjG,MAAM,IAAI,CAACjF,QAAQ,CAAC6I,mBAAmB,CAAC5D,MAAM,CAAC6D,OAAO,CAAC;EACzD;EAEA,MAAMC,UAAUA,CAAC9D,MAA+C,EAAiB;IAC/E,MAAM,IAAI,CAACjF,QAAQ,CAAC+I,UAAU,CAAC9D,MAAM,CAAC+D,OAAO,CAAC;EAChD;EAEA,MAAMC,kBAAkBA,CAAChE,MAAuD,EAAiB;IAC/F,MAAM,IAAI,CAACjF,QAAQ,CAACiJ,kBAAkB,CAAChE,MAAM,CAACiE,eAAe,CAAC;EAChE;EAEA,MAAMC,aAAaA,CAAClE,MAAkD,EAAiB;IACrF,MAAM,IAAI,CAACjF,QAAQ,CAACmJ,aAAa,CAAClE,MAAM,CAACgC,MAAM,CAAC;EAClD;EAEA,MAAMmC,8BAA8BA,CAACnE,MAAmE,EAAiB;IACvH,IAAI,CAACA,MAAM,CAACoE,QAAQ,CAACC,MAAM,EAAE;MAC3B,MAAM,IAAI,CAACtJ,QAAQ,CAACuJ,qBAAqB,CAAC9E,SAAS,CAAC;MACpD;IACF;IACA,MAAM+E,WAAW,GAAGvE,MAAM,CAACoE,QAAQ,CAACrH,GAAG,CAACyH,OAAO,IAAIA,OAAO,CAACC,WAAW,GAAG,IAAI3B,MAAM,CAAC0B,OAAO,CAACC,WAAW,EAAED,OAAO,CAACE,UAAW,CAAC,GAAGF,OAAO,CAACG,IAAK,CAAC;IAC9I,MAAM,IAAI,CAAC5J,QAAQ,CAACuJ,qBAAqB,CAAC,CAACM,KAAK,EAAEzG,OAAO,KAAK;MAC5D,MAAM0G,WAAW,GAAGN,WAAW,CAACO,IAAI,CAACC,QAAQ,IAAI,IAAAC,iBAAU,EAAC,IAAI,CAACjK,QAAQ,CAACkK,QAAQ,CAACC,OAAO,EAAE/G,OAAO,CAACgH,GAAG,CAAC,CAAC,EAAEJ,QAAQ,CAAC,CAAC;MACrH,IAAI,CAACF,WAAW,EACd,OAAO,KAAK;MACd,IAAI,CAACtJ,cAAc,CAAC,OAAO,EAAE;QAAEqJ,KAAK,EAAEQ,mCAAe,CAAChL,IAAI,CAACuE,qCAAiB,CAACvE,IAAI,CAAC,IAAI,EAAE+D,OAAO,CAAC,EAAEyG,KAAK;MAAE,CAAC,CAAC;MAC3G,OAAO,IAAI;IACb,CAAC,CAAC;EACJ;EAEA,MAAMS,YAAYA,CAACrF,MAAiD,EAAEsC,QAAsB,EAAsD;IAChJ,OAAO,MAAM,IAAI,CAACvH,QAAQ,CAACsK,YAAY,CAAC,CAAC;EAC3C;EAEA,MAAM/H,KAAKA,CAAC0C,MAA0C,EAAEsC,QAAsB,EAAiB;IAC7FA,QAAQ,CAACgD,sBAAsB,GAAG,IAAI;IACtC,MAAM,IAAI,CAACvK,QAAQ,CAACuC,KAAK,CAAC0C,MAAM,CAAC;EACnC;EAEA,MAAMuF,wBAAwBA,CAACvF,MAA6D,EAAiB;IAC3G,MAAMwF,kBAAQ,CAACC,IAAI,CAAC,IAAI,CAAC1K,QAAQ,EAAE2K,wBAAW,CAACC,OAAO,CAAC,IAAI,CAAC5K,QAAQ,CAAC,EAAEiF,MAAM,CAAC;EAChF;EAEA,MAAM4F,KAAKA,CAAC5F,MAA0C,EAAEsC,QAAsB,EAAE;IAC9E;EAAA;EAGF,MAAMuD,aAAaA,CAAC7F,MAAkD,EAAuD;IAC3H,IAAI,CAAC,IAAI,CAAC8F,OAAO,CAACrL,QAAQ,CAACC,OAAO,CAACF,UAAU,EAC3C,MAAM,IAAIuL,KAAK,CAAE,2CAA0C,CAAC;IAC9D,IAAI,CAAC/F,MAAM,CAACjE,IAAI,IAAI,CAACiE,MAAM,CAACnB,KAAK,IAAImB,MAAM,CAACjE,IAAI,IAAIiE,MAAM,CAACnB,KAAK,EAC9D,MAAM,IAAIkH,KAAK,CAAE,2EAA0E,CAAC;IAC9F,MAAMC,gBAAgB,GAAG,IAAI,CAACF,OAA2B;IACzD,OAAO;MAAEG,OAAO,EAAE,IAAIC,0CAAoB,CAAC,IAAI,EAAE,MAAMF,gBAAgB,CAACH,aAAa,CAAC,CAAC7F,MAAM,CAACjE,IAAI,GAAGiE,MAAM,CAACjE,IAAI,GAAqBiE,MAAM,CAACnB,KAAwB,EAAEiH,OAAO,CAAC;IAAE,CAAC;EACnL;EAEA,MAAMK,QAAQA,CAACnG,MAA6C,EAAkD;IAC5G,MAAMoG,KAAK,GAAG,MAAM,IAAI,CAACrL,QAAQ,CAACsL,SAAS,CAACrG,MAAM,CAACjE,IAAI,GAAIiE,MAAM,CAACjE,IAAI,CAAoB+J,OAAO,GAAG,IAAI,EAAE9F,MAAM,CAACtF,OAAO,CAAC;IACzH,OAAO;MAAE0L;IAAM,CAAC;EAClB;EAEA,MAAME,SAASA,CAACtG,MAA8C,EAAmD;IAC/G,MAAM5E,QAAQ,GAAG,MAAM,IAAI,CAACL,QAAQ,CAACwL,UAAU,CAACvG,MAAM,CAACoG,KAAK,CAAC;IAC7D,IAAI,CAAChL,QAAQ,EACX,MAAM,IAAI2K,KAAK,CAAC,gDAAgD,CAAC;IACnE,OAAO;MAAE3K,QAAQ,EAAEE,sCAAkB,CAAClB,IAAI,CAAC,IAAI,EAAEgB,QAAQ;IAAE,CAAC;EAC9D;EAEA,MAAMoL,gBAAgBA,CAACxG,MAAqD,EAAEsC,QAAmC,EAA0D;IAAA,IAAAmE,IAAA,EAAAC,mBAAA;IACzK,MAAM,IAAI,CAAC3L,QAAQ,CAAC4L,KAAK,CAACC,WAAW,EAAAH,IAAA,IAAAC,mBAAA,GAAC1G,MAAM,CAAC6G,WAAW,cAAAH,mBAAA,cAAAA,mBAAA,GAAI1G,MAAM,CAAC8G,WAAW,cAAAL,IAAA,cAAAA,IAAA,GAAI,CAAC,CAAC;EACtF;EAEA,MAAMM,YAAYA,CAAC/G,MAAiD,EAAEsC,QAAmC,EAAsD;IAAA,IAAA0E,KAAA,EAAAC,kBAAA;IAC7J,MAAM,IAAI,CAAClM,QAAQ,CAAC4L,KAAK,CAACO,OAAO,EAAAF,KAAA,IAAAC,kBAAA,GAACjH,MAAM,CAACmH,UAAU,cAAAF,kBAAA,cAAAA,kBAAA,GAAIjH,MAAM,CAACoH,UAAU,cAAAJ,KAAA,cAAAA,KAAA,GAAIxH,SAAS,CAAC;EACxF;EAEA,MAAM6H,YAAYA,CAACrH,MAAiD,EAAEsC,QAAmC,EAAsD;IAAA,IAAAgF,KAAA,EAAAC,mBAAA;IAC7J,MAAM,IAAI,CAACxM,QAAQ,CAAC4L,KAAK,CAACa,OAAO,EAAAF,KAAA,IAAAC,mBAAA,GAACvH,MAAM,CAACmH,UAAU,cAAAI,mBAAA,cAAAA,mBAAA,GAAIvH,MAAM,CAACoH,UAAU,cAAAE,KAAA,cAAAA,KAAA,GAAI,CAAC,CAAC;EAChF;EAEA,MAAMG,WAAWA,CAACzH,MAAgD,EAAEsC,QAAmC,EAAqD;IAC1J,MAAM,IAAI,CAACvH,QAAQ,CAAC4L,KAAK,CAACe,MAAM,CAAC,CAAC;EACpC;EAEA,MAAMC,WAAWA,CAAC3H,MAAgD,EAAEsC,QAAmC,EAAqD;IAAA,IAAAsF,KAAA,EAAAC,oBAAA;IAC1J,MAAM,IAAI,CAAC9M,QAAQ,CAAC4L,KAAK,CAACmB,MAAM,EAAAF,KAAA,IAAAC,oBAAA,GAAC7H,MAAM,CAAC6G,WAAW,cAAAgB,oBAAA,cAAAA,oBAAA,GAAI7H,MAAM,CAAC8G,WAAW,cAAAc,KAAA,cAAAA,KAAA,GAAI,CAAC,CAAC;EACjF;EAEA,MAAMG,iBAAiBA,CAAC/H,MAAsD,EAAEsC,QAAmC,EAA2D;IAAA,IAAA0F,KAAA,EAAAC,mBAAA;IAC5K,MAAM,IAAI,CAAClN,QAAQ,CAAC4L,KAAK,CAACuB,YAAY,EAAAF,KAAA,IAAAC,mBAAA,GAACjI,MAAM,CAACmH,UAAU,cAAAc,mBAAA,cAAAA,mBAAA,GAAIjI,MAAM,CAACoH,UAAU,cAAAY,KAAA,cAAAA,KAAA,GAAI,CAAC,CAAC;EACrF;EAEA,MAAMG,kBAAkBA,CAACnI,MAAuD,EAAEsC,QAAmC,EAA4D;IAAA,IAAA8F,KAAA,EAAAC,mBAAA;IAC/K,MAAM,IAAI,CAACtN,QAAQ,CAAC4L,KAAK,CAAC2B,aAAa,EAAAF,KAAA,IAAAC,mBAAA,GAACrI,MAAM,CAACmH,UAAU,cAAAkB,mBAAA,cAAAA,mBAAA,GAAIrI,MAAM,CAACoH,UAAU,cAAAgB,KAAA,cAAAA,KAAA,GAAI,CAAC,CAAC;EACtF;EAEA,MAAMG,kBAAkBA,CAACvI,MAAuD,EAAiB;IAC/F,IAAIA,MAAM,CAACwI,OAAO,EAChB,IAAI,CAACxN,cAAc,CAACyN,GAAG,CAACzI,MAAM,CAACH,KAAK,CAAC,CAAC,KAEtC,IAAI,CAAC7E,cAAc,CAAC0N,MAAM,CAAC1I,MAAM,CAACH,KAAK,CAAC;EAC5C;EAES8I,UAAUA,CAAA,EAAG;IACpB;IACA,IAAI,CAAC,IAAI,CAAC5N,QAAQ,CAAC6N,iBAAiB,CAAC,CAAC,EACpC,IAAI,CAAC7N,QAAQ,CAACuJ,qBAAqB,CAAC9E,SAAS,CAAC,CAACjC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;EAClE;AACF;AAACsL,OAAA,CAAAhP,wBAAA,GAAAA,wBAAA"}