{"version":3,"file":"networkDispatchers.js","names":["_network","require","_dispatcher","_tracingDispatcher","_frameDispatcher","_pageDispatcher","RequestDispatcher","Dispatcher","from","scope","request","result","existingDispatcher","fromNullable","undefined","constructor","_request$frame","postData","postDataBuffer","frame","page","_page","pageDispatcher","frameDispatcher","FrameDispatcher","serviceWorker","WorkerDispatcher","url","resourceType","method","headers","isNavigationRequest","redirectedFrom","_type_Request","_browserContextDispatcher","rawRequestHeaders","params","_object","response","ResponseDispatcher","exports","requestDispatcher","status","statusText","timing","fromServiceWorker","_type_Response","body","binary","securityDetails","value","serverAddr","rawResponseHeaders","sizes","RouteDispatcher","route","_type_Route","continue","metadata","isFallback","fulfill","abort","errorCode","redirectNavigationRequest","WebSocketDispatcher","webSocket","_type_EventTarget","_type_WebSocket","addObjectListener","WebSocket","Events","FrameSent","event","_dispatchEvent","FrameReceived","SocketError","error","Close","APIRequestContextDispatcher","parentScope","tracing","TracingDispatcher","_type_APIRequestContext","adopt","storageState","dispose","potentiallyClosesScope","_dispose","fetch","fetchResponse","fetchUid","fetchResponseBody","fetchResponses","get","fetchLog","log","disposeAPIResponse","disposeResponse"],"sources":["../../../src/server/dispatchers/networkDispatchers.ts"],"sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the 'License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type * as channels from '@protocol/channels';\nimport type { APIRequestContext } from '../fetch';\nimport type { CallMetadata } from '../instrumentation';\nimport type { Request, Response, Route } from '../network';\nimport { WebSocket } from '../network';\nimport type { RootDispatcher } from './dispatcher';\nimport { Dispatcher, existingDispatcher } from './dispatcher';\nimport { TracingDispatcher } from './tracingDispatcher';\nimport type { BrowserContextDispatcher } from './browserContextDispatcher';\nimport type { PageDispatcher } from './pageDispatcher';\nimport { FrameDispatcher } from './frameDispatcher';\nimport { WorkerDispatcher } from './pageDispatcher';\n\nexport class RequestDispatcher extends Dispatcher<Request, channels.RequestChannel, BrowserContextDispatcher | PageDispatcher | FrameDispatcher> implements channels.RequestChannel {\n  _type_Request: boolean;\n  private _browserContextDispatcher: BrowserContextDispatcher;\n\n  static from(scope: BrowserContextDispatcher, request: Request): RequestDispatcher {\n    const result = existingDispatcher<RequestDispatcher>(request);\n    return result || new RequestDispatcher(scope, request);\n  }\n\n  static fromNullable(scope: BrowserContextDispatcher, request: Request | null): RequestDispatcher | undefined {\n    return request ? RequestDispatcher.from(scope, request) : undefined;\n  }\n\n  private constructor(scope: BrowserContextDispatcher, request: Request) {\n    const postData = request.postDataBuffer();\n    // Always try to attach request to the page, if not, frame.\n    const frame = request.frame();\n    const page = request.frame()?._page;\n    const pageDispatcher = page ? existingDispatcher<PageDispatcher>(page) : null;\n    const frameDispatcher = frame ? FrameDispatcher.from(scope, frame) : null;\n    super(pageDispatcher || frameDispatcher || scope, request, 'Request', {\n      frame: FrameDispatcher.fromNullable(scope, request.frame()),\n      serviceWorker: WorkerDispatcher.fromNullable(scope, request.serviceWorker()),\n      url: request.url(),\n      resourceType: request.resourceType(),\n      method: request.method(),\n      postData: postData === null ? undefined : postData,\n      headers: request.headers(),\n      isNavigationRequest: request.isNavigationRequest(),\n      redirectedFrom: RequestDispatcher.fromNullable(scope, request.redirectedFrom()),\n    });\n    this._type_Request = true;\n    this._browserContextDispatcher = scope;\n  }\n\n  async rawRequestHeaders(params?: channels.RequestRawRequestHeadersParams): Promise<channels.RequestRawRequestHeadersResult> {\n    return { headers: await this._object.rawRequestHeaders() };\n  }\n\n  async response(): Promise<channels.RequestResponseResult> {\n    return { response: ResponseDispatcher.fromNullable(this._browserContextDispatcher, await this._object.response()) };\n  }\n}\n\nexport class ResponseDispatcher extends Dispatcher<Response, channels.ResponseChannel, RequestDispatcher> implements channels.ResponseChannel {\n  _type_Response = true;\n\n  static from(scope: BrowserContextDispatcher, response: Response): ResponseDispatcher {\n    const result = existingDispatcher<ResponseDispatcher>(response);\n    const requestDispatcher = RequestDispatcher.from(scope, response.request());\n    return result || new ResponseDispatcher(requestDispatcher, response);\n  }\n\n  static fromNullable(scope: BrowserContextDispatcher, response: Response | null): ResponseDispatcher | undefined {\n    return response ? ResponseDispatcher.from(scope, response) : undefined;\n  }\n\n  private constructor(scope: RequestDispatcher, response: Response) {\n    super(scope, response, 'Response', {\n      // TODO: responses in popups can point to non-reported requests.\n      request: scope,\n      url: response.url(),\n      status: response.status(),\n      statusText: response.statusText(),\n      headers: response.headers(),\n      timing: response.timing(),\n      fromServiceWorker: response.fromServiceWorker(),\n    });\n  }\n\n  async body(): Promise<channels.ResponseBodyResult> {\n    return { binary: await this._object.body() };\n  }\n\n  async securityDetails(): Promise<channels.ResponseSecurityDetailsResult> {\n    return { value: await this._object.securityDetails() || undefined };\n  }\n\n  async serverAddr(): Promise<channels.ResponseServerAddrResult> {\n    return { value: await this._object.serverAddr() || undefined };\n  }\n\n  async rawResponseHeaders(params?: channels.ResponseRawResponseHeadersParams): Promise<channels.ResponseRawResponseHeadersResult> {\n    return { headers: await this._object.rawResponseHeaders() };\n  }\n\n  async sizes(params?: channels.ResponseSizesParams): Promise<channels.ResponseSizesResult> {\n    return { sizes: await this._object.sizes() };\n  }\n}\n\nexport class RouteDispatcher extends Dispatcher<Route, channels.RouteChannel, RequestDispatcher> implements channels.RouteChannel {\n  _type_Route = true;\n\n  static from(scope: RequestDispatcher, route: Route): RouteDispatcher {\n    const result = existingDispatcher<RouteDispatcher>(route);\n    return result || new RouteDispatcher(scope, route);\n  }\n\n  private constructor(scope: RequestDispatcher, route: Route) {\n    super(scope, route, 'Route', {\n      // Context route can point to a non-reported request, so we send the request in the initializer.\n      request: scope\n    });\n  }\n\n  async continue(params: channels.RouteContinueParams, metadata: CallMetadata): Promise<channels.RouteContinueResult> {\n    await this._object.continue({\n      url: params.url,\n      method: params.method,\n      headers: params.headers,\n      postData: params.postData,\n      isFallback: params.isFallback,\n    });\n  }\n\n  async fulfill(params: channels.RouteFulfillParams, metadata: CallMetadata): Promise<void> {\n    await this._object.fulfill(params);\n  }\n\n  async abort(params: channels.RouteAbortParams, metadata: CallMetadata): Promise<void> {\n    await this._object.abort(params.errorCode || 'failed');\n  }\n\n  async redirectNavigationRequest(params: channels.RouteRedirectNavigationRequestParams): Promise<void> {\n    await this._object.redirectNavigationRequest(params.url);\n  }\n}\n\nexport class WebSocketDispatcher extends Dispatcher<WebSocket, channels.WebSocketChannel, PageDispatcher> implements channels.WebSocketChannel {\n  _type_EventTarget = true;\n  _type_WebSocket = true;\n\n  constructor(scope: PageDispatcher, webSocket: WebSocket) {\n    super(scope, webSocket, 'WebSocket', {\n      url: webSocket.url(),\n    });\n    this.addObjectListener(WebSocket.Events.FrameSent, (event: { opcode: number, data: string }) => this._dispatchEvent('frameSent', event));\n    this.addObjectListener(WebSocket.Events.FrameReceived, (event: { opcode: number, data: string }) => this._dispatchEvent('frameReceived', event));\n    this.addObjectListener(WebSocket.Events.SocketError, (error: string) => this._dispatchEvent('socketError', { error }));\n    this.addObjectListener(WebSocket.Events.Close, () => this._dispatchEvent('close', {}));\n  }\n}\n\nexport class APIRequestContextDispatcher extends Dispatcher<APIRequestContext, channels.APIRequestContextChannel, RootDispatcher | BrowserContextDispatcher> implements channels.APIRequestContextChannel {\n  _type_APIRequestContext = true;\n\n  static from(scope: RootDispatcher | BrowserContextDispatcher, request: APIRequestContext): APIRequestContextDispatcher {\n    const result = existingDispatcher<APIRequestContextDispatcher>(request);\n    return result || new APIRequestContextDispatcher(scope, request);\n  }\n\n  static fromNullable(scope: RootDispatcher | BrowserContextDispatcher, request: APIRequestContext | null): APIRequestContextDispatcher | undefined {\n    return request ? APIRequestContextDispatcher.from(scope, request) : undefined;\n  }\n\n  private constructor(parentScope: RootDispatcher | BrowserContextDispatcher, request: APIRequestContext) {\n    // We will reparent these to the context below.\n    const tracing = TracingDispatcher.from(parentScope as any as APIRequestContextDispatcher, request.tracing());\n\n    super(parentScope, request, 'APIRequestContext', {\n      tracing,\n    });\n\n    this.adopt(tracing);\n  }\n\n  async storageState(): Promise<channels.APIRequestContextStorageStateResult> {\n    return this._object.storageState();\n  }\n\n  async dispose(params: channels.APIRequestContextDisposeParams, metadata: CallMetadata): Promise<void> {\n    metadata.potentiallyClosesScope = true;\n    await this._object.dispose(params);\n    this._dispose();\n  }\n\n  async fetch(params: channels.APIRequestContextFetchParams, metadata: CallMetadata): Promise<channels.APIRequestContextFetchResult> {\n    const fetchResponse = await this._object.fetch(params, metadata);\n    return {\n      response: {\n        url: fetchResponse.url,\n        status: fetchResponse.status,\n        statusText: fetchResponse.statusText,\n        headers: fetchResponse.headers,\n        fetchUid: fetchResponse.fetchUid\n      }\n    };\n  }\n\n  async fetchResponseBody(params: channels.APIRequestContextFetchResponseBodyParams): Promise<channels.APIRequestContextFetchResponseBodyResult> {\n    return { binary: this._object.fetchResponses.get(params.fetchUid) };\n  }\n\n  async fetchLog(params: channels.APIRequestContextFetchLogParams): Promise<channels.APIRequestContextFetchLogResult> {\n    const log = this._object.fetchLog.get(params.fetchUid) || [];\n    return { log };\n  }\n\n  async disposeAPIResponse(params: channels.APIRequestContextDisposeAPIResponseParams): Promise<void> {\n    this._object.disposeResponse(params.fetchUid);\n  }\n}\n"],"mappings":";;;;;;AAoBA,IAAAA,QAAA,GAAAC,OAAA;AAEA,IAAAC,WAAA,GAAAD,OAAA;AACA,IAAAE,kBAAA,GAAAF,OAAA;AAGA,IAAAG,gBAAA,GAAAH,OAAA;AACA,IAAAI,eAAA,GAAAJ,OAAA;AA3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAeO,MAAMK,iBAAiB,SAASC,sBAAU,CAAmI;EAIlL,OAAOC,IAAIA,CAACC,KAA+B,EAAEC,OAAgB,EAAqB;IAChF,MAAMC,MAAM,GAAG,IAAAC,8BAAkB,EAAoBF,OAAO,CAAC;IAC7D,OAAOC,MAAM,IAAI,IAAIL,iBAAiB,CAACG,KAAK,EAAEC,OAAO,CAAC;EACxD;EAEA,OAAOG,YAAYA,CAACJ,KAA+B,EAAEC,OAAuB,EAAiC;IAC3G,OAAOA,OAAO,GAAGJ,iBAAiB,CAACE,IAAI,CAACC,KAAK,EAAEC,OAAO,CAAC,GAAGI,SAAS;EACrE;EAEQC,WAAWA,CAACN,KAA+B,EAAEC,OAAgB,EAAE;IAAA,IAAAM,cAAA;IACrE,MAAMC,QAAQ,GAAGP,OAAO,CAACQ,cAAc,CAAC,CAAC;IACzC;IACA,MAAMC,KAAK,GAAGT,OAAO,CAACS,KAAK,CAAC,CAAC;IAC7B,MAAMC,IAAI,IAAAJ,cAAA,GAAGN,OAAO,CAACS,KAAK,CAAC,CAAC,cAAAH,cAAA,uBAAfA,cAAA,CAAiBK,KAAK;IACnC,MAAMC,cAAc,GAAGF,IAAI,GAAG,IAAAR,8BAAkB,EAAiBQ,IAAI,CAAC,GAAG,IAAI;IAC7E,MAAMG,eAAe,GAAGJ,KAAK,GAAGK,gCAAe,CAAChB,IAAI,CAACC,KAAK,EAAEU,KAAK,CAAC,GAAG,IAAI;IACzE,KAAK,CAACG,cAAc,IAAIC,eAAe,IAAId,KAAK,EAAEC,OAAO,EAAE,SAAS,EAAE;MACpES,KAAK,EAAEK,gCAAe,CAACX,YAAY,CAACJ,KAAK,EAAEC,OAAO,CAACS,KAAK,CAAC,CAAC,CAAC;MAC3DM,aAAa,EAAEC,gCAAgB,CAACb,YAAY,CAACJ,KAAK,EAAEC,OAAO,CAACe,aAAa,CAAC,CAAC,CAAC;MAC5EE,GAAG,EAAEjB,OAAO,CAACiB,GAAG,CAAC,CAAC;MAClBC,YAAY,EAAElB,OAAO,CAACkB,YAAY,CAAC,CAAC;MACpCC,MAAM,EAAEnB,OAAO,CAACmB,MAAM,CAAC,CAAC;MACxBZ,QAAQ,EAAEA,QAAQ,KAAK,IAAI,GAAGH,SAAS,GAAGG,QAAQ;MAClDa,OAAO,EAAEpB,OAAO,CAACoB,OAAO,CAAC,CAAC;MAC1BC,mBAAmB,EAAErB,OAAO,CAACqB,mBAAmB,CAAC,CAAC;MAClDC,cAAc,EAAE1B,iBAAiB,CAACO,YAAY,CAACJ,KAAK,EAAEC,OAAO,CAACsB,cAAc,CAAC,CAAC;IAChF,CAAC,CAAC;IAAC,KA7BLC,aAAa;IAAA,KACLC,yBAAyB;IA6B/B,IAAI,CAACD,aAAa,GAAG,IAAI;IACzB,IAAI,CAACC,yBAAyB,GAAGzB,KAAK;EACxC;EAEA,MAAM0B,iBAAiBA,CAACC,MAAgD,EAAoD;IAC1H,OAAO;MAAEN,OAAO,EAAE,MAAM,IAAI,CAACO,OAAO,CAACF,iBAAiB,CAAC;IAAE,CAAC;EAC5D;EAEA,MAAMG,QAAQA,CAAA,EAA4C;IACxD,OAAO;MAAEA,QAAQ,EAAEC,kBAAkB,CAAC1B,YAAY,CAAC,IAAI,CAACqB,yBAAyB,EAAE,MAAM,IAAI,CAACG,OAAO,CAACC,QAAQ,CAAC,CAAC;IAAE,CAAC;EACrH;AACF;AAACE,OAAA,CAAAlC,iBAAA,GAAAA,iBAAA;AAEM,MAAMiC,kBAAkB,SAAShC,sBAAU,CAA4F;EAG5I,OAAOC,IAAIA,CAACC,KAA+B,EAAE6B,QAAkB,EAAsB;IACnF,MAAM3B,MAAM,GAAG,IAAAC,8BAAkB,EAAqB0B,QAAQ,CAAC;IAC/D,MAAMG,iBAAiB,GAAGnC,iBAAiB,CAACE,IAAI,CAACC,KAAK,EAAE6B,QAAQ,CAAC5B,OAAO,CAAC,CAAC,CAAC;IAC3E,OAAOC,MAAM,IAAI,IAAI4B,kBAAkB,CAACE,iBAAiB,EAAEH,QAAQ,CAAC;EACtE;EAEA,OAAOzB,YAAYA,CAACJ,KAA+B,EAAE6B,QAAyB,EAAkC;IAC9G,OAAOA,QAAQ,GAAGC,kBAAkB,CAAC/B,IAAI,CAACC,KAAK,EAAE6B,QAAQ,CAAC,GAAGxB,SAAS;EACxE;EAEQC,WAAWA,CAACN,KAAwB,EAAE6B,QAAkB,EAAE;IAChE,KAAK,CAAC7B,KAAK,EAAE6B,QAAQ,EAAE,UAAU,EAAE;MACjC;MACA5B,OAAO,EAAED,KAAK;MACdkB,GAAG,EAAEW,QAAQ,CAACX,GAAG,CAAC,CAAC;MACnBe,MAAM,EAAEJ,QAAQ,CAACI,MAAM,CAAC,CAAC;MACzBC,UAAU,EAAEL,QAAQ,CAACK,UAAU,CAAC,CAAC;MACjCb,OAAO,EAAEQ,QAAQ,CAACR,OAAO,CAAC,CAAC;MAC3Bc,MAAM,EAAEN,QAAQ,CAACM,MAAM,CAAC,CAAC;MACzBC,iBAAiB,EAAEP,QAAQ,CAACO,iBAAiB,CAAC;IAChD,CAAC,CAAC;IAAC,KAtBLC,cAAc,GAAG,IAAI;EAuBrB;EAEA,MAAMC,IAAIA,CAAA,EAAyC;IACjD,OAAO;MAAEC,MAAM,EAAE,MAAM,IAAI,CAACX,OAAO,CAACU,IAAI,CAAC;IAAE,CAAC;EAC9C;EAEA,MAAME,eAAeA,CAAA,EAAoD;IACvE,OAAO;MAAEC,KAAK,EAAE,OAAM,IAAI,CAACb,OAAO,CAACY,eAAe,CAAC,CAAC,KAAInC;IAAU,CAAC;EACrE;EAEA,MAAMqC,UAAUA,CAAA,EAA+C;IAC7D,OAAO;MAAED,KAAK,EAAE,OAAM,IAAI,CAACb,OAAO,CAACc,UAAU,CAAC,CAAC,KAAIrC;IAAU,CAAC;EAChE;EAEA,MAAMsC,kBAAkBA,CAAChB,MAAkD,EAAsD;IAC/H,OAAO;MAAEN,OAAO,EAAE,MAAM,IAAI,CAACO,OAAO,CAACe,kBAAkB,CAAC;IAAE,CAAC;EAC7D;EAEA,MAAMC,KAAKA,CAACjB,MAAqC,EAAyC;IACxF,OAAO;MAAEiB,KAAK,EAAE,MAAM,IAAI,CAAChB,OAAO,CAACgB,KAAK,CAAC;IAAE,CAAC;EAC9C;AACF;AAACb,OAAA,CAAAD,kBAAA,GAAAA,kBAAA;AAEM,MAAMe,eAAe,SAAS/C,sBAAU,CAAmF;EAGhI,OAAOC,IAAIA,CAACC,KAAwB,EAAE8C,KAAY,EAAmB;IACnE,MAAM5C,MAAM,GAAG,IAAAC,8BAAkB,EAAkB2C,KAAK,CAAC;IACzD,OAAO5C,MAAM,IAAI,IAAI2C,eAAe,CAAC7C,KAAK,EAAE8C,KAAK,CAAC;EACpD;EAEQxC,WAAWA,CAACN,KAAwB,EAAE8C,KAAY,EAAE;IAC1D,KAAK,CAAC9C,KAAK,EAAE8C,KAAK,EAAE,OAAO,EAAE;MAC3B;MACA7C,OAAO,EAAED;IACX,CAAC,CAAC;IAAC,KAXL+C,WAAW,GAAG,IAAI;EAYlB;EAEA,MAAMC,QAAQA,CAACrB,MAAoC,EAAEsB,QAAsB,EAAyC;IAClH,MAAM,IAAI,CAACrB,OAAO,CAACoB,QAAQ,CAAC;MAC1B9B,GAAG,EAAES,MAAM,CAACT,GAAG;MACfE,MAAM,EAAEO,MAAM,CAACP,MAAM;MACrBC,OAAO,EAAEM,MAAM,CAACN,OAAO;MACvBb,QAAQ,EAAEmB,MAAM,CAACnB,QAAQ;MACzB0C,UAAU,EAAEvB,MAAM,CAACuB;IACrB,CAAC,CAAC;EACJ;EAEA,MAAMC,OAAOA,CAACxB,MAAmC,EAAEsB,QAAsB,EAAiB;IACxF,MAAM,IAAI,CAACrB,OAAO,CAACuB,OAAO,CAACxB,MAAM,CAAC;EACpC;EAEA,MAAMyB,KAAKA,CAACzB,MAAiC,EAAEsB,QAAsB,EAAiB;IACpF,MAAM,IAAI,CAACrB,OAAO,CAACwB,KAAK,CAACzB,MAAM,CAAC0B,SAAS,IAAI,QAAQ,CAAC;EACxD;EAEA,MAAMC,yBAAyBA,CAAC3B,MAAqD,EAAiB;IACpG,MAAM,IAAI,CAACC,OAAO,CAAC0B,yBAAyB,CAAC3B,MAAM,CAACT,GAAG,CAAC;EAC1D;AACF;AAACa,OAAA,CAAAc,eAAA,GAAAA,eAAA;AAEM,MAAMU,mBAAmB,SAASzD,sBAAU,CAA4F;EAI7IQ,WAAWA,CAACN,KAAqB,EAAEwD,SAAoB,EAAE;IACvD,KAAK,CAACxD,KAAK,EAAEwD,SAAS,EAAE,WAAW,EAAE;MACnCtC,GAAG,EAAEsC,SAAS,CAACtC,GAAG,CAAC;IACrB,CAAC,CAAC;IAAC,KANLuC,iBAAiB,GAAG,IAAI;IAAA,KACxBC,eAAe,GAAG,IAAI;IAMpB,IAAI,CAACC,iBAAiB,CAACC,kBAAS,CAACC,MAAM,CAACC,SAAS,EAAGC,KAAuC,IAAK,IAAI,CAACC,cAAc,CAAC,WAAW,EAAED,KAAK,CAAC,CAAC;IACxI,IAAI,CAACJ,iBAAiB,CAACC,kBAAS,CAACC,MAAM,CAACI,aAAa,EAAGF,KAAuC,IAAK,IAAI,CAACC,cAAc,CAAC,eAAe,EAAED,KAAK,CAAC,CAAC;IAChJ,IAAI,CAACJ,iBAAiB,CAACC,kBAAS,CAACC,MAAM,CAACK,WAAW,EAAGC,KAAa,IAAK,IAAI,CAACH,cAAc,CAAC,aAAa,EAAE;MAAEG;IAAM,CAAC,CAAC,CAAC;IACtH,IAAI,CAACR,iBAAiB,CAACC,kBAAS,CAACC,MAAM,CAACO,KAAK,EAAE,MAAM,IAAI,CAACJ,cAAc,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,CAAC;EACxF;AACF;AAACjC,OAAA,CAAAwB,mBAAA,GAAAA,mBAAA;AAEM,MAAMc,2BAA2B,SAASvE,sBAAU,CAA+I;EAGxM,OAAOC,IAAIA,CAACC,KAAgD,EAAEC,OAA0B,EAA+B;IACrH,MAAMC,MAAM,GAAG,IAAAC,8BAAkB,EAA8BF,OAAO,CAAC;IACvE,OAAOC,MAAM,IAAI,IAAImE,2BAA2B,CAACrE,KAAK,EAAEC,OAAO,CAAC;EAClE;EAEA,OAAOG,YAAYA,CAACJ,KAAgD,EAAEC,OAAiC,EAA2C;IAChJ,OAAOA,OAAO,GAAGoE,2BAA2B,CAACtE,IAAI,CAACC,KAAK,EAAEC,OAAO,CAAC,GAAGI,SAAS;EAC/E;EAEQC,WAAWA,CAACgE,WAAsD,EAAErE,OAA0B,EAAE;IACtG;IACA,MAAMsE,OAAO,GAAGC,oCAAiB,CAACzE,IAAI,CAACuE,WAAW,EAAwCrE,OAAO,CAACsE,OAAO,CAAC,CAAC,CAAC;IAE5G,KAAK,CAACD,WAAW,EAAErE,OAAO,EAAE,mBAAmB,EAAE;MAC/CsE;IACF,CAAC,CAAC;IAAC,KAjBLE,uBAAuB,GAAG,IAAI;IAmB5B,IAAI,CAACC,KAAK,CAACH,OAAO,CAAC;EACrB;EAEA,MAAMI,YAAYA,CAAA,EAA0D;IAC1E,OAAO,IAAI,CAAC/C,OAAO,CAAC+C,YAAY,CAAC,CAAC;EACpC;EAEA,MAAMC,OAAOA,CAACjD,MAA+C,EAAEsB,QAAsB,EAAiB;IACpGA,QAAQ,CAAC4B,sBAAsB,GAAG,IAAI;IACtC,MAAM,IAAI,CAACjD,OAAO,CAACgD,OAAO,CAACjD,MAAM,CAAC;IAClC,IAAI,CAACmD,QAAQ,CAAC,CAAC;EACjB;EAEA,MAAMC,KAAKA,CAACpD,MAA6C,EAAEsB,QAAsB,EAAkD;IACjI,MAAM+B,aAAa,GAAG,MAAM,IAAI,CAACpD,OAAO,CAACmD,KAAK,CAACpD,MAAM,EAAEsB,QAAQ,CAAC;IAChE,OAAO;MACLpB,QAAQ,EAAE;QACRX,GAAG,EAAE8D,aAAa,CAAC9D,GAAG;QACtBe,MAAM,EAAE+C,aAAa,CAAC/C,MAAM;QAC5BC,UAAU,EAAE8C,aAAa,CAAC9C,UAAU;QACpCb,OAAO,EAAE2D,aAAa,CAAC3D,OAAO;QAC9B4D,QAAQ,EAAED,aAAa,CAACC;MAC1B;IACF,CAAC;EACH;EAEA,MAAMC,iBAAiBA,CAACvD,MAAyD,EAA8D;IAC7I,OAAO;MAAEY,MAAM,EAAE,IAAI,CAACX,OAAO,CAACuD,cAAc,CAACC,GAAG,CAACzD,MAAM,CAACsD,QAAQ;IAAE,CAAC;EACrE;EAEA,MAAMI,QAAQA,CAAC1D,MAAgD,EAAqD;IAClH,MAAM2D,GAAG,GAAG,IAAI,CAAC1D,OAAO,CAACyD,QAAQ,CAACD,GAAG,CAACzD,MAAM,CAACsD,QAAQ,CAAC,IAAI,EAAE;IAC5D,OAAO;MAAEK;IAAI,CAAC;EAChB;EAEA,MAAMC,kBAAkBA,CAAC5D,MAA0D,EAAiB;IAClG,IAAI,CAACC,OAAO,CAAC4D,eAAe,CAAC7D,MAAM,CAACsD,QAAQ,CAAC;EAC/C;AACF;AAAClD,OAAA,CAAAsC,2BAAA,GAAAA,2BAAA"}