{"version":3,"file":"dialog.js","names":["_utils","require","_instrumentation","Dialog","SdkObject","constructor","page","type","message","onHandle","defaultValue","_page","_type","_message","_onHandle","_handled","_defaultValue","_frameManager","dialogDidOpen","accept","promptText","assert","dialogWillClose","dismiss","close","exports"],"sources":["../../src/server/dialog.ts"],"sourcesContent":["/**\n * Copyright 2017 Google Inc. All rights reserved.\n * Modifications copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '../utils';\nimport type { Page } from './page';\nimport { SdkObject } from './instrumentation';\n\ntype OnHandle = (accept: boolean, promptText?: string) => Promise<void>;\n\nexport type DialogType = 'alert' | 'beforeunload' | 'confirm' | 'prompt';\n\nexport class Dialog extends SdkObject {\n  private _page: Page;\n  private _type: DialogType;\n  private _message: string;\n  private _onHandle: OnHandle;\n  private _handled = false;\n  private _defaultValue: string;\n\n  constructor(page: Page, type: DialogType, message: string, onHandle: OnHandle, defaultValue?: string) {\n    super(page, 'dialog');\n    this._page = page;\n    this._type = type;\n    this._message = message;\n    this._onHandle = onHandle;\n    this._defaultValue = defaultValue || '';\n    this._page._frameManager.dialogDidOpen(this);\n  }\n\n  page() {\n    return this._page;\n  }\n\n  type(): string {\n    return this._type;\n  }\n\n  message(): string {\n    return this._message;\n  }\n\n  defaultValue(): string {\n    return this._defaultValue;\n  }\n\n  async accept(promptText?: string) {\n    assert(!this._handled, 'Cannot accept dialog which is already handled!');\n    this._handled = true;\n    this._page._frameManager.dialogWillClose(this);\n    await this._onHandle(true, promptText);\n  }\n\n  async dismiss() {\n    assert(!this._handled, 'Cannot dismiss dialog which is already handled!');\n    this._handled = true;\n    this._page._frameManager.dialogWillClose(this);\n    await this._onHandle(false);\n  }\n\n  async close() {\n    if (this._type === 'beforeunload')\n      await this.accept();\n    else\n      await this.dismiss();\n  }\n}\n"],"mappings":";;;;;;AAiBA,IAAAA,MAAA,GAAAC,OAAA;AAEA,IAAAC,gBAAA,GAAAD,OAAA;AAnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAUO,MAAME,MAAM,SAASC,0BAAS,CAAC;EAQpCC,WAAWA,CAACC,IAAU,EAAEC,IAAgB,EAAEC,OAAe,EAAEC,QAAkB,EAAEC,YAAqB,EAAE;IACpG,KAAK,CAACJ,IAAI,EAAE,QAAQ,CAAC;IAAC,KARhBK,KAAK;IAAA,KACLC,KAAK;IAAA,KACLC,QAAQ;IAAA,KACRC,SAAS;IAAA,KACTC,QAAQ,GAAG,KAAK;IAAA,KAChBC,aAAa;IAInB,IAAI,CAACL,KAAK,GAAGL,IAAI;IACjB,IAAI,CAACM,KAAK,GAAGL,IAAI;IACjB,IAAI,CAACM,QAAQ,GAAGL,OAAO;IACvB,IAAI,CAACM,SAAS,GAAGL,QAAQ;IACzB,IAAI,CAACO,aAAa,GAAGN,YAAY,IAAI,EAAE;IACvC,IAAI,CAACC,KAAK,CAACM,aAAa,CAACC,aAAa,CAAC,IAAI,CAAC;EAC9C;EAEAZ,IAAIA,CAAA,EAAG;IACL,OAAO,IAAI,CAACK,KAAK;EACnB;EAEAJ,IAAIA,CAAA,EAAW;IACb,OAAO,IAAI,CAACK,KAAK;EACnB;EAEAJ,OAAOA,CAAA,EAAW;IAChB,OAAO,IAAI,CAACK,QAAQ;EACtB;EAEAH,YAAYA,CAAA,EAAW;IACrB,OAAO,IAAI,CAACM,aAAa;EAC3B;EAEA,MAAMG,MAAMA,CAACC,UAAmB,EAAE;IAChC,IAAAC,aAAM,EAAC,CAAC,IAAI,CAACN,QAAQ,EAAE,gDAAgD,CAAC;IACxE,IAAI,CAACA,QAAQ,GAAG,IAAI;IACpB,IAAI,CAACJ,KAAK,CAACM,aAAa,CAACK,eAAe,CAAC,IAAI,CAAC;IAC9C,MAAM,IAAI,CAACR,SAAS,CAAC,IAAI,EAAEM,UAAU,CAAC;EACxC;EAEA,MAAMG,OAAOA,CAAA,EAAG;IACd,IAAAF,aAAM,EAAC,CAAC,IAAI,CAACN,QAAQ,EAAE,iDAAiD,CAAC;IACzE,IAAI,CAACA,QAAQ,GAAG,IAAI;IACpB,IAAI,CAACJ,KAAK,CAACM,aAAa,CAACK,eAAe,CAAC,IAAI,CAAC;IAC9C,MAAM,IAAI,CAACR,SAAS,CAAC,KAAK,CAAC;EAC7B;EAEA,MAAMU,KAAKA,CAAA,EAAG;IACZ,IAAI,IAAI,CAACZ,KAAK,KAAK,cAAc,EAC/B,MAAM,IAAI,CAACO,MAAM,CAAC,CAAC,CAAC,KAEpB,MAAM,IAAI,CAACI,OAAO,CAAC,CAAC;EACxB;AACF;AAACE,OAAA,CAAAtB,MAAA,GAAAA,MAAA"}