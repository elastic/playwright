{"version":3,"file":"wkBrowser.js","names":["_browser","require","_browserContext","_utils","network","_interopRequireWildcard","_wkConnection","_wkPage","_errors","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","DEFAULT_USER_AGENT","BROWSER_VERSION","WKBrowser","Browser","connect","parent","transport","options","browser","__testHookOnConnectToBrowser","promises","_browserSession","send","persistent","_options$persistent","userAgent","_defaultContext","WKBrowserContext","undefined","push","_initialize","Promise","all","constructor","_connection","_contexts","Map","_wkPages","WKConnection","_onDisconnect","bind","protocolLogger","browserLogsCollector","browserSession","on","_onPageProxyCreated","_onPageProxyDestroyed","event","_onProvisionalLoadFailed","_onWindowOpen","_onDownloadCreated","_onDownloadFilenameSuggested","_onDownloadFinished","_onScreencastFinished","kPageProxyMessageReceived","_onPageProxyMessageReceived","wkPage","values","didClose","clear","video","_idToVideo","artifact","reportFinished","TargetClosedError","_didClose","doCreateNewContext","createOptions","proxy","proxyServer","process","platform","server","replace","proxyBypassList","bypass","browserContextId","context","contexts","Array","from","version","payload","page","pageProxyId","_page","_frameManager","frameAbortedNavigation","frameId","originPage","_initializedPage","_firstNonInitialNavigationCommittedReject","Error","_opener","_downloadCreated","uuid","url","_downloadFilenameSuggested","suggestedFilename","_downloadFinished","error","_this$_takeVideo","_takeVideo","screencastId","pageProxySession","WKSession","message","rawSend","opener","openerId","WKPage","delete","dispatchMessageToSession","handleProvisionalLoadFailed","handleWindowOpen","isConnected","isClosed","exports","BrowserContext","_validateEmulatedViewport","viewport","_authenticateProxyViaHeader","assert","length","_browserContextId","behavior","_options","acceptDownloads","downloadPath","downloadsPath","ignoreHTTPSErrors","ignore","locale","languages","geolocation","setGeolocation","offline","setOffline","httpCredentials","setHTTPCredentials","filter","pages","map","pageOrNull","newPageDelegate","assertBrowserContextIsNotOwned","doGetCookies","urls","cookies","filterCookies","c","copy","expires","session","addCookies","cc","rewriteCookies","doClearCookies","doGrantPermissions","origin","permissions","_delegate","_grantPermissions","doClearPermissions","_clearPermissions","verifyGeolocation","timestamp","Date","now","setExtraHTTPHeaders","headers","extraHTTPHeaders","updateExtraHTTPHeaders","setUserAgent","updateUserAgent","updateOffline","doSetHTTPCredentials","updateHttpCredentials","doAddInitScript","initScript","_updateBootstrapScript","doRemoveNonInternalInitScripts","doUpdateRequestInterception","updateRequestInterception","onClosePersistent","clearCache","doClose","reason","_stopVideo","close","cancelDownload","viewportSize","headful","width","height"],"sources":["../../../src/server/webkit/wkBrowser.ts"],"sourcesContent":["/**\n * Copyright 2017 Google Inc. All rights reserved.\n * Modifications copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { BrowserOptions } from '../browser';\nimport { Browser } from '../browser';\nimport { assertBrowserContextIsNotOwned, BrowserContext, verifyGeolocation } from '../browserContext';\nimport { assert } from '../../utils';\nimport * as network from '../network';\nimport type { InitScript, Page, PageDelegate } from '../page';\nimport type { ConnectionTransport } from '../transport';\nimport type * as types from '../types';\nimport type * as channels from '@protocol/channels';\nimport type { Protocol } from './protocol';\nimport type { PageProxyMessageReceivedPayload } from './wkConnection';\nimport { kPageProxyMessageReceived, WKConnection, WKSession } from './wkConnection';\nimport { WKPage } from './wkPage';\nimport { TargetClosedError } from '../errors';\nimport type { SdkObject } from '../instrumentation';\n\nconst DEFAULT_USER_AGENT = 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.0 Safari/605.1.15';\nconst BROWSER_VERSION = '18.0';\n\nexport class WKBrowser extends Browser {\n  private readonly _connection: WKConnection;\n  readonly _browserSession: WKSession;\n  readonly _contexts = new Map<string, WKBrowserContext>();\n  readonly _wkPages = new Map<string, WKPage>();\n\n  static async connect(parent: SdkObject, transport: ConnectionTransport, options: BrowserOptions): Promise<WKBrowser> {\n    const browser = new WKBrowser(parent, transport, options);\n    if ((options as any).__testHookOnConnectToBrowser)\n      await (options as any).__testHookOnConnectToBrowser();\n    const promises: Promise<any>[] = [\n      browser._browserSession.send('Playwright.enable'),\n    ];\n    if (options.persistent) {\n      options.persistent.userAgent ||= DEFAULT_USER_AGENT;\n      browser._defaultContext = new WKBrowserContext(browser, undefined, options.persistent);\n      promises.push((browser._defaultContext as WKBrowserContext)._initialize());\n    }\n    await Promise.all(promises);\n    return browser;\n  }\n\n  constructor(parent: SdkObject, transport: ConnectionTransport, options: BrowserOptions) {\n    super(parent, options);\n    this._connection = new WKConnection(transport, this._onDisconnect.bind(this), options.protocolLogger, options.browserLogsCollector);\n    this._browserSession = this._connection.browserSession;\n    this._browserSession.on('Playwright.pageProxyCreated', this._onPageProxyCreated.bind(this));\n    this._browserSession.on('Playwright.pageProxyDestroyed', this._onPageProxyDestroyed.bind(this));\n    this._browserSession.on('Playwright.provisionalLoadFailed', event => this._onProvisionalLoadFailed(event));\n    this._browserSession.on('Playwright.windowOpen', event => this._onWindowOpen(event));\n    this._browserSession.on('Playwright.downloadCreated', this._onDownloadCreated.bind(this));\n    this._browserSession.on('Playwright.downloadFilenameSuggested', this._onDownloadFilenameSuggested.bind(this));\n    this._browserSession.on('Playwright.downloadFinished', this._onDownloadFinished.bind(this));\n    this._browserSession.on('Playwright.screencastFinished', this._onScreencastFinished.bind(this));\n    this._browserSession.on(kPageProxyMessageReceived, this._onPageProxyMessageReceived.bind(this));\n  }\n\n  _onDisconnect() {\n    for (const wkPage of this._wkPages.values())\n      wkPage.didClose();\n    this._wkPages.clear();\n    for (const video of this._idToVideo.values())\n      video.artifact.reportFinished(new TargetClosedError());\n    this._idToVideo.clear();\n    this._didClose();\n  }\n\n  async doCreateNewContext(options: channels.BrowserNewContextParams): Promise<BrowserContext> {\n    const createOptions = options.proxy ? {\n      // Enable socks5 hostname resolution on Windows. Workaround can be removed once fixed upstream.\n      // See https://github.com/microsoft/playwright/issues/20451\n      proxyServer: process.platform === 'win32' ? options.proxy.server.replace(/^socks5:\\/\\//, 'socks5h://') : options.proxy.server,\n      proxyBypassList: options.proxy.bypass\n    } : undefined;\n    const { browserContextId } = await this._browserSession.send('Playwright.createContext', createOptions);\n    options.userAgent = options.userAgent || DEFAULT_USER_AGENT;\n    const context = new WKBrowserContext(this, browserContextId, options);\n    await context._initialize();\n    this._contexts.set(browserContextId, context);\n    return context;\n  }\n\n  contexts(): BrowserContext[] {\n    return Array.from(this._contexts.values());\n  }\n\n  version(): string {\n    return BROWSER_VERSION;\n  }\n\n  userAgent(): string {\n    return DEFAULT_USER_AGENT;\n  }\n\n  _onDownloadCreated(payload: Protocol.Playwright.downloadCreatedPayload) {\n    const page = this._wkPages.get(payload.pageProxyId);\n    if (!page)\n      return;\n    // In some cases, e.g. blob url download, we receive only frameScheduledNavigation\n    // but no signals that the navigation was canceled and replaced by download. Fix it\n    // here by simulating cancelled provisional load which matches downloads from network.\n    //\n    // TODO: this is racy, because download might be unrelated any navigation, and we will\n    // abort navigation that is still running. We should be able to fix this by\n    // instrumenting policy decision start/proceed/cancel.\n    page._page._frameManager.frameAbortedNavigation(payload.frameId, 'Download is starting');\n    let originPage = page._initializedPage;\n    // If it's a new window download, report it on the opener page.\n    if (!originPage) {\n      // Resume the page creation with an error. The page will automatically close right\n      // after the download begins.\n      page._firstNonInitialNavigationCommittedReject(new Error('Starting new page download'));\n      if (page._opener)\n        originPage = page._opener._initializedPage;\n    }\n    if (!originPage)\n      return;\n    this._downloadCreated(originPage, payload.uuid, payload.url);\n  }\n\n  _onDownloadFilenameSuggested(payload: Protocol.Playwright.downloadFilenameSuggestedPayload) {\n    this._downloadFilenameSuggested(payload.uuid, payload.suggestedFilename);\n  }\n\n  _onDownloadFinished(payload: Protocol.Playwright.downloadFinishedPayload) {\n    this._downloadFinished(payload.uuid, payload.error);\n  }\n\n  _onScreencastFinished(payload: Protocol.Playwright.screencastFinishedPayload) {\n    this._takeVideo(payload.screencastId)?.reportFinished();\n  }\n\n  _onPageProxyCreated(event: Protocol.Playwright.pageProxyCreatedPayload) {\n    const pageProxyId = event.pageProxyId;\n    let context: WKBrowserContext | null = null;\n    if (event.browserContextId) {\n      // FIXME: we don't know about the default context id, so assume that all targets from\n      // unknown contexts are created in the 'default' context which can in practice be represented\n      // by multiple actual contexts in WebKit. Solving this properly will require adding context\n      // lifecycle events.\n      context = this._contexts.get(event.browserContextId) || null;\n    }\n    if (!context)\n      context = this._defaultContext as WKBrowserContext;\n    if (!context)\n      return;\n    const pageProxySession = new WKSession(this._connection, pageProxyId, (message: any) => {\n      this._connection.rawSend({ ...message, pageProxyId });\n    });\n    const opener = event.openerId ? this._wkPages.get(event.openerId) : undefined;\n    const wkPage = new WKPage(context, pageProxySession, opener || null);\n    this._wkPages.set(pageProxyId, wkPage);\n  }\n\n  _onPageProxyDestroyed(event: Protocol.Playwright.pageProxyDestroyedPayload) {\n    const pageProxyId = event.pageProxyId;\n    const wkPage = this._wkPages.get(pageProxyId);\n    if (!wkPage)\n      return;\n    wkPage.didClose();\n    this._wkPages.delete(pageProxyId);\n  }\n\n  _onPageProxyMessageReceived(event: PageProxyMessageReceivedPayload) {\n    const wkPage = this._wkPages.get(event.pageProxyId);\n    if (!wkPage)\n      return;\n    wkPage.dispatchMessageToSession(event.message);\n  }\n\n  _onProvisionalLoadFailed(event: Protocol.Playwright.provisionalLoadFailedPayload) {\n    const wkPage = this._wkPages.get(event.pageProxyId);\n    if (!wkPage)\n      return;\n    wkPage.handleProvisionalLoadFailed(event);\n  }\n\n  _onWindowOpen(event: Protocol.Playwright.windowOpenPayload) {\n    const wkPage = this._wkPages.get(event.pageProxyId);\n    if (!wkPage)\n      return;\n    wkPage.handleWindowOpen(event);\n  }\n\n  isConnected(): boolean {\n    return !this._connection.isClosed();\n  }\n}\n\nexport class WKBrowserContext extends BrowserContext {\n  declare readonly _browser: WKBrowser;\n\n  constructor(browser: WKBrowser, browserContextId: string | undefined, options: channels.BrowserNewContextParams) {\n    super(browser, options, browserContextId);\n    this._validateEmulatedViewport(options.viewport);\n    this._authenticateProxyViaHeader();\n  }\n\n  override async _initialize() {\n    assert(!this._wkPages().length);\n    const browserContextId = this._browserContextId;\n    const promises: Promise<any>[] = [super._initialize()];\n    promises.push(this._browser._browserSession.send('Playwright.setDownloadBehavior', {\n      behavior: this._options.acceptDownloads === 'accept' ? 'allow' : 'deny',\n      downloadPath: this._browser.options.downloadsPath,\n      browserContextId\n    }));\n    if (this._options.ignoreHTTPSErrors)\n      promises.push(this._browser._browserSession.send('Playwright.setIgnoreCertificateErrors', { browserContextId, ignore: true }));\n    if (this._options.locale)\n      promises.push(this._browser._browserSession.send('Playwright.setLanguages', { browserContextId, languages: [this._options.locale] }));\n    if (this._options.geolocation)\n      promises.push(this.setGeolocation(this._options.geolocation));\n    if (this._options.offline)\n      promises.push(this.setOffline(this._options.offline));\n    if (this._options.httpCredentials)\n      promises.push(this.setHTTPCredentials(this._options.httpCredentials));\n    await Promise.all(promises);\n  }\n\n  _wkPages(): WKPage[] {\n    return Array.from(this._browser._wkPages.values()).filter(wkPage => wkPage._browserContext === this);\n  }\n\n  pages(): Page[] {\n    return this._wkPages().map(wkPage => wkPage._initializedPage).filter(pageOrNull => !!pageOrNull) as Page[];\n  }\n\n  async newPageDelegate(): Promise<PageDelegate> {\n    assertBrowserContextIsNotOwned(this);\n    const { pageProxyId } = await this._browser._browserSession.send('Playwright.createPage', { browserContextId: this._browserContextId });\n    return this._browser._wkPages.get(pageProxyId)!;\n  }\n\n  async doGetCookies(urls: string[]): Promise<channels.NetworkCookie[]> {\n    const { cookies } = await this._browser._browserSession.send('Playwright.getAllCookies', { browserContextId: this._browserContextId });\n    return network.filterCookies(cookies.map((c: channels.NetworkCookie) => {\n      const copy: any = { ... c };\n      copy.expires = c.expires === -1 ? -1 : c.expires / 1000;\n      delete copy.session;\n      return copy as channels.NetworkCookie;\n    }), urls);\n  }\n\n  async addCookies(cookies: channels.SetNetworkCookie[]) {\n    const cc = network.rewriteCookies(cookies).map(c => ({\n      ...c,\n      session: c.expires === -1 || c.expires === undefined,\n      expires: c.expires && c.expires !== -1 ? c.expires * 1000 : c.expires,\n    })) as Protocol.Playwright.SetCookieParam[];\n    await this._browser._browserSession.send('Playwright.setCookies', { cookies: cc, browserContextId: this._browserContextId });\n  }\n\n  async doClearCookies() {\n    await this._browser._browserSession.send('Playwright.deleteAllCookies', { browserContextId: this._browserContextId });\n  }\n\n  async doGrantPermissions(origin: string, permissions: string[]) {\n    await Promise.all(this.pages().map(page => (page._delegate as WKPage)._grantPermissions(origin, permissions)));\n  }\n\n  async doClearPermissions() {\n    await Promise.all(this.pages().map(page => (page._delegate as WKPage)._clearPermissions()));\n  }\n\n  async setGeolocation(geolocation?: types.Geolocation): Promise<void> {\n    verifyGeolocation(geolocation);\n    this._options.geolocation = geolocation;\n    const payload: any = geolocation ? { ...geolocation, timestamp: Date.now() } : undefined;\n    await this._browser._browserSession.send('Playwright.setGeolocationOverride', { browserContextId: this._browserContextId, geolocation: payload });\n  }\n\n  async setExtraHTTPHeaders(headers: types.HeadersArray): Promise<void> {\n    this._options.extraHTTPHeaders = headers;\n    for (const page of this.pages())\n      await (page._delegate as WKPage).updateExtraHTTPHeaders();\n  }\n\n  async setUserAgent(userAgent: string | undefined): Promise<void> {\n    this._options.userAgent = userAgent;\n    for (const page of this.pages())\n      await (page._delegate as WKPage).updateUserAgent();\n  }\n\n  async setOffline(offline: boolean): Promise<void> {\n    this._options.offline = offline;\n    for (const page of this.pages())\n      await (page._delegate as WKPage).updateOffline();\n  }\n\n  async doSetHTTPCredentials(httpCredentials?: types.Credentials): Promise<void> {\n    this._options.httpCredentials = httpCredentials;\n    for (const page of this.pages())\n      await (page._delegate as WKPage).updateHttpCredentials();\n  }\n\n  async doAddInitScript(initScript: InitScript) {\n    for (const page of this.pages())\n      await (page._delegate as WKPage)._updateBootstrapScript();\n  }\n\n  async doRemoveNonInternalInitScripts() {\n    for (const page of this.pages())\n      await (page._delegate as WKPage)._updateBootstrapScript();\n  }\n\n  async doUpdateRequestInterception(): Promise<void> {\n    for (const page of this.pages())\n      await (page._delegate as WKPage).updateRequestInterception();\n  }\n\n  onClosePersistent() {}\n\n  override async clearCache(): Promise<void> {\n    // We use ephemeral contexts so there is no disk cache.\n    await this._browser._browserSession.send('Playwright.clearMemoryCache', {\n      browserContextId: this._browserContextId!\n    });\n  }\n\n  async doClose(reason: string | undefined) {\n    if (!this._browserContextId) {\n      await Promise.all(this._wkPages().map(wkPage => wkPage._stopVideo()));\n      // Closing persistent context should close the browser.\n      await this._browser.close({ reason });\n    } else {\n      await this._browser._browserSession.send('Playwright.deleteContext', { browserContextId: this._browserContextId });\n      this._browser._contexts.delete(this._browserContextId);\n    }\n  }\n\n  async cancelDownload(uuid: string) {\n    await this._browser._browserSession.send('Playwright.cancelDownload', { uuid });\n  }\n\n  _validateEmulatedViewport(viewportSize?: types.Size | null) {\n    if (!viewportSize)\n      return;\n    if (process.platform === 'win32' && this._browser.options.headful && (viewportSize.width < 250 || viewportSize.height < 240))\n      throw new Error(`WebKit on Windows has a minimal viewport of 250x240.`);\n  }\n}\n"],"mappings":"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"}