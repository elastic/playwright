{"version":3,"file":"dom.js","names":["_fs","_interopRequireDefault","require","injectedScriptSource","_interopRequireWildcard","_protocolError","js","_progress","_utils","_fileUploadUtils","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","obj","NonRecoverableDOMError","Error","exports","isNonRecoverableDOMError","error","FrameExecutionContext","ExecutionContext","constructor","delegate","frame","world","_injectedScriptPromise","adoptIfNeeded","handle","ElementHandle","_context","_page","_delegate","adoptElementHandle","evaluate","pageFunction","arg","evaluateHandle","evaluateExpression","expression","options","returnByValue","evaluateExpressionHandle","createHandle","remoteObject","isElementHandle","objectId","injectedScript","custom","selectorsRegistry","context","selectors","name","source","_engines","push","sdkLanguage","attribution","playwright","isUnderTest","JSON","stringify","testIdAttributeName","rafCountForStablePosition","_browserContext","_browser","join","rawEvaluateHandle","then","JSHandle","undefined","__elementhandle","_frame","_initializePreview","catch","utility","_setPreview","injected","previewNode","asElement","evaluateInUtility","_utilityContext","isJavaScriptErrorInEvaluate","isSessionClosedError","evaluateHandleInUtility","ownerFrame","frameId","getOwnerFrame","_frameManager","page","pages","isIframeElement","node","nodeName","contentFrame","isFrameElement","throwRetargetableDOMError","getContentFrame","getAttribute","metadata","inputValue","textContent","innerText","innerHTML","dispatchEvent","type","eventInit","_scrollRectIntoViewIfNeeded","rect","scrollRectIntoViewIfNeeded","_waitAndScrollIntoViewIfNeeded","progress","waitForVisible","result","_retryAction","log","waitResult","checkElementStates","assertDone","scrollIntoViewIfNeeded","controller","ProgressController","run","_timeoutSettings","timeout","_clickablePoint","intersectQuadWithViewport","quad","map","point","x","Math","min","max","metrics","width","y","height","computeQuadArea","area","length","p1","p2","abs","quads","Promise","all","getContentQuads","mainFrame","innerWidth","innerHeight","filtered","filter","compensateHalfIntegerRoundingError","_offsetPoint","offset","box","border","boundingBox","getElementBorderWidth","left","top","actionName","action","retry","waitTime","isRunning","trial","f","setTimeout","skipLocatorHandlersCheckpoint","force","performLocatorHandlersCheckpoint","hitTargetDescription","missingState","_retryPointerAction","waitForEnabled","scrollOptions","block","inline","forceScrollOptions","_performPointerAction","position","doScrollIntoView","nodeType","scrollIntoView","parentFrame","throwIfAborted","__testHookBeforeStable","elementStates","__testHookAfterStable","scrolled","maybePoint","roundPoint","beforeInputAction","hitTargetInterceptionHandle","__testHookBeforeHitTarget","frameCheckResult","_checkFrameIsHitTarget","hitPoint","framePoint","actionType","setupHitTargetInterceptor","_objectId","rawValue","cleanupWhenAborted","h","stop","dispose","actionResult","waitForSignalsCreatedBy","waitAfter","__testHookBeforePointerAction","restoreModifiers","modifiers","keyboard","ensureModifiers","stopHitTargetInterception","raceAgainstEvaluationStallingEvents","finally","_hitTargetInterceptio","hitTargetResult","__testHookAfterPointerAction","hover","_hover","mouse","move","click","_click","noWaitAfter","dblclick","_dblclick","tap","_tap","touchscreen","selectOption","elements","values","_selectOption","resultingOptions","optionsToSelect","checkResult","selectOptions","Array","isArray","fill","value","_fill","insertText","press","selectText","setInputFiles","params","inputFileItems","prepareFilesForUpload","_setInputFiles","items","filePayloads","localPaths","localDirectory","multiple","directoryUpload","element","retarget","tagName","createStacklessError","inputElement","webkitdirectory","retargeted","localPathsOrDirectory","localPath","fs","promises","access","constants","F_OK","waitForInputEvent","fulfill","addEventListener","once","resolve","setInputFilePaths","focus","_focus","resetSelectionIfNotFocused","focusNode","_blur","blurNode","text","_type","key","_press","check","_setChecked","uncheck","state","isChecked","elementState","getBoundingBox","screenshot","_screenshotter","screenshotElement","querySelector","selector","query","querySelectorAll","queryAll","evalOnSelector","strict","isFunction","evalOnSelectorAll","isVisible","isHidden","isEnabled","isDisabled","isEditable","waitForElementState","waitForSelector","_adoptTo","adopted","data","frameElement","style","iframe","describeIFrameStyle","pointInFrame","expectHitTarget","remainderX","floor","remainderY","kUnableToAdoptErrorMessage"],"sources":["../../src/server/dom.ts"],"sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport fs from 'fs';\nimport type * as channels from '@protocol/channels';\nimport * as injectedScriptSource from '../generated/injectedScriptSource';\nimport { isSessionClosedError } from './protocolError';\nimport type { ScreenshotOptions } from './screenshotter';\nimport type * as frames from './frames';\nimport type { InjectedScript, HitTargetInterceptionResult, ElementState } from './injected/injectedScript';\nimport type { CallMetadata } from './instrumentation';\nimport * as js from './javascript';\nimport type { Page } from './page';\nimport type { Progress } from './progress';\nimport { ProgressController } from './progress';\nimport type * as types from './types';\nimport type { TimeoutOptions } from '../common/types';\nimport { isUnderTest } from '../utils';\nimport { prepareFilesForUpload } from './fileUploadUtils';\n\nexport type InputFilesItems = {\n  filePayloads?: types.FilePayload[],\n  localPaths?: string[]\n  localDirectory?: string\n};\n\ntype ActionName = 'click' | 'hover' | 'dblclick' | 'tap' | 'move and up' | 'move and down';\ntype PerformActionResult = 'error:notvisible' | 'error:notconnected' | 'error:notinviewport' | 'error:optionsnotfound' | { missingState: ElementState } | { hitTargetDescription: string } | 'done';\n\nexport class NonRecoverableDOMError extends Error {\n}\n\nexport function isNonRecoverableDOMError(error: Error) {\n  return error instanceof NonRecoverableDOMError;\n}\n\nexport class FrameExecutionContext extends js.ExecutionContext {\n  readonly frame: frames.Frame;\n  private _injectedScriptPromise?: Promise<js.JSHandle>;\n  readonly world: types.World;\n\n  constructor(delegate: js.ExecutionContextDelegate, frame: frames.Frame, world: types.World) {\n    super(frame, delegate, world || 'content-script');\n    this.frame = frame;\n    this.world = world;\n  }\n\n  override adoptIfNeeded(handle: js.JSHandle): Promise<js.JSHandle> | null {\n    if (handle instanceof ElementHandle && handle._context !== this)\n      return this.frame._page._delegate.adoptElementHandle(handle, this);\n    return null;\n  }\n\n  async evaluate<Arg, R>(pageFunction: js.Func1<Arg, R>, arg?: Arg): Promise<R> {\n    return js.evaluate(this, true /* returnByValue */, pageFunction, arg);\n  }\n\n  async evaluateHandle<Arg, R>(pageFunction: js.Func1<Arg, R>, arg?: Arg): Promise<js.SmartHandle<R>> {\n    return js.evaluate(this, false /* returnByValue */, pageFunction, arg);\n  }\n\n  async evaluateExpression(expression: string, options: { isFunction?: boolean }, arg?: any): Promise<any> {\n    return js.evaluateExpression(this, expression, { ...options, returnByValue: true }, arg);\n  }\n\n  async evaluateExpressionHandle(expression: string, options: { isFunction?: boolean }, arg?: any): Promise<js.JSHandle<any>> {\n    return js.evaluateExpression(this, expression, { ...options, returnByValue: false }, arg);\n  }\n\n  override createHandle(remoteObject: js.RemoteObject): js.JSHandle {\n    if (this.frame._page._delegate.isElementHandle(remoteObject))\n      return new ElementHandle(this, remoteObject.objectId!);\n    return super.createHandle(remoteObject);\n  }\n\n  injectedScript(): Promise<js.JSHandle<InjectedScript>> {\n    if (!this._injectedScriptPromise) {\n      const custom: string[] = [];\n      const selectorsRegistry = this.frame._page.context().selectors();\n      for (const [name, { source }] of selectorsRegistry._engines)\n        custom.push(`{ name: '${name}', engine: (${source}) }`);\n      const sdkLanguage = this.frame.attribution.playwright.options.sdkLanguage;\n      const source = `\n        (() => {\n        const module = {};\n        ${injectedScriptSource.source}\n        return new (module.exports.InjectedScript())(\n          globalThis,\n          ${isUnderTest()},\n          \"${sdkLanguage}\",\n          ${JSON.stringify(selectorsRegistry.testIdAttributeName())},\n          ${this.frame._page._delegate.rafCountForStablePosition()},\n          \"${this.frame._page._browserContext._browser.options.name}\",\n          [${custom.join(',\\n')}]\n        );\n        })();\n      `;\n      this._injectedScriptPromise = this.rawEvaluateHandle(source).then(objectId => new js.JSHandle(this, 'object', 'InjectedScript', objectId));\n    }\n    return this._injectedScriptPromise;\n  }\n}\n\nexport class ElementHandle<T extends Node = Node> extends js.JSHandle<T> {\n  __elementhandle: T = true as any;\n  declare readonly _context: FrameExecutionContext;\n  readonly _page: Page;\n  declare readonly _objectId: string;\n  readonly _frame: frames.Frame;\n\n  constructor(context: FrameExecutionContext, objectId: string) {\n    super(context, 'node', undefined, objectId);\n    this._page = context.frame._page;\n    this._frame = context.frame;\n    this._initializePreview().catch(e => {});\n  }\n\n  async _initializePreview() {\n    const utility = await this._context.injectedScript();\n    this._setPreview(await utility.evaluate((injected, e) => 'JSHandle@' + injected.previewNode(e), this));\n  }\n\n  override asElement(): ElementHandle<T> | null {\n    return this;\n  }\n\n  async evaluateInUtility<R, Arg>(pageFunction: js.Func1<[js.JSHandle<InjectedScript>, ElementHandle<T>, Arg], R>, arg: Arg): Promise<R | 'error:notconnected'> {\n    try {\n      const utility = await this._frame._utilityContext();\n      return await utility.evaluate(pageFunction, [await utility.injectedScript(), this, arg]);\n    } catch (e) {\n      if (js.isJavaScriptErrorInEvaluate(e) || isSessionClosedError(e))\n        throw e;\n      return 'error:notconnected';\n    }\n  }\n\n  async evaluateHandleInUtility<R, Arg>(pageFunction: js.Func1<[js.JSHandle<InjectedScript>, ElementHandle<T>, Arg], R>, arg: Arg): Promise<js.JSHandle<R> | 'error:notconnected'> {\n    try {\n      const utility = await this._frame._utilityContext();\n      return await utility.evaluateHandle(pageFunction, [await utility.injectedScript(), this, arg]);\n    } catch (e) {\n      if (js.isJavaScriptErrorInEvaluate(e) || isSessionClosedError(e))\n        throw e;\n      return 'error:notconnected';\n    }\n  }\n\n  async ownerFrame(): Promise<frames.Frame | null> {\n    const frameId = await this._page._delegate.getOwnerFrame(this);\n    if (!frameId)\n      return null;\n    const frame = this._page._frameManager.frame(frameId);\n    if (frame)\n      return frame;\n    for (const page of this._page._browserContext.pages()) {\n      const frame = page._frameManager.frame(frameId);\n      if (frame)\n        return frame;\n    }\n    return null;\n  }\n\n  async isIframeElement(): Promise<boolean | 'error:notconnected'> {\n    return this.evaluateInUtility(([injected, node]) => node && (node.nodeName === 'IFRAME' || node.nodeName === 'FRAME'), {});\n  }\n\n  async contentFrame(): Promise<frames.Frame | null> {\n    const isFrameElement = throwRetargetableDOMError(await this.isIframeElement());\n    if (!isFrameElement)\n      return null;\n    return this._page._delegate.getContentFrame(this);\n  }\n\n  async getAttribute(metadata: CallMetadata, name: string): Promise<string | null> {\n    return this._frame.getAttribute(metadata, ':scope', name, {}, this);\n  }\n\n  async inputValue(metadata: CallMetadata): Promise<string> {\n    return this._frame.inputValue(metadata, ':scope', {}, this);\n  }\n\n  async textContent(metadata: CallMetadata): Promise<string | null> {\n    return this._frame.textContent(metadata, ':scope', {}, this);\n  }\n\n  async innerText(metadata: CallMetadata): Promise<string> {\n    return this._frame.innerText(metadata, ':scope', {}, this);\n  }\n\n  async innerHTML(metadata: CallMetadata): Promise<string> {\n    return this._frame.innerHTML(metadata, ':scope', {}, this);\n  }\n\n  async dispatchEvent(metadata: CallMetadata, type: string, eventInit: Object = {}) {\n    return this._frame.dispatchEvent(metadata, ':scope', type, eventInit, {}, this);\n  }\n\n  async _scrollRectIntoViewIfNeeded(rect?: types.Rect): Promise<'error:notvisible' | 'error:notconnected' | 'done'> {\n    return await this._page._delegate.scrollRectIntoViewIfNeeded(this, rect);\n  }\n\n  async _waitAndScrollIntoViewIfNeeded(progress: Progress, waitForVisible: boolean): Promise<void> {\n    const result = await this._retryAction(progress, 'scroll into view', async () => {\n      progress.log(`  waiting for element to be stable`);\n      const waitResult = await this.evaluateInUtility(async ([injected, node, { waitForVisible }]) => {\n        return await injected.checkElementStates(node, waitForVisible ? ['visible', 'stable'] : ['stable']);\n      }, { waitForVisible });\n      if (waitResult)\n        return waitResult;\n      return await this._scrollRectIntoViewIfNeeded();\n    }, {});\n    assertDone(throwRetargetableDOMError(result));\n  }\n\n  async scrollIntoViewIfNeeded(metadata: CallMetadata, options: types.TimeoutOptions = {}) {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(\n        progress => this._waitAndScrollIntoViewIfNeeded(progress, false /* waitForVisible */),\n        this._page._timeoutSettings.timeout(options));\n  }\n\n  private async _clickablePoint(): Promise<types.Point | 'error:notvisible' | 'error:notinviewport' | 'error:notconnected'> {\n    const intersectQuadWithViewport = (quad: types.Quad): types.Quad => {\n      return quad.map(point => ({\n        x: Math.min(Math.max(point.x, 0), metrics.width),\n        y: Math.min(Math.max(point.y, 0), metrics.height),\n      })) as types.Quad;\n    };\n\n    const computeQuadArea = (quad: types.Quad) => {\n      // Compute sum of all directed areas of adjacent triangles\n      // https://en.wikipedia.org/wiki/Polygon#Simple_polygons\n      let area = 0;\n      for (let i = 0; i < quad.length; ++i) {\n        const p1 = quad[i];\n        const p2 = quad[(i + 1) % quad.length];\n        area += (p1.x * p2.y - p2.x * p1.y) / 2;\n      }\n      return Math.abs(area);\n    };\n\n    const [quads, metrics] = await Promise.all([\n      this._page._delegate.getContentQuads(this),\n      this._page.mainFrame()._utilityContext().then(utility => utility.evaluate(() => ({ width: innerWidth, height: innerHeight }))),\n    ] as const);\n    if (quads === 'error:notconnected')\n      return quads;\n    if (!quads || !quads.length)\n      return 'error:notvisible';\n\n    // Allow 1x1 elements. Compensate for rounding errors by comparing with 0.99 instead.\n    const filtered = quads.map(quad => intersectQuadWithViewport(quad)).filter(quad => computeQuadArea(quad) > 0.99);\n    if (!filtered.length)\n      return 'error:notinviewport';\n    // Return the middle point of the first quad.\n    const result = { x: 0, y: 0 };\n    for (const point of filtered[0]) {\n      result.x += point.x / 4;\n      result.y += point.y / 4;\n    }\n    compensateHalfIntegerRoundingError(result);\n    return result;\n  }\n\n  private async _offsetPoint(offset: types.Point): Promise<types.Point | 'error:notvisible' | 'error:notconnected'> {\n    const [box, border] = await Promise.all([\n      this.boundingBox(),\n      this.evaluateInUtility(([injected, node]) => injected.getElementBorderWidth(node), {}).catch(e => {}),\n    ]);\n    if (!box || !border)\n      return 'error:notvisible';\n    if (border === 'error:notconnected')\n      return border;\n    // Make point relative to the padding box to align with offsetX/offsetY.\n    return {\n      x: box.x + border.left + offset.x,\n      y: box.y + border.top + offset.y,\n    };\n  }\n\n  async _retryAction(progress: Progress, actionName: string, action: (retry: number) => Promise<PerformActionResult>, options: { trial?: boolean, force?: boolean, skipLocatorHandlersCheckpoint?: boolean }): Promise<'error:notconnected' | 'done'> {\n    let retry = 0;\n    // We progressively wait longer between retries, up to 500ms.\n    const waitTime = [0, 20, 100, 100, 500];\n\n    while (progress.isRunning()) {\n      if (retry) {\n        progress.log(`retrying ${actionName} action${options.trial ? ' (trial run)' : ''}, attempt #${retry}`);\n        const timeout = waitTime[Math.min(retry - 1, waitTime.length - 1)];\n        if (timeout) {\n          progress.log(`  waiting ${timeout}ms`);\n          const result = await this.evaluateInUtility(([injected, node, timeout]) => new Promise<void>(f => setTimeout(f, timeout)), timeout);\n          if (result === 'error:notconnected')\n            return result;\n        }\n      } else {\n        progress.log(`attempting ${actionName} action${options.trial ? ' (trial run)' : ''}`);\n      }\n      if (!options.skipLocatorHandlersCheckpoint && !options.force)\n        await this._frame._page.performLocatorHandlersCheckpoint(progress);\n      const result = await action(retry);\n      ++retry;\n      if (result === 'error:notvisible') {\n        if (options.force)\n          throw new NonRecoverableDOMError('Element is not visible');\n        progress.log('  element is not visible');\n        continue;\n      }\n      if (result === 'error:notinviewport') {\n        if (options.force)\n          throw new NonRecoverableDOMError('Element is outside of the viewport');\n        progress.log('  element is outside of the viewport');\n        continue;\n      }\n      if (result === 'error:optionsnotfound') {\n        progress.log('  did not find some options');\n        continue;\n      }\n      if (typeof result === 'object' && 'hitTargetDescription' in result) {\n        progress.log(`  ${result.hitTargetDescription} intercepts pointer events`);\n        continue;\n      }\n      if (typeof result === 'object' && 'missingState' in result) {\n        progress.log(`  element is not ${result.missingState}`);\n        continue;\n      }\n      return result;\n    }\n    return 'done';\n  }\n\n  async _retryPointerAction(progress: Progress, actionName: ActionName, waitForEnabled: boolean, action: (point: types.Point) => Promise<void>,\n    options: { waitAfter: boolean | 'disabled' } & types.PointerActionOptions & types.PointerActionWaitOptions): Promise<'error:notconnected' | 'done'> {\n    // Note: do not perform locator handlers checkpoint to avoid moving the mouse in the middle of a drag operation.\n    const skipLocatorHandlersCheckpoint = actionName === 'move and up';\n    return await this._retryAction(progress, actionName, async retry => {\n      // By default, we scroll with protocol method to reveal the action point.\n      // However, that might not work to scroll from under position:sticky elements\n      // that overlay the target element. To fight this, we cycle through different\n      // scroll alignments. This works in most scenarios.\n      const scrollOptions: (ScrollIntoViewOptions | undefined)[] = [\n        undefined,\n        { block: 'end', inline: 'end' },\n        { block: 'center', inline: 'center' },\n        { block: 'start', inline: 'start' },\n      ];\n      const forceScrollOptions = scrollOptions[retry % scrollOptions.length];\n      return await this._performPointerAction(progress, actionName, waitForEnabled, action, forceScrollOptions, options);\n    }, { ...options, skipLocatorHandlersCheckpoint });\n  }\n\n  async _performPointerAction(\n    progress: Progress,\n    actionName: ActionName,\n    waitForEnabled: boolean,\n    action: (point: types.Point) => Promise<void>,\n    forceScrollOptions: ScrollIntoViewOptions | undefined,\n    options: { waitAfter: boolean | 'disabled' } & types.PointerActionOptions & types.PointerActionWaitOptions,\n  ): Promise<PerformActionResult> {\n    const { force = false, position } = options;\n\n    const doScrollIntoView = async () => {\n      if (forceScrollOptions) {\n        return await this.evaluateInUtility(([injected, node, options]) => {\n          if (node.nodeType === 1 /* Node.ELEMENT_NODE */)\n            (node as Node as Element).scrollIntoView(options);\n          return 'done' as const;\n        }, forceScrollOptions);\n      }\n      return await this._scrollRectIntoViewIfNeeded(position ? { x: position.x, y: position.y, width: 0, height: 0 } : undefined);\n    };\n\n    if (this._frame.parentFrame()) {\n      // Best-effort scroll to make sure any iframes containing this element are scrolled\n      // into view and visible, so they are not throttled.\n      // See https://github.com/microsoft/playwright/issues/27196 for an example.\n      progress.throwIfAborted();  // Avoid action that has side-effects.\n      await doScrollIntoView().catch(() => {});\n    }\n\n    if ((options as any).__testHookBeforeStable)\n      await (options as any).__testHookBeforeStable();\n\n    if (!force) {\n      const elementStates: ElementState[] = waitForEnabled ? ['visible', 'enabled', 'stable'] : ['visible', 'stable'];\n      progress.log(`  waiting for element to be ${waitForEnabled ? 'visible, enabled and stable' : 'visible and stable'}`);\n      const result = await this.evaluateInUtility(async ([injected, node, { elementStates }]) => {\n        return await injected.checkElementStates(node, elementStates);\n      }, { elementStates });\n      if (result)\n        return result;\n      progress.log(`  element is ${waitForEnabled ? 'visible, enabled and stable' : 'visible and stable'}`);\n    }\n\n    if ((options as any).__testHookAfterStable)\n      await (options as any).__testHookAfterStable();\n\n    progress.log('  scrolling into view if needed');\n    progress.throwIfAborted();  // Avoid action that has side-effects.\n    const scrolled = await doScrollIntoView();\n    if (scrolled !== 'done')\n      return scrolled;\n    progress.log('  done scrolling');\n\n    const maybePoint = position ? await this._offsetPoint(position) : await this._clickablePoint();\n    if (typeof maybePoint === 'string')\n      return maybePoint;\n    const point = roundPoint(maybePoint);\n    progress.metadata.point = point;\n    await progress.beforeInputAction(this);\n\n    let hitTargetInterceptionHandle: js.JSHandle<HitTargetInterceptionResult> | undefined;\n    if (force) {\n      progress.log(`  forcing action`);\n    } else {\n      if ((options as any).__testHookBeforeHitTarget)\n        await (options as any).__testHookBeforeHitTarget();\n\n      const frameCheckResult = await this._checkFrameIsHitTarget(point);\n      if (frameCheckResult === 'error:notconnected' || ('hitTargetDescription' in frameCheckResult))\n        return frameCheckResult;\n      const hitPoint = frameCheckResult.framePoint;\n      const actionType = actionName === 'move and up' ? 'drag' : ((actionName === 'hover' || actionName === 'tap') ? actionName : 'mouse');\n      const handle = await this.evaluateHandleInUtility(([injected, node, { actionType, hitPoint, trial }]) => injected.setupHitTargetInterceptor(node, actionType, hitPoint, trial), { actionType, hitPoint, trial: !!options.trial } as const);\n      if (handle === 'error:notconnected')\n        return handle;\n      if (!handle._objectId) {\n        const error = handle.rawValue() as string;\n        if (error === 'error:notconnected')\n          return error;\n        return { hitTargetDescription: error };\n      }\n      hitTargetInterceptionHandle = handle as any;\n      progress.cleanupWhenAborted(() => {\n        // Do not await here, just in case the renderer is stuck (e.g. on alert)\n        // and we won't be able to cleanup.\n        hitTargetInterceptionHandle!.evaluate(h => h.stop()).catch(e => {});\n        hitTargetInterceptionHandle!.dispose();\n      });\n    }\n\n    const actionResult = await this._page._frameManager.waitForSignalsCreatedBy(progress, options.waitAfter === true, async () => {\n      if ((options as any).__testHookBeforePointerAction)\n        await (options as any).__testHookBeforePointerAction();\n      progress.throwIfAborted();  // Avoid action that has side-effects.\n      let restoreModifiers: types.KeyboardModifier[] | undefined;\n      if (options && options.modifiers)\n        restoreModifiers = await this._page.keyboard.ensureModifiers(options.modifiers);\n      progress.log(`  performing ${actionName} action`);\n      await action(point);\n      if (restoreModifiers)\n        await this._page.keyboard.ensureModifiers(restoreModifiers);\n      if (hitTargetInterceptionHandle) {\n        const stopHitTargetInterception = this._frame.raceAgainstEvaluationStallingEvents(() => {\n          return hitTargetInterceptionHandle.evaluate(h => h.stop());\n        }).catch(e => 'done' as const).finally(() => {\n          hitTargetInterceptionHandle?.dispose();\n        });\n        if (options.waitAfter !== false) {\n          // When noWaitAfter is passed, we do not want to accidentally stall on\n          // non-committed navigation blocking the evaluate.\n          const hitTargetResult = await stopHitTargetInterception;\n          if (hitTargetResult !== 'done')\n            return hitTargetResult;\n        }\n      }\n      progress.log(`  ${options.trial ? 'trial ' : ''}${actionName} action done`);\n      progress.log('  waiting for scheduled navigations to finish');\n      if ((options as any).__testHookAfterPointerAction)\n        await (options as any).__testHookAfterPointerAction();\n      return 'done';\n    });\n    if (actionResult !== 'done')\n      return actionResult;\n    progress.log('  navigations have finished');\n    return 'done';\n  }\n\n  async hover(metadata: CallMetadata, options: types.PointerActionOptions & types.PointerActionWaitOptions): Promise<void> {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      const result = await this._hover(progress, options);\n      return assertDone(throwRetargetableDOMError(result));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  _hover(progress: Progress, options: types.PointerActionOptions & types.PointerActionWaitOptions): Promise<'error:notconnected' | 'done'> {\n    return this._retryPointerAction(progress, 'hover', false /* waitForEnabled */, point => this._page.mouse.move(point.x, point.y), { ...options, waitAfter: 'disabled' });\n  }\n\n  async click(metadata: CallMetadata, options: { noWaitAfter?: boolean } & types.MouseClickOptions & types.PointerActionWaitOptions = {}): Promise<void> {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      const result = await this._click(progress, { ...options, waitAfter: !options.noWaitAfter });\n      return assertDone(throwRetargetableDOMError(result));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  _click(progress: Progress, options: { waitAfter: boolean | 'disabled' } & types.MouseClickOptions & types.PointerActionWaitOptions): Promise<'error:notconnected' | 'done'> {\n    return this._retryPointerAction(progress, 'click', true /* waitForEnabled */, point => this._page.mouse.click(point.x, point.y, options), options);\n  }\n\n  async dblclick(metadata: CallMetadata, options: types.MouseMultiClickOptions & types.PointerActionWaitOptions): Promise<void> {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      const result = await this._dblclick(progress, options);\n      return assertDone(throwRetargetableDOMError(result));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  _dblclick(progress: Progress, options: types.MouseMultiClickOptions & types.PointerActionWaitOptions): Promise<'error:notconnected' | 'done'> {\n    return this._retryPointerAction(progress, 'dblclick', true /* waitForEnabled */, point => this._page.mouse.dblclick(point.x, point.y, options), { ...options, waitAfter: 'disabled' });\n  }\n\n  async tap(metadata: CallMetadata, options: types.PointerActionWaitOptions = {}): Promise<void> {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      const result = await this._tap(progress, options);\n      return assertDone(throwRetargetableDOMError(result));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  _tap(progress: Progress, options: types.PointerActionWaitOptions): Promise<'error:notconnected' | 'done'> {\n    return this._retryPointerAction(progress, 'tap', true /* waitForEnabled */, point => this._page.touchscreen.tap(point.x, point.y), { ...options, waitAfter: 'disabled' });\n  }\n\n  async selectOption(metadata: CallMetadata, elements: ElementHandle[], values: types.SelectOption[], options: types.CommonActionOptions): Promise<string[]> {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      const result = await this._selectOption(progress, elements, values, options);\n      return throwRetargetableDOMError(result);\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async _selectOption(progress: Progress, elements: ElementHandle[], values: types.SelectOption[], options: types.CommonActionOptions): Promise<string[] | 'error:notconnected'> {\n    let resultingOptions: string[] = [];\n    await this._retryAction(progress, 'select option', async () => {\n      await progress.beforeInputAction(this);\n      if (!options.force)\n        progress.log(`  waiting for element to be visible and enabled`);\n      const optionsToSelect = [...elements, ...values];\n      const result = await this.evaluateInUtility(async ([injected, node, { optionsToSelect, force }]) => {\n        if (!force) {\n          const checkResult = await injected.checkElementStates(node, ['visible', 'enabled']);\n          if (checkResult)\n            return checkResult;\n        }\n        return injected.selectOptions(node, optionsToSelect);\n      }, { optionsToSelect, force: options.force });\n      if (Array.isArray(result)) {\n        progress.log('  selected specified option(s)');\n        resultingOptions = result;\n        return 'done';\n      }\n      return result;\n    }, options);\n    return resultingOptions;\n  }\n\n  async fill(metadata: CallMetadata, value: string, options: types.CommonActionOptions = {}): Promise<void> {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      const result = await this._fill(progress, value, options);\n      assertDone(throwRetargetableDOMError(result));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async _fill(progress: Progress, value: string, options: types.CommonActionOptions): Promise<'error:notconnected' | 'done'> {\n    progress.log(`  fill(\"${value}\")`);\n    return await this._retryAction(progress, 'fill', async () => {\n      await progress.beforeInputAction(this);\n      if (!options.force)\n        progress.log('  waiting for element to be visible, enabled and editable');\n      const result = await this.evaluateInUtility(async ([injected, node, { value, force }]) => {\n        if (!force) {\n          const checkResult = await injected.checkElementStates(node, ['visible', 'enabled', 'editable']);\n          if (checkResult)\n            return checkResult;\n        }\n        return injected.fill(node, value);\n      }, { value, force: options.force });\n      progress.throwIfAborted();  // Avoid action that has side-effects.\n      if (result === 'needsinput') {\n        if (value)\n          await this._page.keyboard.insertText(value);\n        else\n          await this._page.keyboard.press('Delete');\n        return 'done';\n      } else {\n        return result;\n      }\n    }, options);\n  }\n\n  async selectText(metadata: CallMetadata, options: types.CommonActionOptions = {}): Promise<void> {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      const result = await this._retryAction(progress, 'selectText', async () => {\n        if (!options.force)\n          progress.log('  waiting for element to be visible');\n        return await this.evaluateInUtility(async ([injected, node, { force }]) => {\n          if (!force) {\n            const checkResult = await injected.checkElementStates(node, ['visible']);\n            if (checkResult)\n              return checkResult;\n          }\n          return injected.selectText(node);\n        }, { force: options.force });\n      }, options);\n      assertDone(throwRetargetableDOMError(result));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async setInputFiles(metadata: CallMetadata, params: channels.ElementHandleSetInputFilesParams) {\n    const inputFileItems = await prepareFilesForUpload(this._frame, params);\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      const result = await this._setInputFiles(progress, inputFileItems);\n      return assertDone(throwRetargetableDOMError(result));\n    }, this._page._timeoutSettings.timeout(params));\n  }\n\n  async _setInputFiles(progress: Progress, items: InputFilesItems): Promise<'error:notconnected' | 'done'> {\n    const { filePayloads, localPaths, localDirectory } = items;\n    const multiple = filePayloads && filePayloads.length > 1 || localPaths && localPaths.length > 1;\n    const result = await this.evaluateHandleInUtility(([injected, node, { multiple, directoryUpload }]): Element | undefined => {\n      const element = injected.retarget(node, 'follow-label');\n      if (!element)\n        return;\n      if (element.tagName !== 'INPUT')\n        throw injected.createStacklessError('Node is not an HTMLInputElement');\n      const inputElement = element as HTMLInputElement;\n      if (multiple && !inputElement.multiple && !inputElement.webkitdirectory)\n        throw injected.createStacklessError('Non-multiple file input can only accept single file');\n      if (directoryUpload && !inputElement.webkitdirectory)\n        throw injected.createStacklessError('File input does not support directories, pass individual files instead');\n      if (!directoryUpload && inputElement.webkitdirectory)\n        throw injected.createStacklessError('[webkitdirectory] input requires passing a path to a directory');\n      return inputElement;\n    }, { multiple, directoryUpload: !!localDirectory });\n    if (result === 'error:notconnected' || !result.asElement())\n      return 'error:notconnected';\n    const retargeted = result.asElement() as ElementHandle<HTMLInputElement>;\n    await progress.beforeInputAction(this);\n    progress.throwIfAborted();  // Avoid action that has side-effects.\n    if (localPaths || localDirectory) {\n      const localPathsOrDirectory = localDirectory ? [localDirectory] : localPaths!;\n      await Promise.all((localPathsOrDirectory).map(localPath => (\n        fs.promises.access(localPath, fs.constants.F_OK)\n      )));\n      // Browsers traverse the given directory asynchronously and we want to ensure all files are uploaded.\n      const waitForInputEvent = localDirectory ? this.evaluate(node => new Promise<any>(fulfill => {\n        node.addEventListener('input', fulfill, { once: true });\n      })).catch(() => {}) : Promise.resolve();\n      await this._page._delegate.setInputFilePaths(retargeted, localPathsOrDirectory);\n      await waitForInputEvent;\n    } else {\n      await this._page._delegate.setInputFiles(retargeted, filePayloads!);\n    }\n    return 'done';\n  }\n\n  async focus(metadata: CallMetadata): Promise<void> {\n    const controller = new ProgressController(metadata, this);\n    await controller.run(async progress => {\n      const result = await this._focus(progress);\n      return assertDone(throwRetargetableDOMError(result));\n    }, 0);\n  }\n\n  async _focus(progress: Progress, resetSelectionIfNotFocused?: boolean): Promise<'error:notconnected' | 'done'> {\n    progress.throwIfAborted();  // Avoid action that has side-effects.\n    return await this.evaluateInUtility(([injected, node, resetSelectionIfNotFocused]) => injected.focusNode(node, resetSelectionIfNotFocused), resetSelectionIfNotFocused);\n  }\n\n  async _blur(progress: Progress): Promise<'error:notconnected' | 'done'> {\n    progress.throwIfAborted();  // Avoid action that has side-effects.\n    return await this.evaluateInUtility(([injected, node]) => injected.blurNode(node), {});\n  }\n\n  async type(metadata: CallMetadata, text: string, options: { delay?: number } & types.TimeoutOptions & types.StrictOptions): Promise<void> {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      const result = await this._type(progress, text, options);\n      return assertDone(throwRetargetableDOMError(result));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async _type(progress: Progress, text: string, options: { delay?: number } & types.TimeoutOptions & types.StrictOptions): Promise<'error:notconnected' | 'done'> {\n    progress.log(`elementHandle.type(\"${text}\")`);\n    await progress.beforeInputAction(this);\n    const result = await this._focus(progress, true /* resetSelectionIfNotFocused */);\n    if (result !== 'done')\n      return result;\n    progress.throwIfAborted();  // Avoid action that has side-effects.\n    await this._page.keyboard.type(text, options);\n    return 'done';\n  }\n\n  async press(metadata: CallMetadata, key: string, options: { delay?: number, noWaitAfter?: boolean } & types.TimeoutOptions & types.StrictOptions): Promise<void> {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      const result = await this._press(progress, key, options);\n      return assertDone(throwRetargetableDOMError(result));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async _press(progress: Progress, key: string, options: { delay?: number, noWaitAfter?: boolean } & types.TimeoutOptions & types.StrictOptions): Promise<'error:notconnected' | 'done'> {\n    progress.log(`elementHandle.press(\"${key}\")`);\n    await progress.beforeInputAction(this);\n    return this._page._frameManager.waitForSignalsCreatedBy(progress, !options.noWaitAfter, async () => {\n      const result = await this._focus(progress, true /* resetSelectionIfNotFocused */);\n      if (result !== 'done')\n        return result;\n      progress.throwIfAborted();  // Avoid action that has side-effects.\n      await this._page.keyboard.press(key, options);\n      return 'done';\n    });\n  }\n\n  async check(metadata: CallMetadata, options: { position?: types.Point } & types.PointerActionWaitOptions) {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      const result = await this._setChecked(progress, true, options);\n      return assertDone(throwRetargetableDOMError(result));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async uncheck(metadata: CallMetadata, options: { position?: types.Point } & types.PointerActionWaitOptions) {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      const result = await this._setChecked(progress, false, options);\n      return assertDone(throwRetargetableDOMError(result));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async _setChecked(progress: Progress, state: boolean, options: { position?: types.Point } & types.PointerActionWaitOptions): Promise<'error:notconnected' | 'done'> {\n    const isChecked = async () => {\n      const result = await this.evaluateInUtility(([injected, node]) => injected.elementState(node, 'checked'), {});\n      return throwRetargetableDOMError(result);\n    };\n    if (await isChecked() === state)\n      return 'done';\n    const result = await this._click(progress, { ...options, waitAfter: 'disabled' });\n    if (result !== 'done')\n      return result;\n    if (options.trial)\n      return 'done';\n    if (await isChecked() !== state)\n      throw new NonRecoverableDOMError('Clicking the checkbox did not change its state');\n    return 'done';\n  }\n\n  async boundingBox(): Promise<types.Rect | null> {\n    return this._page._delegate.getBoundingBox(this);\n  }\n\n  async screenshot(metadata: CallMetadata, options: ScreenshotOptions & TimeoutOptions = {}): Promise<Buffer> {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(\n        progress => this._page._screenshotter.screenshotElement(progress, this, options),\n        this._page._timeoutSettings.timeout(options));\n  }\n\n  async querySelector(selector: string, options: types.StrictOptions): Promise<ElementHandle | null> {\n    return this._frame.selectors.query(selector, options, this);\n  }\n\n  async querySelectorAll(selector: string): Promise<ElementHandle<Element>[]> {\n    return this._frame.selectors.queryAll(selector, this);\n  }\n\n  async evalOnSelector(selector: string, strict: boolean, expression: string, isFunction: boolean | undefined, arg: any): Promise<any> {\n    return this._frame.evalOnSelector(selector, strict, expression, isFunction, arg, this);\n  }\n\n  async evalOnSelectorAll(selector: string, expression: string, isFunction: boolean | undefined, arg: any): Promise<any> {\n    return this._frame.evalOnSelectorAll(selector, expression, isFunction, arg, this);\n  }\n\n  async isVisible(metadata: CallMetadata): Promise<boolean> {\n    return this._frame.isVisible(metadata, ':scope', {}, this);\n  }\n\n  async isHidden(metadata: CallMetadata): Promise<boolean> {\n    return this._frame.isHidden(metadata, ':scope', {}, this);\n  }\n\n  async isEnabled(metadata: CallMetadata): Promise<boolean> {\n    return this._frame.isEnabled(metadata, ':scope', {}, this);\n  }\n\n  async isDisabled(metadata: CallMetadata): Promise<boolean> {\n    return this._frame.isDisabled(metadata, ':scope', {}, this);\n  }\n\n  async isEditable(metadata: CallMetadata): Promise<boolean> {\n    return this._frame.isEditable(metadata, ':scope', {}, this);\n  }\n\n  async isChecked(metadata: CallMetadata): Promise<boolean> {\n    return this._frame.isChecked(metadata, ':scope', {}, this);\n  }\n\n  async waitForElementState(metadata: CallMetadata, state: 'visible' | 'hidden' | 'stable' | 'enabled' | 'disabled' | 'editable', options: types.TimeoutOptions = {}): Promise<void> {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      const actionName = `wait for ${state}`;\n      const result = await this._retryAction(progress, actionName, async () => {\n        return await this.evaluateInUtility(async ([injected, node, state]) => {\n          return (await injected.checkElementStates(node, [state])) || 'done';\n        }, state);\n      }, {});\n      assertDone(throwRetargetableDOMError(result));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async waitForSelector(metadata: CallMetadata, selector: string, options: types.WaitForElementOptions = {}): Promise<ElementHandle<Element> | null> {\n    return this._frame.waitForSelector(metadata, selector, options, this);\n  }\n\n  async _adoptTo(context: FrameExecutionContext): Promise<ElementHandle<T>> {\n    if (this._context !== context) {\n      const adopted = await this._page._delegate.adoptElementHandle(this, context);\n      this.dispose();\n      return adopted;\n    }\n    return this;\n  }\n\n  async _checkFrameIsHitTarget(point: types.Point): Promise<{ framePoint: types.Point | undefined } | 'error:notconnected' | { hitTargetDescription: string }> {\n    let frame = this._frame;\n    const data: { frame: frames.Frame, frameElement: ElementHandle<Element> | null, pointInFrame: types.Point }[] = [];\n    while (frame.parentFrame()) {\n      const frameElement = await frame.frameElement() as ElementHandle<Element>;\n      const box = await frameElement.boundingBox();\n      const style = await frameElement.evaluateInUtility(([injected, iframe]) => injected.describeIFrameStyle(iframe), {}).catch(e => 'error:notconnected' as const);\n      if (!box || style === 'error:notconnected')\n        return 'error:notconnected';\n      if (style === 'transformed') {\n        // We cannot translate coordinates when iframe has any transform applied.\n        // The best we can do right now is to skip the hitPoint check,\n        // and solely rely on the event interceptor.\n        return { framePoint: undefined };\n      }\n      // Translate from viewport coordinates to frame coordinates.\n      const pointInFrame = { x: point.x - box.x - style.left, y: point.y - box.y - style.top };\n      data.push({ frame, frameElement, pointInFrame });\n      frame = frame.parentFrame()!;\n    }\n    // Add main frame.\n    data.push({ frame, frameElement: null, pointInFrame: point });\n\n    for (let i = data.length - 1; i > 0; i--) {\n      const element = data[i - 1].frameElement!;\n      const point = data[i].pointInFrame;\n      // Hit target in the parent frame should hit the child frame element.\n      const hitTargetResult = await element.evaluateInUtility(([injected, element, hitPoint]) => {\n        return injected.expectHitTarget(hitPoint, element);\n      }, point);\n      if (hitTargetResult !== 'done')\n        return hitTargetResult;\n    }\n    return { framePoint: data[0].pointInFrame };\n  }\n}\n\nexport function throwRetargetableDOMError<T>(result: T | 'error:notconnected'): T {\n  if (result === 'error:notconnected')\n    throw new Error('Element is not attached to the DOM');\n  return result;\n}\n\nexport function assertDone(result: 'done'): void {\n  // This function converts 'done' to void and ensures typescript catches unhandled errors.\n}\n\nfunction roundPoint(point: types.Point): types.Point {\n  return {\n    x: (point.x * 100 | 0) / 100,\n    y: (point.y * 100 | 0) / 100,\n  };\n}\n\nfunction compensateHalfIntegerRoundingError(point: types.Point) {\n  // Firefox internally uses integer coordinates, so 8.5 is converted to 9 when clicking.\n  //\n  // This does not work nicely for small elements. For example, 1x1 square with corners\n  // (8;8) and (9;9) is targeted when clicking at (8;8) but not when clicking at (9;9).\n  // So, clicking at (8.5;8.5) will effectively click at (9;9) and miss the target.\n  //\n  // Therefore, we skew half-integer values from the interval (8.49, 8.51) towards\n  // (8.47, 8.49) that is rounded towards 8. This means clicking at (8.5;8.5) will\n  // be replaced with (8.48;8.48) and will effectively click at (8;8).\n  //\n  // Other browsers use float coordinates, so this change should not matter.\n  const remainderX = point.x - Math.floor(point.x);\n  if (remainderX > 0.49 && remainderX < 0.51)\n    point.x -= 0.02;\n  const remainderY = point.y - Math.floor(point.y);\n  if (remainderY > 0.49 && remainderY < 0.51)\n    point.y -= 0.02;\n}\n\nexport const kUnableToAdoptErrorMessage = 'Unable to adopt element handle from a different document';\n"],"mappings":"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"}