{"version":3,"file":"frames.js","names":["dom","_interopRequireWildcard","require","_helper","_eventsHelper","js","network","_page","types","_browserContext","_progress","_utils","_manualPromise","_debugLogger","_instrumentation","_protocolError","_selectorParser","_frameSelectors","_errors","_fileUploadUtils","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","NavigationAbortedError","Error","constructor","documentId","message","exports","kDummyFrameId","FrameManager","page","_frames","Map","_mainFrame","_consoleMessageTags","_signalBarriers","Set","_webSockets","_openedDialogs","_closeAllOpeningDialogs","undefined","createDummyMainFrameIfNeeded","frameAttached","dispose","frame","values","_stopNetworkIdleTimer","_invalidateNonStallingEvaluations","mainFrame","frames","collect","push","subframe","childFrames","frameId","parentFrameId","parentFrame","delete","_id","assert","Frame","emit","Page","Events","FrameAttached","waitForSignalsCreatedBy","progress","waitAfter","action","barrier","SignalBarrier","add","cleanupWhenAborted","result","_delegate","inputActionEpilogue","waitFor","Promise","makeWaitForNextTask","frameWillPotentiallyRequestNavigation","retain","frameDidPotentiallyRequestNavigation","release","frameRequestedNavigation","addFrameNavigation","pendingDocument","request","Array","from","_inflightRequests","find","_documentId","setPendingDocument","frameCommittedNewDocumentNavigation","url","name","initial","removeChildFramesRecursively","clearWebSockets","_url","_name","keepPending","_currentDocument","_onClearLifecycle","navigationEvent","newDocument","isPublic","_fireInternalFrameNavigation","debugLogger","log","frameNavigatedToNewDocument","frameCommittedSameDocumentNavigation","frameAbortedNavigation","errorText","error","_redirectedNavigations","frameDetached","_removeFramesRecursively","_recalculateNetworkIdle","frameLifecycleEvent","event","_onLifecycleEvent","requestStarted","route","_inflightRequestStarted","_isFavicon","continue","isFallback","catch","emitOnContext","BrowserContext","Request","_this$_page$_serverRe","_this$_page","_this$_page$_clientRe","_this$_page2","_this$_page$_browserC","_this$_page$_browserC2","Route","_serverRequestInterceptor","_clientRequestInterceptor","_requestInterceptor","requestReceivedResponse","response","Response","reportRequestFinished","_inflightRequestFinished","RequestFinished","requestFailed","canceled","failure","RequestFailed","dialogDidOpen","dialog","close","then","dialogWillClose","closeOpenDialogs","all","map","clear","setCloseAllOpeningDialogs","closeDialogs","child","_onDetached","isClosed","FrameDetached","size","_startNetworkIdleTimer","interceptConsoleMessage","type","tag","text","handler","onWebSocketCreated","requestId","ws","WebSocket","onWebSocketRequest","markAsNotified","onWebSocketResponse","status","statusText","onWebSocketFrameSent","opcode","data","frameSent","webSocketFrameReceived","frameReceived","webSocketClosed","closed","webSocketError","errorMessage","InternalNavigation","SdkObject","id","_firedLifecycleEvents","_firedNetworkIdleSelf","_pendingDocument","_parentFrame","_contextData","_childFrames","_networkIdleTimer","_setContentCounter","_detachedScope","LongStandingScope","_raceAgainstEvaluationStallingEventsPromises","selectors","attribution","FrameSelectors","contextPromise","ManualPromise","context","_setContext","isDetached","AddLifecycle","RemoveLifecycle","filter","documentInfo","promise","reject","raceAgainstEvaluationStallingEvents","cb","_frameManager","race","nonStallingRawEvaluateInExistingMainContext","expression","_existingMainContext","rawEvaluateJSON","nonStallingEvaluateInExistingContext","world","_this$_contextData$ge","evaluateExpression","isFunction","frameThatAllowsRemovingNetworkIdle","isNetworkIdle","raceNavigationAction","options","raceMultiple","openScope","gotoPromise","redirectNavigation","referer","controller","ProgressController","serverSideCallMetadata","run","_gotoAction","finally","goto","metadata","constructedNavigationURL","constructURLBasedOnBaseURL","_options","baseURL","_goto","_timeoutSettings","navigationTimeout","waitUntil","verifyLifecycle","headers","extraHTTPHeaders","refererHeader","h","toLowerCase","value","helper","completeUserURL","navigationEvents","collectNavigations","arg","on","navigateResult","navigateFrame","off","newDocumentId","predicate","events","length","waitForEvent","_finalRequest","_waitForNavigation","requiresNewDocument","_waitForLoadState","state","frameElement","getFrameElement","_context","contextOrDestroyedReason","ExecutionContext","destroyedReason","_mainContext","_this$_contextData$ge2","_utilityContext","_options$world","evaluateExpressionHandle","_options$world2","querySelector","selector","query","waitForSelector","scope","visibility","includes","_asLocator","waitForSelectorInternal","timeout","retryWithProgressAndTimeouts","continuePolling","resolved","resolveInjectedForSelector","throwIfAborted","injected","evaluateHandle","info","root","elements","querySelectorAll","parsed","document","element","visible","utils","isElementVisible","strict","strictModeViolationError","previewNode","attached","evaluate","success","detached","hidden","omitReturnValue","__testHookBeforeAdoptNode","_adoptTo","_raceAgainstContextDestroyed","dispatchEvent","eventInit","_callOnElementOnceMatches","injectedScript","mainWorld","evalOnSelector","handle","evalOnSelectorAll","arrayHandle","queryArrayInMainWorld","maskSelectors","color","queryAll","queryCount","content","retVal","doctype","XMLSerializer","serializeToString","documentElement","outerHTML","isJavaScriptErrorInEvaluate","isSessionClosedError","setContent","html","_this$_page$_delegate","_this$_page$_delegate2","useMainWorldForSetContent","lifecyclePromise","resolve","contentPromise","open","console","debug","write","origin","_network$parsedURL","startsWith","parsedURL","addScriptTag","params","_raceWithCSPError","addScriptUrl","asElement","addScriptContent","cspErrorsAsynchronousForInlineScripts","script","createElement","src","res","rej","onload","onerror","head","appendChild","addStyleTag","addStyleUrl","addStyleContent","link","rel","href","style","createTextNode","func","listeners","cspMessage","actionPromise","errorPromise","eventsHelper","addEventListener","Console","removeEventListeners","timeouts","Symbol","timeoutIndex","isRunning","Math","min","f","setTimeout","_isErrorThatCannotBeRetried","isNonRecoverableDOMError","isInvalidSelectorError","_retryWithProgressIfNotConnected","performLocatorHandlersCheckpoint","rafrafTimeoutScreenshotElementWithProgress","_frame","rafrafTimeout","_screenshotter","screenshotElement","click","assertDone","force","_click","noWaitAfter","dblclick","_dblclick","dragAndDrop","source","target","_retryPointerAction","point","mouse","move","x","y","down","position","sourcePosition","timeUntilDeadline","up","targetPosition","tap","hasTouch","_tap","fill","_fill","focus","_focus","blur","_blur","textContent","innerText","namespaceURI","createStacklessError","innerHTML","getAttribute","inputValue","node","retarget","nodeName","highlight","hideHighlight","_elementState","elementState","throwRetargetableDOMError","isVisible","isVisibleInternal","isHidden","isDisabled","isEnabled","isEditable","isChecked","hover","_hover","selectOption","_selectOption","setInputFiles","inputFileItems","prepareFilesForUpload","_setInputFiles","_type","press","key","_press","check","_setChecked","uncheck","waitForTimeout","expect","_expectImpl","matches","isNot","lastIntermediateResult","isSet","start","monotonicTime","apiName","resultOneShot","_expectInternal","elapsed","timedOut","received","TimeoutError","_info$world","selectorInFrame","resolveFrameForSelector","missingReceived","callId","isArray","endsWith","markTargetElements","renderUnexpectedValue","_waitForFunctionExpression","pollingInterval","normalizeEvaluationExpression","polling","globalThis","eval","fulfill","aborted","next","builtinRequestAnimationFrame","builtinSetTimeout","abort","waitForFunctionValueInUtility","pageFunction","JSON","parse","rawValue","title","requestAnimationFrame","contextDestroyed","body","taskData","callbackText","toString","callback","_contextCreated","_contextDestroyed","clearTimeout","extendInjectedScript","injectedScriptHandle","extend","resetStorageForCurrentOriginBestEffort","newStorage","ls","sessionStorage","localStorage","entry","registrations","navigator","serviceWorker","getRegistrations","installing","waiting","active","unregister","db","_indexedDB$databases","_indexedDB","indexedDB","databases","deleteDatabase","asLocator","playwright","sdkLanguage","_protectCount","_promise","waiter","kLifecycleEvents"],"sources":["../../src/server/frames.ts"],"sourcesContent":["/**\n * Copyright 2017 Google Inc. All rights reserved.\n * Modifications copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type * as channels from '@protocol/channels';\nimport type { ConsoleMessage } from './console';\nimport * as dom from './dom';\nimport { helper } from './helper';\nimport type { RegisteredListener } from '../utils/eventsHelper';\nimport { eventsHelper } from '../utils/eventsHelper';\nimport * as js from './javascript';\nimport * as network from './network';\nimport type { Dialog } from './dialog';\nimport { Page } from './page';\nimport * as types from './types';\nimport { BrowserContext } from './browserContext';\nimport type { Progress } from './progress';\nimport { ProgressController } from './progress';\nimport { LongStandingScope, assert, constructURLBasedOnBaseURL, makeWaitForNextTask, monotonicTime, asLocator } from '../utils';\nimport { ManualPromise } from '../utils/manualPromise';\nimport { debugLogger } from '../utils/debugLogger';\nimport type { CallMetadata } from './instrumentation';\nimport { serverSideCallMetadata, SdkObject } from './instrumentation';\nimport type { InjectedScript, ElementStateWithoutStable, FrameExpectParams } from './injected/injectedScript';\nimport { isSessionClosedError } from './protocolError';\nimport { type ParsedSelector, isInvalidSelectorError } from '../utils/isomorphic/selectorParser';\nimport type { ScreenshotOptions } from './screenshotter';\nimport { FrameSelectors } from './frameSelectors';\nimport { TimeoutError } from './errors';\nimport { prepareFilesForUpload } from './fileUploadUtils';\n\ntype ContextData = {\n  contextPromise: ManualPromise<dom.FrameExecutionContext | { destroyedReason: string }>;\n  context: dom.FrameExecutionContext | null;\n};\n\ntype DocumentInfo = {\n  // Unfortunately, we don't have documentId when we find out about\n  // a pending navigation from things like frameScheduledNavigaiton.\n  documentId: string | undefined,\n  request: network.Request | undefined,\n};\n\nexport type GotoResult = {\n  newDocumentId?: string,\n};\n\ntype ConsoleTagHandler = () => void;\n\ntype RegularLifecycleEvent = Exclude<types.LifecycleEvent, 'networkidle'>;\n\nexport type FunctionWithSource = (source: { context: BrowserContext, page: Page, frame: Frame}, ...args: any) => any;\n\nexport type NavigationEvent = {\n  // New frame url after navigation.\n  url: string,\n  // New frame name after navigation.\n  name: string,\n  // Information about the new document for cross-document navigations.\n  // Undefined for same-document navigations.\n  newDocument?: DocumentInfo,\n  // Error for cross-document navigations if any. When error is present,\n  // the navigation did not commit.\n  error?: Error,\n  // Whether this event should be visible to the clients via the public APIs.\n  isPublic?: boolean;\n};\n\ntype ElementCallback<T, R> = (injected: InjectedScript, element: Element, data: T) => R;\n\nexport class NavigationAbortedError extends Error {\n  readonly documentId?: string;\n  constructor(documentId: string | undefined, message: string) {\n    super(message);\n    this.documentId = documentId;\n  }\n}\n\nconst kDummyFrameId = '<dummy>';\n\nexport class FrameManager {\n  private _page: Page;\n  private _frames = new Map<string, Frame>();\n  private _mainFrame: Frame;\n  readonly _consoleMessageTags = new Map<string, ConsoleTagHandler>();\n  readonly _signalBarriers = new Set<SignalBarrier>();\n  private _webSockets = new Map<string, network.WebSocket>();\n  _openedDialogs: Set<Dialog> = new Set();\n  private _closeAllOpeningDialogs = false;\n\n  constructor(page: Page) {\n    this._page = page;\n    this._mainFrame = undefined as any as Frame;\n  }\n\n  createDummyMainFrameIfNeeded() {\n    if (!this._mainFrame)\n      this.frameAttached(kDummyFrameId, null);\n  }\n\n  dispose() {\n    for (const frame of this._frames.values()) {\n      frame._stopNetworkIdleTimer();\n      frame._invalidateNonStallingEvaluations('Target crashed');\n    }\n  }\n\n  mainFrame(): Frame {\n    return this._mainFrame;\n  }\n\n  frames() {\n    const frames: Frame[] = [];\n    collect(this._mainFrame);\n    return frames;\n\n    function collect(frame: Frame) {\n      frames.push(frame);\n      for (const subframe of frame.childFrames())\n        collect(subframe);\n    }\n  }\n\n  frame(frameId: string): Frame | null {\n    return this._frames.get(frameId) || null;\n  }\n\n  frameAttached(frameId: string, parentFrameId: string | null | undefined): Frame {\n    const parentFrame = parentFrameId ? this._frames.get(parentFrameId)! : null;\n    if (!parentFrame) {\n      if (this._mainFrame) {\n        // Update frame id to retain frame identity on cross-process navigation.\n        this._frames.delete(this._mainFrame._id);\n        this._mainFrame._id = frameId;\n      } else {\n        assert(!this._frames.has(frameId));\n        this._mainFrame = new Frame(this._page, frameId, parentFrame);\n      }\n      this._frames.set(frameId, this._mainFrame);\n      return this._mainFrame;\n    } else {\n      assert(!this._frames.has(frameId));\n      const frame = new Frame(this._page, frameId, parentFrame);\n      this._frames.set(frameId, frame);\n      this._page.emit(Page.Events.FrameAttached, frame);\n      return frame;\n    }\n  }\n\n  async waitForSignalsCreatedBy<T>(progress: Progress | null, waitAfter: boolean, action: () => Promise<T>): Promise<T> {\n    if (!waitAfter)\n      return action();\n    const barrier = new SignalBarrier(progress);\n    this._signalBarriers.add(barrier);\n    if (progress)\n      progress.cleanupWhenAborted(() => this._signalBarriers.delete(barrier));\n    const result = await action();\n    await this._page._delegate.inputActionEpilogue();\n    await barrier.waitFor();\n    this._signalBarriers.delete(barrier);\n    // Resolve in the next task, after all waitForNavigations.\n    await new Promise<void>(makeWaitForNextTask());\n    return result;\n  }\n\n  frameWillPotentiallyRequestNavigation() {\n    for (const barrier of this._signalBarriers)\n      barrier.retain();\n  }\n\n  frameDidPotentiallyRequestNavigation() {\n    for (const barrier of this._signalBarriers)\n      barrier.release();\n  }\n\n  frameRequestedNavigation(frameId: string, documentId?: string) {\n    const frame = this._frames.get(frameId);\n    if (!frame)\n      return;\n    for (const barrier of this._signalBarriers)\n      barrier.addFrameNavigation(frame);\n    if (frame.pendingDocument() && frame.pendingDocument()!.documentId === documentId) {\n      // Do not override request with undefined.\n      return;\n    }\n\n    const request = documentId ? Array.from(frame._inflightRequests).find(request => request._documentId === documentId) : undefined;\n    frame.setPendingDocument({ documentId, request });\n  }\n\n  frameCommittedNewDocumentNavigation(frameId: string, url: string, name: string, documentId: string, initial: boolean) {\n    const frame = this._frames.get(frameId)!;\n    this.removeChildFramesRecursively(frame);\n    this.clearWebSockets(frame);\n    frame._url = url;\n    frame._name = name;\n\n    let keepPending: DocumentInfo | undefined;\n    const pendingDocument = frame.pendingDocument();\n    if (pendingDocument) {\n      if (pendingDocument.documentId === undefined) {\n        // Pending with unknown documentId - assume it is the one being committed.\n        pendingDocument.documentId = documentId;\n      }\n      if (pendingDocument.documentId === documentId) {\n        // Committing a pending document.\n        frame._currentDocument = pendingDocument;\n      } else {\n        // Sometimes, we already have a new pending when the old one commits.\n        // An example would be Chromium error page followed by a new navigation request,\n        // where the error page commit arrives after Network.requestWillBeSent for the\n        // new navigation.\n        // We commit, but keep the pending request since it's not done yet.\n        keepPending = pendingDocument;\n        frame._currentDocument = { documentId, request: undefined };\n      }\n      frame.setPendingDocument(undefined);\n    } else {\n      // No pending - just commit a new document.\n      frame._currentDocument = { documentId, request: undefined };\n    }\n\n    frame._onClearLifecycle();\n    const navigationEvent: NavigationEvent = { url, name, newDocument: frame._currentDocument, isPublic: true };\n    this._fireInternalFrameNavigation(frame, navigationEvent);\n    if (!initial) {\n      debugLogger.log('api', `  navigated to \"${url}\"`);\n      this._page.frameNavigatedToNewDocument(frame);\n    }\n    // Restore pending if any - see comments above about keepPending.\n    frame.setPendingDocument(keepPending);\n  }\n\n  frameCommittedSameDocumentNavigation(frameId: string, url: string) {\n    const frame = this._frames.get(frameId);\n    if (!frame)\n      return;\n    frame._url = url;\n    const navigationEvent: NavigationEvent = { url, name: frame._name, isPublic: true };\n    this._fireInternalFrameNavigation(frame, navigationEvent);\n    debugLogger.log('api', `  navigated to \"${url}\"`);\n  }\n\n  frameAbortedNavigation(frameId: string, errorText: string, documentId?: string) {\n    const frame = this._frames.get(frameId);\n    if (!frame || !frame.pendingDocument())\n      return;\n    if (documentId !== undefined && frame.pendingDocument()!.documentId !== documentId)\n      return;\n    const navigationEvent: NavigationEvent = {\n      url: frame._url,\n      name: frame._name,\n      newDocument: frame.pendingDocument(),\n      error: new NavigationAbortedError(documentId, errorText),\n      isPublic: !(documentId && frame._redirectedNavigations.has(documentId)),\n    };\n    frame.setPendingDocument(undefined);\n    this._fireInternalFrameNavigation(frame, navigationEvent);\n  }\n\n  frameDetached(frameId: string) {\n    const frame = this._frames.get(frameId);\n    if (frame) {\n      this._removeFramesRecursively(frame);\n      this._page.mainFrame()._recalculateNetworkIdle();\n    }\n  }\n\n  frameLifecycleEvent(frameId: string, event: RegularLifecycleEvent) {\n    const frame = this._frames.get(frameId);\n    if (frame)\n      frame._onLifecycleEvent(event);\n  }\n\n  requestStarted(request: network.Request, route?: network.RouteDelegate) {\n    const frame = request.frame()!;\n    this._inflightRequestStarted(request);\n    if (request._documentId)\n      frame.setPendingDocument({ documentId: request._documentId, request });\n    if (request._isFavicon) {\n      route?.continue({ isFallback: true }).catch(() => {});\n      return;\n    }\n    this._page.emitOnContext(BrowserContext.Events.Request, request);\n    if (route) {\n      const r = new network.Route(request, route);\n      if (this._page._serverRequestInterceptor?.(r, request))\n        return;\n      if (this._page._clientRequestInterceptor?.(r, request))\n        return;\n      if (this._page._browserContext._requestInterceptor?.(r, request))\n        return;\n      r.continue({ isFallback: true }).catch(() => {});\n    }\n  }\n\n  requestReceivedResponse(response: network.Response) {\n    if (response.request()._isFavicon)\n      return;\n    this._page.emitOnContext(BrowserContext.Events.Response, response);\n  }\n\n  reportRequestFinished(request: network.Request, response: network.Response | null) {\n    this._inflightRequestFinished(request);\n    if (request._isFavicon)\n      return;\n    this._page.emitOnContext(BrowserContext.Events.RequestFinished, { request, response });\n  }\n\n  requestFailed(request: network.Request, canceled: boolean) {\n    const frame = request.frame()!;\n    this._inflightRequestFinished(request);\n    if (frame.pendingDocument() && frame.pendingDocument()!.request === request) {\n      let errorText = request.failure()!.errorText;\n      if (canceled)\n        errorText += '; maybe frame was detached?';\n      this.frameAbortedNavigation(frame._id, errorText, frame.pendingDocument()!.documentId);\n    }\n    if (request._isFavicon)\n      return;\n    this._page.emitOnContext(BrowserContext.Events.RequestFailed, request);\n  }\n\n  dialogDidOpen(dialog: Dialog) {\n    // Any ongoing evaluations will be stalled until the dialog is closed.\n    for (const frame of this._frames.values())\n      frame._invalidateNonStallingEvaluations('JavaScript dialog interrupted evaluation');\n    if (this._closeAllOpeningDialogs)\n      dialog.close().then(() => {});\n    else\n      this._openedDialogs.add(dialog);\n  }\n\n  dialogWillClose(dialog: Dialog) {\n    this._openedDialogs.delete(dialog);\n  }\n\n  async closeOpenDialogs() {\n    await Promise.all([...this._openedDialogs].map(dialog => dialog.close())).catch(() => {});\n    this._openedDialogs.clear();\n  }\n\n  setCloseAllOpeningDialogs(closeDialogs: boolean) {\n    this._closeAllOpeningDialogs = closeDialogs;\n  }\n\n  removeChildFramesRecursively(frame: Frame) {\n    for (const child of frame.childFrames())\n      this._removeFramesRecursively(child);\n  }\n\n  private _removeFramesRecursively(frame: Frame) {\n    this.removeChildFramesRecursively(frame);\n    frame._onDetached();\n    this._frames.delete(frame._id);\n    if (!this._page.isClosed())\n      this._page.emit(Page.Events.FrameDetached, frame);\n  }\n\n  private _inflightRequestFinished(request: network.Request) {\n    const frame = request.frame()!;\n    if (request._isFavicon)\n      return;\n    if (!frame._inflightRequests.has(request))\n      return;\n    frame._inflightRequests.delete(request);\n    if (frame._inflightRequests.size === 0)\n      frame._startNetworkIdleTimer();\n  }\n\n  private _inflightRequestStarted(request: network.Request) {\n    const frame = request.frame()!;\n    if (request._isFavicon)\n      return;\n    frame._inflightRequests.add(request);\n    if (frame._inflightRequests.size === 1)\n      frame._stopNetworkIdleTimer();\n  }\n\n  interceptConsoleMessage(message: ConsoleMessage): boolean {\n    if (message.type() !== 'debug')\n      return false;\n    const tag = message.text();\n    const handler = this._consoleMessageTags.get(tag);\n    if (!handler)\n      return false;\n    this._consoleMessageTags.delete(tag);\n    handler();\n    return true;\n  }\n\n  clearWebSockets(frame: Frame) {\n    // TODO: attribute sockets to frames.\n    if (frame.parentFrame())\n      return;\n    this._webSockets.clear();\n  }\n\n  onWebSocketCreated(requestId: string, url: string) {\n    const ws = new network.WebSocket(this._page, url);\n    this._webSockets.set(requestId, ws);\n  }\n\n  onWebSocketRequest(requestId: string) {\n    const ws = this._webSockets.get(requestId);\n    if (ws && ws.markAsNotified())\n      this._page.emit(Page.Events.WebSocket, ws);\n  }\n\n  onWebSocketResponse(requestId: string, status: number, statusText: string) {\n    const ws = this._webSockets.get(requestId);\n    if (status < 400)\n      return;\n    if (ws)\n      ws.error(`${statusText}: ${status}`);\n  }\n\n  onWebSocketFrameSent(requestId: string, opcode: number, data: string) {\n    const ws = this._webSockets.get(requestId);\n    if (ws)\n      ws.frameSent(opcode, data);\n  }\n\n  webSocketFrameReceived(requestId: string, opcode: number, data: string) {\n    const ws = this._webSockets.get(requestId);\n    if (ws)\n      ws.frameReceived(opcode, data);\n  }\n\n  webSocketClosed(requestId: string) {\n    const ws = this._webSockets.get(requestId);\n    if (ws)\n      ws.closed();\n    this._webSockets.delete(requestId);\n  }\n\n  webSocketError(requestId: string, errorMessage: string): void {\n    const ws = this._webSockets.get(requestId);\n    if (ws)\n      ws.error(errorMessage);\n  }\n\n  private _fireInternalFrameNavigation(frame: Frame, event: NavigationEvent) {\n    frame.emit(Frame.Events.InternalNavigation, event);\n  }\n}\n\nexport class Frame extends SdkObject {\n  static Events = {\n    InternalNavigation: 'internalnavigation',\n    AddLifecycle: 'addlifecycle',\n    RemoveLifecycle: 'removelifecycle',\n  };\n\n  _id: string;\n  _firedLifecycleEvents = new Set<types.LifecycleEvent>();\n  private _firedNetworkIdleSelf = false;\n  _currentDocument: DocumentInfo;\n  private _pendingDocument: DocumentInfo | undefined;\n  readonly _page: Page;\n  private _parentFrame: Frame | null;\n  _url = '';\n  private _contextData = new Map<types.World, ContextData>();\n  private _childFrames = new Set<Frame>();\n  _name = '';\n  _inflightRequests = new Set<network.Request>();\n  private _networkIdleTimer: NodeJS.Timeout | undefined;\n  private _setContentCounter = 0;\n  readonly _detachedScope = new LongStandingScope();\n  private _raceAgainstEvaluationStallingEventsPromises = new Set<ManualPromise<any>>();\n  readonly _redirectedNavigations = new Map<string, { url: string, gotoPromise: Promise<network.Response | null> }>(); // documentId -> data\n  readonly selectors: FrameSelectors;\n\n  constructor(page: Page, id: string, parentFrame: Frame | null) {\n    super(page, 'frame');\n    this.attribution.frame = this;\n    this._id = id;\n    this._page = page;\n    this._parentFrame = parentFrame;\n    this._currentDocument = { documentId: undefined, request: undefined };\n    this.selectors = new FrameSelectors(this);\n\n    this._contextData.set('main', { contextPromise: new ManualPromise(), context: null });\n    this._contextData.set('utility', { contextPromise: new ManualPromise(), context: null });\n    this._setContext('main', null);\n    this._setContext('utility', null);\n\n    if (this._parentFrame)\n      this._parentFrame._childFrames.add(this);\n\n    this._firedLifecycleEvents.add('commit');\n    if (id !== kDummyFrameId)\n      this._startNetworkIdleTimer();\n  }\n\n  isDetached(): boolean {\n    return this._detachedScope.isClosed();\n  }\n\n  _onLifecycleEvent(event: RegularLifecycleEvent) {\n    if (this._firedLifecycleEvents.has(event))\n      return;\n    this._firedLifecycleEvents.add(event);\n    this.emit(Frame.Events.AddLifecycle, event);\n    if (this === this._page.mainFrame() && this._url !== 'about:blank')\n      debugLogger.log('api', `  \"${event}\" event fired`);\n    this._page.mainFrame()._recalculateNetworkIdle();\n  }\n\n  _onClearLifecycle() {\n    for (const event of this._firedLifecycleEvents)\n      this.emit(Frame.Events.RemoveLifecycle, event);\n    this._firedLifecycleEvents.clear();\n    // Keep the current navigation request if any.\n    this._inflightRequests = new Set(Array.from(this._inflightRequests).filter(request => request === this._currentDocument.request));\n    this._stopNetworkIdleTimer();\n    if (this._inflightRequests.size === 0)\n      this._startNetworkIdleTimer();\n    this._page.mainFrame()._recalculateNetworkIdle(this);\n    this._onLifecycleEvent('commit');\n  }\n\n  setPendingDocument(documentInfo: DocumentInfo | undefined) {\n    this._pendingDocument = documentInfo;\n    if (documentInfo)\n      this._invalidateNonStallingEvaluations('Navigation interrupted the evaluation');\n  }\n\n  pendingDocument(): DocumentInfo | undefined {\n    return this._pendingDocument;\n  }\n\n  _invalidateNonStallingEvaluations(message: string) {\n    if (!this._raceAgainstEvaluationStallingEventsPromises.size)\n      return;\n    const error = new Error(message);\n    for (const promise of this._raceAgainstEvaluationStallingEventsPromises)\n      promise.reject(error);\n  }\n\n  async raceAgainstEvaluationStallingEvents<T>(cb: () => Promise<T>): Promise<T> {\n    if (this._pendingDocument)\n      throw new Error('Frame is currently attempting a navigation');\n    if (this._page._frameManager._openedDialogs.size)\n      throw new Error('Open JavaScript dialog prevents evaluation');\n\n    const promise = new ManualPromise<T>();\n    this._raceAgainstEvaluationStallingEventsPromises.add(promise);\n    try {\n      return await Promise.race([\n        cb(),\n        promise\n      ]);\n    } finally {\n      this._raceAgainstEvaluationStallingEventsPromises.delete(promise);\n    }\n  }\n\n  nonStallingRawEvaluateInExistingMainContext(expression: string): Promise<any> {\n    return this.raceAgainstEvaluationStallingEvents(() => {\n      const context = this._existingMainContext();\n      if (!context)\n        throw new Error('Frame does not yet have a main execution context');\n      return context.rawEvaluateJSON(expression);\n    });\n  }\n\n  nonStallingEvaluateInExistingContext(expression: string, world: types.World): Promise<any> {\n    return this.raceAgainstEvaluationStallingEvents(() => {\n      const context = this._contextData.get(world)?.context;\n      if (!context)\n        throw new Error('Frame does not yet have the execution context');\n      return context.evaluateExpression(expression, { isFunction: false });\n    });\n  }\n\n  _recalculateNetworkIdle(frameThatAllowsRemovingNetworkIdle?: Frame) {\n    let isNetworkIdle = this._firedNetworkIdleSelf;\n    for (const child of this._childFrames) {\n      child._recalculateNetworkIdle(frameThatAllowsRemovingNetworkIdle);\n      // We require networkidle event to be fired in the whole frame subtree, and then consider it done.\n      if (!child._firedLifecycleEvents.has('networkidle'))\n        isNetworkIdle = false;\n    }\n    if (isNetworkIdle && !this._firedLifecycleEvents.has('networkidle')) {\n      this._firedLifecycleEvents.add('networkidle');\n      this.emit(Frame.Events.AddLifecycle, 'networkidle');\n      if (this === this._page.mainFrame() && this._url !== 'about:blank')\n        debugLogger.log('api', `  \"networkidle\" event fired`);\n    }\n    if (frameThatAllowsRemovingNetworkIdle !== this && this._firedLifecycleEvents.has('networkidle') && !isNetworkIdle) {\n      // Usually, networkidle is fired once and not removed after that.\n      // However, when we clear them right before a new commit, this is allowed for a particular frame.\n      this._firedLifecycleEvents.delete('networkidle');\n      this.emit(Frame.Events.RemoveLifecycle, 'networkidle');\n    }\n  }\n\n  async raceNavigationAction(progress: Progress, options: types.GotoOptions, action: () => Promise<network.Response | null>): Promise<network.Response | null> {\n    return LongStandingScope.raceMultiple([\n      this._detachedScope,\n      this._page.openScope,\n    ], action().catch(e => {\n      if (e instanceof NavigationAbortedError && e.documentId) {\n        const data = this._redirectedNavigations.get(e.documentId);\n        if (data) {\n          progress.log(`waiting for redirected navigation to \"${data.url}\"`);\n          return data.gotoPromise;\n        }\n      }\n      throw e;\n    }));\n  }\n\n  redirectNavigation(url: string, documentId: string, referer: string | undefined) {\n    const controller = new ProgressController(serverSideCallMetadata(), this);\n    const data = {\n      url,\n      gotoPromise: controller.run(progress => this._gotoAction(progress, url, { referer }), 0),\n    };\n    this._redirectedNavigations.set(documentId, data);\n    data.gotoPromise.finally(() => this._redirectedNavigations.delete(documentId));\n  }\n\n  async goto(metadata: CallMetadata, url: string, options: types.GotoOptions = {}): Promise<network.Response | null> {\n    const constructedNavigationURL = constructURLBasedOnBaseURL(this._page._browserContext._options.baseURL, url);\n    const controller = new ProgressController(metadata, this);\n    return controller.run(progress => this._goto(progress, constructedNavigationURL, options), this._page._timeoutSettings.navigationTimeout(options));\n  }\n\n  private async _goto(progress: Progress, url: string, options: types.GotoOptions): Promise<network.Response | null> {\n    return this.raceNavigationAction(progress, options, async () => this._gotoAction(progress, url, options));\n  }\n\n  private async _gotoAction(progress: Progress, url: string, options: types.GotoOptions): Promise<network.Response | null> {\n    const waitUntil = verifyLifecycle('waitUntil', options.waitUntil === undefined ? 'load' : options.waitUntil);\n    progress.log(`navigating to \"${url}\", waiting until \"${waitUntil}\"`);\n    const headers = this._page.extraHTTPHeaders() || [];\n    const refererHeader = headers.find(h => h.name.toLowerCase() === 'referer');\n    let referer = refererHeader ? refererHeader.value : undefined;\n    if (options.referer !== undefined) {\n      if (referer !== undefined && referer !== options.referer)\n        throw new Error('\"referer\" is already specified as extra HTTP header');\n      referer = options.referer;\n    }\n    url = helper.completeUserURL(url);\n\n    const navigationEvents: NavigationEvent[] = [];\n    const collectNavigations = (arg: NavigationEvent) => navigationEvents.push(arg);\n    this.on(Frame.Events.InternalNavigation, collectNavigations);\n    const navigateResult = await this._page._delegate.navigateFrame(this, url, referer).finally(\n        () => this.off(Frame.Events.InternalNavigation, collectNavigations));\n\n    let event: NavigationEvent;\n    if (navigateResult.newDocumentId) {\n      const predicate = (event: NavigationEvent) => {\n        // We are interested either in this specific document, or any other document that\n        // did commit and replaced the expected document.\n        return event.newDocument && (event.newDocument.documentId === navigateResult.newDocumentId || !event.error);\n      };\n      const events = navigationEvents.filter(predicate);\n      if (events.length)\n        event = events[0];\n      else\n        event = await helper.waitForEvent(progress, this, Frame.Events.InternalNavigation, predicate).promise;\n      if (event.newDocument!.documentId !== navigateResult.newDocumentId) {\n        // This is just a sanity check. In practice, new navigation should\n        // cancel the previous one and report \"request cancelled\"-like error.\n        throw new NavigationAbortedError(navigateResult.newDocumentId, `Navigation to \"${url}\" is interrupted by another navigation to \"${event.url}\"`);\n      }\n      if (event.error)\n        throw event.error;\n    } else {\n      // Wait for same document navigation.\n      const predicate = (e: NavigationEvent) => !e.newDocument;\n      const events = navigationEvents.filter(predicate);\n      if (events.length)\n        event = events[0];\n      else\n        event = await helper.waitForEvent(progress, this, Frame.Events.InternalNavigation, predicate).promise;\n    }\n\n    if (!this._firedLifecycleEvents.has(waitUntil))\n      await helper.waitForEvent(progress, this, Frame.Events.AddLifecycle, (e: types.LifecycleEvent) => e === waitUntil).promise;\n\n    const request = event.newDocument ? event.newDocument.request : undefined;\n    const response = request ? request._finalRequest().response() : null;\n    return response;\n  }\n\n  async _waitForNavigation(progress: Progress, requiresNewDocument: boolean, options: types.NavigateOptions): Promise<network.Response | null> {\n    const waitUntil = verifyLifecycle('waitUntil', options.waitUntil === undefined ? 'load' : options.waitUntil);\n    progress.log(`waiting for navigation until \"${waitUntil}\"`);\n\n    const navigationEvent: NavigationEvent = await helper.waitForEvent(progress, this, Frame.Events.InternalNavigation, (event: NavigationEvent) => {\n      // Any failed navigation results in a rejection.\n      if (event.error)\n        return true;\n      if (requiresNewDocument && !event.newDocument)\n        return false;\n      progress.log(`  navigated to \"${this._url}\"`);\n      return true;\n    }).promise;\n    if (navigationEvent.error)\n      throw navigationEvent.error;\n\n    if (!this._firedLifecycleEvents.has(waitUntil))\n      await helper.waitForEvent(progress, this, Frame.Events.AddLifecycle, (e: types.LifecycleEvent) => e === waitUntil).promise;\n\n    const request = navigationEvent.newDocument ? navigationEvent.newDocument.request : undefined;\n    return request ? request._finalRequest().response() : null;\n  }\n\n  async _waitForLoadState(progress: Progress, state: types.LifecycleEvent): Promise<void> {\n    const waitUntil = verifyLifecycle('state', state);\n    if (!this._firedLifecycleEvents.has(waitUntil))\n      await helper.waitForEvent(progress, this, Frame.Events.AddLifecycle, (e: types.LifecycleEvent) => e === waitUntil).promise;\n  }\n\n  async frameElement(): Promise<dom.ElementHandle> {\n    return this._page._delegate.getFrameElement(this);\n  }\n\n  _context(world: types.World): Promise<dom.FrameExecutionContext> {\n    return this._contextData.get(world)!.contextPromise.then(contextOrDestroyedReason => {\n      if (contextOrDestroyedReason instanceof js.ExecutionContext)\n        return contextOrDestroyedReason;\n      throw new Error(contextOrDestroyedReason.destroyedReason);\n    });\n  }\n\n  _mainContext(): Promise<dom.FrameExecutionContext> {\n    return this._context('main');\n  }\n\n  private _existingMainContext(): dom.FrameExecutionContext | null {\n    return this._contextData.get('main')?.context || null;\n  }\n\n  _utilityContext(): Promise<dom.FrameExecutionContext> {\n    return this._context('utility');\n  }\n\n  async evaluateExpression(expression: string, options: { isFunction?: boolean, world?: types.World } = {}, arg?: any): Promise<any> {\n    const context = await this._context(options.world ?? 'main');\n    const value = await context.evaluateExpression(expression, options, arg);\n    return value;\n  }\n\n  async evaluateExpressionHandle(expression: string, options: { isFunction?: boolean, world?: types.World } = {}, arg?: any): Promise<js.JSHandle<any>> {\n    const context = await this._context(options.world ?? 'main');\n    const value = await context.evaluateExpressionHandle(expression, options, arg);\n    return value;\n  }\n\n  async querySelector(selector: string, options: types.StrictOptions): Promise<dom.ElementHandle<Element> | null> {\n    debugLogger.log('api', `    finding element using the selector \"${selector}\"`);\n    return this.selectors.query(selector, options);\n  }\n\n  async waitForSelector(metadata: CallMetadata, selector: string, options: types.WaitForElementOptions, scope?: dom.ElementHandle): Promise<dom.ElementHandle<Element> | null> {\n    const controller = new ProgressController(metadata, this);\n    if ((options as any).visibility)\n      throw new Error('options.visibility is not supported, did you mean options.state?');\n    if ((options as any).waitFor && (options as any).waitFor !== 'visible')\n      throw new Error('options.waitFor is not supported, did you mean options.state?');\n    const { state = 'visible' } = options;\n    if (!['attached', 'detached', 'visible', 'hidden'].includes(state))\n      throw new Error(`state: expected one of (attached|detached|visible|hidden)`);\n    return controller.run(async progress => {\n      progress.log(`waiting for ${this._asLocator(selector)}${state === 'attached' ? '' : ' to be ' + state}`);\n      return await this.waitForSelectorInternal(progress, selector, options, scope);\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async waitForSelectorInternal(progress: Progress, selector: string, options: types.WaitForElementOptions, scope?: dom.ElementHandle): Promise<dom.ElementHandle<Element> | null> {\n    const { state = 'visible' } = options;\n    const promise = this.retryWithProgressAndTimeouts(progress, [0, 20, 50, 100, 100, 500], async continuePolling => {\n      const resolved = await this.selectors.resolveInjectedForSelector(selector, options, scope);\n      progress.throwIfAborted();\n      if (!resolved) {\n        if (state === 'hidden' || state === 'detached')\n          return null;\n        return continuePolling;\n      }\n      const result = await resolved.injected.evaluateHandle((injected, { info, root }) => {\n        const elements = injected.querySelectorAll(info.parsed, root || document);\n        const element: Element | undefined  = elements[0];\n        const visible = element ? injected.utils.isElementVisible(element) : false;\n        let log = '';\n        if (elements.length > 1) {\n          if (info.strict)\n            throw injected.strictModeViolationError(info.parsed, elements);\n          log = `  locator resolved to ${elements.length} elements. Proceeding with the first one: ${injected.previewNode(elements[0])}`;\n        } else if (element) {\n          log = `  locator resolved to ${visible ? 'visible' : 'hidden'} ${injected.previewNode(element)}`;\n        }\n        return { log, element, visible, attached: !!element };\n      }, { info: resolved.info, root: resolved.frame === this ? scope : undefined });\n      const { log, visible, attached } = await result.evaluate(r => ({ log: r.log, visible: r.visible, attached: r.attached }));\n      if (log)\n        progress.log(log);\n      const success = { attached, detached: !attached, visible, hidden: !visible }[state];\n      if (!success) {\n        result.dispose();\n        return continuePolling;\n      }\n      if (options.omitReturnValue) {\n        result.dispose();\n        return null;\n      }\n      const element = state === 'attached' || state === 'visible' ? await result.evaluateHandle(r => r.element) : null;\n      result.dispose();\n      if (!element)\n        return null;\n      if ((options as any).__testHookBeforeAdoptNode)\n        await (options as any).__testHookBeforeAdoptNode();\n      try {\n        return await element._adoptTo(await resolved.frame._mainContext());\n      } catch (e) {\n        return continuePolling;\n      }\n    });\n    return scope ? scope._context._raceAgainstContextDestroyed(promise) : promise;\n  }\n\n  async dispatchEvent(metadata: CallMetadata, selector: string, type: string, eventInit: Object = {}, options: types.QueryOnSelectorOptions = {}, scope?: dom.ElementHandle): Promise<void> {\n    await this._callOnElementOnceMatches(metadata, selector, (injectedScript, element, data) => {\n      injectedScript.dispatchEvent(element, data.type, data.eventInit);\n    }, { type, eventInit }, { mainWorld: true, ...options }, scope);\n  }\n\n  async evalOnSelector(selector: string, strict: boolean, expression: string, isFunction: boolean | undefined, arg: any, scope?: dom.ElementHandle): Promise<any> {\n    const handle = await this.selectors.query(selector, { strict }, scope);\n    if (!handle)\n      throw new Error(`Failed to find element matching selector \"${selector}\"`);\n    const result = await handle.evaluateExpression(expression, { isFunction }, arg);\n    handle.dispose();\n    return result;\n  }\n\n  async evalOnSelectorAll(selector: string, expression: string, isFunction: boolean | undefined, arg: any, scope?: dom.ElementHandle): Promise<any> {\n    const arrayHandle = await this.selectors.queryArrayInMainWorld(selector, scope);\n    const result = await arrayHandle.evaluateExpression(expression, { isFunction }, arg);\n    arrayHandle.dispose();\n    return result;\n  }\n\n  async maskSelectors(selectors: ParsedSelector[], color: string): Promise<void> {\n    const context = await this._utilityContext();\n    const injectedScript = await context.injectedScript();\n    await injectedScript.evaluate((injected, { parsed, color }) => {\n      injected.maskSelectors(parsed, color);\n    }, { parsed: selectors, color: color });\n  }\n\n  async querySelectorAll(selector: string): Promise<dom.ElementHandle<Element>[]> {\n    return this.selectors.queryAll(selector);\n  }\n\n  async queryCount(selector: string): Promise<number> {\n    return await this.selectors.queryCount(selector);\n  }\n\n  async content(): Promise<string> {\n    try {\n      const context = await this._utilityContext();\n      return await context.evaluate(() => {\n        let retVal = '';\n        if (document.doctype)\n          retVal = new XMLSerializer().serializeToString(document.doctype);\n        if (document.documentElement)\n          retVal += document.documentElement.outerHTML;\n        return retVal;\n      });\n    } catch (e) {\n      if (js.isJavaScriptErrorInEvaluate(e) || isSessionClosedError(e))\n        throw e;\n      throw new Error(`Unable to retrieve content because the page is navigating and changing the content.`);\n    }\n  }\n\n  async setContent(metadata: CallMetadata, html: string, options: types.NavigateOptions = {}): Promise<void> {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      await this.raceNavigationAction(progress, options, async () => {\n        const waitUntil = options.waitUntil === undefined ? 'load' : options.waitUntil;\n        progress.log(`setting frame content, waiting until \"${waitUntil}\"`);\n        const tag = `--playwright--set--content--${this._id}--${++this._setContentCounter}--`;\n        const context = this._page._delegate.useMainWorldForSetContent?.() ? await this._mainContext() : await this._utilityContext();\n        const lifecyclePromise = new Promise((resolve, reject) => {\n          this._page._frameManager._consoleMessageTags.set(tag, () => {\n            // Clear lifecycle right after document.open() - see 'tag' below.\n            this._onClearLifecycle();\n            this._waitForLoadState(progress, waitUntil).then(resolve).catch(reject);\n          });\n        });\n        const contentPromise = context.evaluate(({ html, tag }) => {\n          document.open();\n          console.debug(tag);  // eslint-disable-line no-console\n          document.write(html);\n          document.close();\n        }, { html, tag });\n        await Promise.all([contentPromise, lifecyclePromise]);\n        return null;\n      });\n    }, this._page._timeoutSettings.navigationTimeout(options));\n  }\n\n  name(): string {\n    return this._name || '';\n  }\n\n  url(): string {\n    return this._url;\n  }\n\n  origin(): string | undefined {\n    if (!this._url.startsWith('http'))\n      return;\n    return network.parsedURL(this._url)?.origin;\n  }\n\n  parentFrame(): Frame | null {\n    return this._parentFrame;\n  }\n\n  childFrames(): Frame[] {\n    return Array.from(this._childFrames);\n  }\n\n  async addScriptTag(params: {\n      url?: string,\n      content?: string,\n      type?: string,\n    }): Promise<dom.ElementHandle> {\n    const {\n      url = null,\n      content = null,\n      type = ''\n    } = params;\n    if (!url && !content)\n      throw new Error('Provide an object with a `url`, `path` or `content` property');\n\n    const context = await this._mainContext();\n    return this._raceWithCSPError(async () => {\n      if (url !== null)\n        return (await context.evaluateHandle(addScriptUrl, { url, type })).asElement()!;\n      const result = (await context.evaluateHandle(addScriptContent, { content: content!, type })).asElement()!;\n      // Another round trip to the browser to ensure that we receive CSP error messages\n      // (if any) logged asynchronously in a separate task on the content main thread.\n      if (this._page._delegate.cspErrorsAsynchronousForInlineScripts)\n        await context.evaluate(() => true);\n      return result;\n    });\n\n    async function addScriptUrl(params: { url: string, type: string }): Promise<HTMLElement> {\n      const script = document.createElement('script');\n      script.src = params.url;\n      if (params.type)\n        script.type = params.type;\n      const promise = new Promise((res, rej) => {\n        script.onload = res;\n        script.onerror = e => rej(typeof e === 'string' ? new Error(e) : new Error(`Failed to load script at ${script.src}`));\n      });\n      document.head.appendChild(script);\n      await promise;\n      return script;\n    }\n\n    function addScriptContent(params: { content: string, type: string }): HTMLElement {\n      const script = document.createElement('script');\n      script.type = params.type || 'text/javascript';\n      script.text = params.content;\n      let error = null;\n      script.onerror = e => error = e;\n      document.head.appendChild(script);\n      if (error)\n        throw error;\n      return script;\n    }\n  }\n\n  async addStyleTag(params: { url?: string, content?: string }): Promise<dom.ElementHandle> {\n    const {\n      url = null,\n      content = null\n    } = params;\n    if (!url && !content)\n      throw new Error('Provide an object with a `url`, `path` or `content` property');\n\n    const context = await this._mainContext();\n    return this._raceWithCSPError(async () => {\n      if (url !== null)\n        return (await context.evaluateHandle(addStyleUrl, url)).asElement()!;\n      return (await context.evaluateHandle(addStyleContent, content!)).asElement()!;\n    });\n\n    async function addStyleUrl(url: string): Promise<HTMLElement> {\n      const link = document.createElement('link');\n      link.rel = 'stylesheet';\n      link.href = url;\n      const promise = new Promise((res, rej) => {\n        link.onload = res;\n        link.onerror = rej;\n      });\n      document.head.appendChild(link);\n      await promise;\n      return link;\n    }\n\n    async function addStyleContent(content: string): Promise<HTMLElement> {\n      const style = document.createElement('style');\n      style.type = 'text/css';\n      style.appendChild(document.createTextNode(content));\n      const promise = new Promise((res, rej) => {\n        style.onload = res;\n        style.onerror = rej;\n      });\n      document.head.appendChild(style);\n      await promise;\n      return style;\n    }\n  }\n\n  private async _raceWithCSPError(func: () => Promise<dom.ElementHandle>): Promise<dom.ElementHandle> {\n    const listeners: RegisteredListener[] = [];\n    let result: dom.ElementHandle;\n    let error: Error | undefined;\n    let cspMessage: ConsoleMessage | undefined;\n    const actionPromise = func().then(r => result = r).catch(e => error = e);\n    const errorPromise = new Promise<void>(resolve => {\n      listeners.push(eventsHelper.addEventListener(this._page._browserContext, BrowserContext.Events.Console, (message: ConsoleMessage) => {\n        if (message.page() !== this._page || message.type() !== 'error')\n          return;\n        if (message.text().includes('Content-Security-Policy') || message.text().includes('Content Security Policy')) {\n          cspMessage = message;\n          resolve();\n        }\n      }));\n    });\n    await Promise.race([actionPromise, errorPromise]);\n    eventsHelper.removeEventListeners(listeners);\n    if (cspMessage)\n      throw new Error(cspMessage.text());\n    if (error)\n      throw error;\n    return result!;\n  }\n\n  async retryWithProgressAndTimeouts<R>(progress: Progress, timeouts: number[], action: (continuePolling: symbol) => Promise<R | symbol>): Promise<R> {\n    const continuePolling = Symbol('continuePolling');\n    timeouts = [0, ...timeouts];\n    let timeoutIndex = 0;\n    while (progress.isRunning()) {\n      const timeout = timeouts[Math.min(timeoutIndex++, timeouts.length - 1)];\n      if (timeout) {\n        // Make sure we react immediately upon page close or frame detach.\n        // We need this to show expected/received values in time.\n        const actionPromise = new Promise(f => setTimeout(f, timeout));\n        await LongStandingScope.raceMultiple([\n          this._page.openScope,\n          this._detachedScope,\n        ], actionPromise);\n      }\n      progress.throwIfAborted();\n      try {\n        const result = await action(continuePolling);\n        if (result === continuePolling)\n          continue;\n        return result as R;\n      } catch (e) {\n        if (this._isErrorThatCannotBeRetried(e))\n          throw e;\n        continue;\n      }\n    }\n    progress.throwIfAborted();\n    return undefined as any;\n  }\n\n  private _isErrorThatCannotBeRetried(e: Error) {\n    // Always fail on JavaScript errors or when the main connection is closed.\n    if (js.isJavaScriptErrorInEvaluate(e) || isSessionClosedError(e))\n      return true;\n    // Certain errors opt-out of the retries, throw.\n    if (dom.isNonRecoverableDOMError(e) || isInvalidSelectorError(e))\n      return true;\n    // If the call is made on the detached frame - throw.\n    if (this.isDetached())\n      return true;\n    // Retry upon all other errors.\n    return false;\n  }\n\n  private async _retryWithProgressIfNotConnected<R>(\n    progress: Progress,\n    selector: string,\n    strict: boolean | undefined,\n    performLocatorHandlersCheckpoint: boolean,\n    action: (handle: dom.ElementHandle<Element>) => Promise<R | 'error:notconnected'>): Promise<R> {\n    progress.log(`waiting for ${this._asLocator(selector)}`);\n    return this.retryWithProgressAndTimeouts(progress, [0, 20, 50, 100, 100, 500], async continuePolling => {\n      if (performLocatorHandlersCheckpoint)\n        await this._page.performLocatorHandlersCheckpoint(progress);\n\n      const resolved = await this.selectors.resolveInjectedForSelector(selector, { strict });\n      progress.throwIfAborted();\n      if (!resolved)\n        return continuePolling;\n      const result = await resolved.injected.evaluateHandle((injected, { info }) => {\n        const elements = injected.querySelectorAll(info.parsed, document);\n        const element = elements[0] as Element | undefined;\n        let log = '';\n        if (elements.length > 1) {\n          if (info.strict)\n            throw injected.strictModeViolationError(info.parsed, elements);\n          log = `  locator resolved to ${elements.length} elements. Proceeding with the first one: ${injected.previewNode(elements[0])}`;\n        } else if (element) {\n          log = `  locator resolved to ${injected.previewNode(element)}`;\n        }\n        return { log, success: !!element, element };\n      }, { info: resolved.info });\n      const { log, success } = await result.evaluate(r => ({ log: r.log, success: r.success }));\n      if (log)\n        progress.log(log);\n      if (!success) {\n        result.dispose();\n        return continuePolling;\n      }\n      const element = await result.evaluateHandle(r => r.element) as dom.ElementHandle<Element>;\n      result.dispose();\n      try {\n        const result = await action(element);\n        if (result === 'error:notconnected') {\n          progress.log('element was detached from the DOM, retrying');\n          return continuePolling;\n        }\n        return result;\n      } finally {\n        element?.dispose();\n      }\n    });\n  }\n\n  async rafrafTimeoutScreenshotElementWithProgress(progress: Progress, selector: string, timeout: number, options: ScreenshotOptions): Promise<Buffer> {\n    return await this._retryWithProgressIfNotConnected(progress, selector, true /* strict */, true /* performLocatorHandlersCheckpoint */, async handle => {\n      await handle._frame.rafrafTimeout(timeout);\n      return await this._page._screenshotter.screenshotElement(progress, handle, options);\n    });\n  }\n\n  async click(metadata: CallMetadata, selector: string, options: { noWaitAfter?: boolean } & types.MouseClickOptions & types.PointerActionWaitOptions) {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      return dom.assertDone(await this._retryWithProgressIfNotConnected(progress, selector, options.strict, !options.force /* performLocatorHandlersCheckpoint */, handle => handle._click(progress, { ...options, waitAfter: !options.noWaitAfter })));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async dblclick(metadata: CallMetadata, selector: string, options: types.MouseMultiClickOptions & types.PointerActionWaitOptions = {}) {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      return dom.assertDone(await this._retryWithProgressIfNotConnected(progress, selector, options.strict, !options.force /* performLocatorHandlersCheckpoint */, handle => handle._dblclick(progress, options)));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async dragAndDrop(metadata: CallMetadata, source: string, target: string, options: types.DragActionOptions & types.PointerActionWaitOptions = {}) {\n    const controller = new ProgressController(metadata, this);\n    await controller.run(async progress => {\n      dom.assertDone(await this._retryWithProgressIfNotConnected(progress, source, options.strict, !options.force /* performLocatorHandlersCheckpoint */, async handle => {\n        return handle._retryPointerAction(progress, 'move and down', false, async point => {\n          await this._page.mouse.move(point.x, point.y);\n          await this._page.mouse.down();\n        }, {\n          ...options,\n          waitAfter: 'disabled',\n          position: options.sourcePosition,\n          timeout: progress.timeUntilDeadline(),\n        });\n      }));\n      // Note: do not perform locator handlers checkpoint to avoid moving the mouse in the middle of a drag operation.\n      dom.assertDone(await this._retryWithProgressIfNotConnected(progress, target, options.strict, false /* performLocatorHandlersCheckpoint */, async handle => {\n        return handle._retryPointerAction(progress, 'move and up', false, async point => {\n          await this._page.mouse.move(point.x, point.y);\n          await this._page.mouse.up();\n        }, {\n          ...options,\n          waitAfter: 'disabled',\n          position: options.targetPosition,\n          timeout: progress.timeUntilDeadline(),\n        });\n      }));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async tap(metadata: CallMetadata, selector: string, options: types.PointerActionWaitOptions) {\n    if (!this._page._browserContext._options.hasTouch)\n      throw new Error('The page does not support tap. Use hasTouch context option to enable touch support.');\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      return dom.assertDone(await this._retryWithProgressIfNotConnected(progress, selector, options.strict, !options.force /* performLocatorHandlersCheckpoint */, handle => handle._tap(progress, options)));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async fill(metadata: CallMetadata, selector: string, value: string, options: types.TimeoutOptions & types.StrictOptions & { force?: boolean }) {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      return dom.assertDone(await this._retryWithProgressIfNotConnected(progress, selector, options.strict, !options.force /* performLocatorHandlersCheckpoint */, handle => handle._fill(progress, value, options)));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async focus(metadata: CallMetadata, selector: string, options: types.TimeoutOptions & types.StrictOptions = {}) {\n    const controller = new ProgressController(metadata, this);\n    await controller.run(async progress => {\n      dom.assertDone(await this._retryWithProgressIfNotConnected(progress, selector, options.strict, true /* performLocatorHandlersCheckpoint */, handle => handle._focus(progress)));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async blur(metadata: CallMetadata, selector: string, options: types.TimeoutOptions & types.StrictOptions = {}) {\n    const controller = new ProgressController(metadata, this);\n    await controller.run(async progress => {\n      dom.assertDone(await this._retryWithProgressIfNotConnected(progress, selector, options.strict, true /* performLocatorHandlersCheckpoint */, handle => handle._blur(progress)));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async textContent(metadata: CallMetadata, selector: string, options: types.QueryOnSelectorOptions = {}, scope?: dom.ElementHandle): Promise<string | null> {\n    return this._callOnElementOnceMatches(metadata, selector, (injected, element) => element.textContent, undefined, options, scope);\n  }\n\n  async innerText(metadata: CallMetadata, selector: string, options: types.QueryOnSelectorOptions = {}, scope?: dom.ElementHandle): Promise<string> {\n    return this._callOnElementOnceMatches(metadata, selector, (injectedScript, element) => {\n      if (element.namespaceURI !== 'http://www.w3.org/1999/xhtml')\n        throw injectedScript.createStacklessError('Node is not an HTMLElement');\n      return (element as HTMLElement).innerText;\n    }, undefined, options, scope);\n  }\n\n  async innerHTML(metadata: CallMetadata, selector: string, options: types.QueryOnSelectorOptions = {}, scope?: dom.ElementHandle): Promise<string> {\n    return this._callOnElementOnceMatches(metadata, selector, (injected, element) => element.innerHTML, undefined, options, scope);\n  }\n\n  async getAttribute(metadata: CallMetadata, selector: string, name: string, options: types.QueryOnSelectorOptions = {}, scope?: dom.ElementHandle): Promise<string | null> {\n    return this._callOnElementOnceMatches(metadata, selector, (injected, element, data) => element.getAttribute(data.name), { name }, options, scope);\n  }\n\n  async inputValue(metadata: CallMetadata, selector: string, options: types.TimeoutOptions & types.StrictOptions = {}, scope?: dom.ElementHandle): Promise<string> {\n    return this._callOnElementOnceMatches(metadata, selector, (injectedScript, node) => {\n      const element = injectedScript.retarget(node, 'follow-label');\n      if (!element || (element.nodeName !== 'INPUT' && element.nodeName !== 'TEXTAREA' && element.nodeName !== 'SELECT'))\n        throw injectedScript.createStacklessError('Node is not an <input>, <textarea> or <select> element');\n      return (element as any).value;\n    }, undefined, options, scope);\n  }\n\n  async highlight(selector: string) {\n    const resolved = await this.selectors.resolveInjectedForSelector(selector);\n    if (!resolved)\n      return;\n    return await resolved.injected.evaluate((injected, { info }) => {\n      return injected.highlight(info.parsed);\n    }, { info: resolved.info });\n  }\n\n  async hideHighlight() {\n    return this.raceAgainstEvaluationStallingEvents(async () => {\n      const context = await this._utilityContext();\n      const injectedScript = await context.injectedScript();\n      return await injectedScript.evaluate(injected => {\n        return injected.hideHighlight();\n      });\n    });\n  }\n\n  private async _elementState(metadata: CallMetadata, selector: string, state: ElementStateWithoutStable, options: types.QueryOnSelectorOptions = {}, scope?: dom.ElementHandle): Promise<boolean> {\n    const result = await this._callOnElementOnceMatches(metadata, selector, (injected, element, data) => {\n      return injected.elementState(element, data.state);\n    }, { state }, options, scope);\n    return dom.throwRetargetableDOMError(result);\n  }\n\n  async isVisible(metadata: CallMetadata, selector: string, options: types.StrictOptions = {}, scope?: dom.ElementHandle): Promise<boolean> {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      progress.log(`  checking visibility of ${this._asLocator(selector)}`);\n      return await this.isVisibleInternal(selector, options, scope);\n    }, this._page._timeoutSettings.timeout({}));\n  }\n\n  async isVisibleInternal(selector: string, options: types.StrictOptions = {}, scope?: dom.ElementHandle): Promise<boolean> {\n    try {\n      const resolved = await this.selectors.resolveInjectedForSelector(selector, options, scope);\n      if (!resolved)\n        return false;\n      return await resolved.injected.evaluate((injected, { info, root }) => {\n        const element = injected.querySelector(info.parsed, root || document, info.strict);\n        const state = element ? injected.elementState(element, 'visible') : false;\n        return state === 'error:notconnected' ? false : state;\n      }, { info: resolved.info, root: resolved.frame === this ? scope : undefined });\n    } catch (e) {\n      if (js.isJavaScriptErrorInEvaluate(e) || isInvalidSelectorError(e) || isSessionClosedError(e))\n        throw e;\n      return false;\n    }\n  }\n\n  async isHidden(metadata: CallMetadata, selector: string, options: types.StrictOptions = {}, scope?: dom.ElementHandle): Promise<boolean> {\n    return !(await this.isVisible(metadata, selector, options, scope));\n  }\n\n  async isDisabled(metadata: CallMetadata, selector: string, options: types.QueryOnSelectorOptions = {}, scope?: dom.ElementHandle): Promise<boolean> {\n    return this._elementState(metadata, selector, 'disabled', options, scope);\n  }\n\n  async isEnabled(metadata: CallMetadata, selector: string, options: types.QueryOnSelectorOptions = {}, scope?: dom.ElementHandle): Promise<boolean> {\n    return this._elementState(metadata, selector, 'enabled', options, scope);\n  }\n\n  async isEditable(metadata: CallMetadata, selector: string, options: types.QueryOnSelectorOptions = {}, scope?: dom.ElementHandle): Promise<boolean> {\n    return this._elementState(metadata, selector, 'editable', options, scope);\n  }\n\n  async isChecked(metadata: CallMetadata, selector: string, options: types.QueryOnSelectorOptions = {}, scope?: dom.ElementHandle): Promise<boolean> {\n    return this._elementState(metadata, selector, 'checked', options, scope);\n  }\n\n  async hover(metadata: CallMetadata, selector: string, options: types.PointerActionOptions & types.PointerActionWaitOptions = {}) {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      return dom.assertDone(await this._retryWithProgressIfNotConnected(progress, selector, options.strict, !options.force /* performLocatorHandlersCheckpoint */, handle => handle._hover(progress, options)));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async selectOption(metadata: CallMetadata, selector: string, elements: dom.ElementHandle[], values: types.SelectOption[], options: types.CommonActionOptions = {}): Promise<string[]> {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      return await this._retryWithProgressIfNotConnected(progress, selector, options.strict, !options.force /* performLocatorHandlersCheckpoint */, handle => handle._selectOption(progress, elements, values, options));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async setInputFiles(metadata: CallMetadata, selector: string, params: channels.FrameSetInputFilesParams): Promise<channels.FrameSetInputFilesResult> {\n    const inputFileItems = await prepareFilesForUpload(this, params);\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      return dom.assertDone(await this._retryWithProgressIfNotConnected(progress, selector, params.strict, true /* performLocatorHandlersCheckpoint */, handle => handle._setInputFiles(progress, inputFileItems)));\n    }, this._page._timeoutSettings.timeout(params));\n  }\n\n  async type(metadata: CallMetadata, selector: string, text: string, options: { delay?: number } & types.TimeoutOptions & types.StrictOptions = {}) {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      return dom.assertDone(await this._retryWithProgressIfNotConnected(progress, selector, options.strict, true /* performLocatorHandlersCheckpoint */, handle => handle._type(progress, text, options)));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async press(metadata: CallMetadata, selector: string, key: string, options: { delay?: number, noWaitAfter?: boolean } & types.TimeoutOptions & types.StrictOptions = {}) {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      return dom.assertDone(await this._retryWithProgressIfNotConnected(progress, selector, options.strict, true /* performLocatorHandlersCheckpoint */, handle => handle._press(progress, key, options)));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async check(metadata: CallMetadata, selector: string, options: types.PointerActionWaitOptions = {}) {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      return dom.assertDone(await this._retryWithProgressIfNotConnected(progress, selector, options.strict, !options.force /* performLocatorHandlersCheckpoint */, handle => handle._setChecked(progress, true, options)));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async uncheck(metadata: CallMetadata, selector: string, options: types.PointerActionWaitOptions = {}) {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      return dom.assertDone(await this._retryWithProgressIfNotConnected(progress, selector, options.strict, !options.force /* performLocatorHandlersCheckpoint */, handle => handle._setChecked(progress, false, options)));\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async waitForTimeout(metadata: CallMetadata, timeout: number) {\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async () => {\n      await new Promise(resolve => setTimeout(resolve, timeout));\n    });\n  }\n\n  async expect(metadata: CallMetadata, selector: string, options: FrameExpectParams): Promise<{ matches: boolean, received?: any, log?: string[], timedOut?: boolean }> {\n    const result = await this._expectImpl(metadata, selector, options);\n    // Library mode special case for the expect errors which are return values, not exceptions.\n    if (result.matches === options.isNot)\n      metadata.error = { error: { name: 'Expect', message: 'Expect failed' } };\n    return result;\n  }\n\n  private async _expectImpl(metadata: CallMetadata, selector: string, options: FrameExpectParams): Promise<{ matches: boolean, received?: any, log?: string[], timedOut?: boolean }> {\n    const lastIntermediateResult: { received?: any, isSet: boolean } = { isSet: false };\n    try {\n      let timeout = this._page._timeoutSettings.timeout(options);\n      const start = timeout > 0 ? monotonicTime() : 0;\n\n      // Step 1: perform locator handlers checkpoint with a specified timeout.\n      await (new ProgressController(metadata, this)).run(async progress => {\n        progress.log(`${metadata.apiName}${timeout ? ` with timeout ${timeout}ms` : ''}`);\n        progress.log(`waiting for ${this._asLocator(selector)}`);\n        await this._page.performLocatorHandlersCheckpoint(progress);\n      }, timeout);\n\n      // Step 2: perform one-shot expect check without a timeout.\n      // Supports the case of `expect(locator).toBeVisible({ timeout: 1 })`\n      // that should succeed when the locator is already visible.\n      try {\n        const resultOneShot = await (new ProgressController(metadata, this)).run(async progress => {\n          return await this._expectInternal(progress, selector, options, lastIntermediateResult);\n        });\n        if (resultOneShot.matches !== options.isNot)\n          return resultOneShot;\n      } catch (e) {\n        if (js.isJavaScriptErrorInEvaluate(e) || isInvalidSelectorError(e))\n          throw e;\n        // Ignore any other errors from one-shot, we'll handle them during retries.\n      }\n      if (timeout > 0) {\n        const elapsed = monotonicTime() - start;\n        timeout -= elapsed;\n      }\n      if (timeout < 0)\n        return { matches: options.isNot, log: metadata.log, timedOut: true, received: lastIntermediateResult.received };\n\n      // Step 3: auto-retry expect with increasing timeouts. Bounded by the total remaining time.\n      return await (new ProgressController(metadata, this)).run(async progress => {\n        return await this.retryWithProgressAndTimeouts(progress, [100, 250, 500, 1000], async continuePolling => {\n          await this._page.performLocatorHandlersCheckpoint(progress);\n          const { matches, received } = await this._expectInternal(progress, selector, options, lastIntermediateResult);\n          if (matches === options.isNot) {\n            // Keep waiting in these cases:\n            // expect(locator).conditionThatDoesNotMatch\n            // expect(locator).not.conditionThatDoesMatch\n            return continuePolling;\n          }\n          return { matches, received };\n        });\n      }, timeout);\n    } catch (e) {\n      // Q: Why not throw upon isSessionClosedError(e) as in other places?\n      // A: We want user to receive a friendly message containing the last intermediate result.\n      if (js.isJavaScriptErrorInEvaluate(e) || isInvalidSelectorError(e))\n        throw e;\n      const result: { matches: boolean, received?: any, log?: string[], timedOut?: boolean } = { matches: options.isNot, log: metadata.log };\n      if (lastIntermediateResult.isSet)\n        result.received = lastIntermediateResult.received;\n      if (e instanceof TimeoutError)\n        result.timedOut = true;\n      return result;\n    }\n  }\n\n  private async _expectInternal(progress: Progress, selector: string, options: FrameExpectParams, lastIntermediateResult: { received?: any, isSet: boolean }) {\n    const selectorInFrame = await this.selectors.resolveFrameForSelector(selector, { strict: true });\n    progress.throwIfAborted();\n\n    const { frame, info } = selectorInFrame || { frame: this, info: undefined };\n    const world = options.expression === 'to.have.property' ? 'main' : (info?.world ?? 'utility');\n    const context = await frame._context(world);\n    const injected = await context.injectedScript();\n    progress.throwIfAborted();\n\n    const { log, matches, received, missingReceived } = await injected.evaluate(async (injected, { info, options, callId }) => {\n      const elements = info ? injected.querySelectorAll(info.parsed, document) : [];\n      const isArray = options.expression === 'to.have.count' || options.expression.endsWith('.array');\n      let log = '';\n      if (isArray)\n        log = `  locator resolved to ${elements.length} element${elements.length === 1 ? '' : 's'}`;\n      else if (elements.length > 1)\n        throw injected.strictModeViolationError(info!.parsed, elements);\n      else if (elements.length)\n        log = `  locator resolved to ${injected.previewNode(elements[0])}`;\n      if (callId)\n        injected.markTargetElements(new Set(elements), callId);\n      return { log, ...await injected.expect(elements[0], options, elements) };\n    }, { info, options, callId: progress.metadata.id });\n\n    if (log)\n      progress.log(log);\n    // Note: missingReceived avoids `unexpected value \"undefined\"` when element was not found.\n    if (matches === options.isNot) {\n      lastIntermediateResult.received = missingReceived ? '<element(s) not found>' : received;\n      lastIntermediateResult.isSet = true;\n      if (!missingReceived && !Array.isArray(received))\n        progress.log(`  unexpected value \"${renderUnexpectedValue(options.expression, received)}\"`);\n    }\n    return { matches, received };\n  }\n\n  async _waitForFunctionExpression<R>(metadata: CallMetadata, expression: string, isFunction: boolean | undefined, arg: any, options: types.WaitForFunctionOptions, world: types.World = 'main'): Promise<js.SmartHandle<R>> {\n    const controller = new ProgressController(metadata, this);\n    if (typeof options.pollingInterval === 'number')\n      assert(options.pollingInterval > 0, 'Cannot poll with non-positive interval: ' + options.pollingInterval);\n    expression = js.normalizeEvaluationExpression(expression, isFunction);\n    return controller.run(async progress => {\n      return this.retryWithProgressAndTimeouts(progress, [100], async () => {\n        const context = world === 'main' ? await this._mainContext() : await this._utilityContext();\n        const injectedScript = await context.injectedScript();\n        const handle = await injectedScript.evaluateHandle((injected, { expression, isFunction, polling, arg }) => {\n          const predicate = (): R => {\n            // NOTE: make sure to use `globalThis.eval` instead of `self.eval` due to a bug with sandbox isolation\n            // in firefox.\n            // See https://bugzilla.mozilla.org/show_bug.cgi?id=1814898\n            let result = globalThis.eval(expression);\n            if (isFunction === true) {\n              result = result(arg);\n            } else if (isFunction === false) {\n              result = result;\n            } else {\n              // auto detect.\n              if (typeof result === 'function')\n                result = result(arg);\n            }\n            return result;\n          };\n\n          let fulfill: (result: R) => void;\n          let reject: (error: Error) => void;\n          let aborted = false;\n          const result = new Promise<R>((f, r) => { fulfill = f; reject = r; });\n\n          const next = () => {\n            if (aborted)\n              return;\n            try {\n              const success = predicate();\n              if (success) {\n                fulfill(success);\n                return;\n              }\n              if (typeof polling !== 'number')\n                injected.builtinRequestAnimationFrame(next);\n              else\n                injected.builtinSetTimeout(next, polling);\n            } catch (e) {\n              reject(e);\n            }\n          };\n\n          next();\n          return { result, abort: () => aborted = true };\n        }, { expression, isFunction, polling: options.pollingInterval, arg });\n        progress.cleanupWhenAborted(() => handle.evaluate(h => h.abort()).catch(() => {}));\n        return handle.evaluateHandle(h => h.result);\n      });\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  async waitForFunctionValueInUtility<R>(progress: Progress, pageFunction: js.Func1<any, R>) {\n    const expression = `() => {\n      const result = (${pageFunction})();\n      if (!result)\n        return result;\n      return JSON.stringify(result);\n    }`;\n    const handle = await this._waitForFunctionExpression(serverSideCallMetadata(), expression, true, undefined, { timeout: progress.timeUntilDeadline() }, 'utility');\n    return JSON.parse(handle.rawValue()) as R;\n  }\n\n  async title(): Promise<string> {\n    const context = await this._utilityContext();\n    return context.evaluate(() => document.title);\n  }\n\n  async rafrafTimeout(timeout: number): Promise<void> {\n    if (timeout === 0)\n      return;\n    const context = await this._utilityContext();\n    await Promise.all([\n      // wait for double raf\n      context.evaluate(() => new Promise(x => {\n        requestAnimationFrame(() => {\n          requestAnimationFrame(x);\n        });\n      })),\n      new Promise(fulfill => setTimeout(fulfill, timeout)),\n    ]);\n  }\n\n  _onDetached() {\n    this._stopNetworkIdleTimer();\n    this._detachedScope.close(new Error('Frame was detached'));\n    for (const data of this._contextData.values()) {\n      if (data.context)\n        data.context.contextDestroyed('Frame was detached');\n      data.contextPromise.resolve({ destroyedReason: 'Frame was detached' });\n    }\n    if (this._parentFrame)\n      this._parentFrame._childFrames.delete(this);\n    this._parentFrame = null;\n  }\n\n  private async _callOnElementOnceMatches<T, R>(metadata: CallMetadata, selector: string, body: ElementCallback<T, R>, taskData: T, options: types.TimeoutOptions & types.StrictOptions & { mainWorld?: boolean } = {}, scope?: dom.ElementHandle): Promise<R> {\n    const callbackText = body.toString();\n    const controller = new ProgressController(metadata, this);\n    return controller.run(async progress => {\n      progress.log(`waiting for ${this._asLocator(selector)}`);\n      const promise = this.retryWithProgressAndTimeouts(progress, [0, 20, 50, 100, 100, 500], async continuePolling => {\n        const resolved = await this.selectors.resolveInjectedForSelector(selector, options, scope);\n        progress.throwIfAborted();\n        if (!resolved)\n          return continuePolling;\n        const { log, success, value } = await resolved.injected.evaluate((injected, { info, callbackText, taskData, callId, root }) => {\n          const callback = injected.eval(callbackText) as ElementCallback<T, R>;\n          const element = injected.querySelector(info.parsed, root || document, info.strict);\n          if (!element)\n            return { success: false };\n          const log = `  locator resolved to ${injected.previewNode(element)}`;\n          if (callId)\n            injected.markTargetElements(new Set([element]), callId);\n          return { log, success: true, value: callback(injected, element, taskData as T) };\n        }, { info: resolved.info, callbackText, taskData, callId: progress.metadata.id, root: resolved.frame === this ? scope : undefined });\n\n        if (log)\n          progress.log(log);\n        if (!success)\n          return continuePolling;\n        return value!;\n      });\n      return scope ? scope._context._raceAgainstContextDestroyed(promise) : promise;\n    }, this._page._timeoutSettings.timeout(options));\n  }\n\n  private _setContext(world: types.World, context: dom.FrameExecutionContext | null) {\n    const data = this._contextData.get(world)!;\n    data.context = context;\n    if (context)\n      data.contextPromise.resolve(context);\n    else\n      data.contextPromise = new ManualPromise();\n  }\n\n  _contextCreated(world: types.World, context: dom.FrameExecutionContext) {\n    const data = this._contextData.get(world)!;\n    // In case of multiple sessions to the same target, there's a race between\n    // connections so we might end up creating multiple isolated worlds.\n    // We can use either.\n    if (data.context) {\n      data.context.contextDestroyed('Execution context was destroyed, most likely because of a navigation');\n      this._setContext(world, null);\n    }\n    this._setContext(world, context);\n  }\n\n  _contextDestroyed(context: dom.FrameExecutionContext) {\n    // Sometimes we get this after detach, in which case we should not reset\n    // our already destroyed contexts to something that will never resolve.\n    if (this._detachedScope.isClosed())\n      return;\n    context.contextDestroyed('Execution context was destroyed, most likely because of a navigation');\n    for (const [world, data] of this._contextData) {\n      if (data.context === context)\n        this._setContext(world, null);\n    }\n  }\n\n  _startNetworkIdleTimer() {\n    assert(!this._networkIdleTimer);\n    // We should not start a timer and report networkidle in detached frames.\n    // This happens at least in Firefox for child frames, where we may get requestFinished\n    // after the frame was detached - probably a race in the Firefox itself.\n    if (this._firedLifecycleEvents.has('networkidle') || this._detachedScope.isClosed())\n      return;\n    this._networkIdleTimer = setTimeout(() => {\n      this._firedNetworkIdleSelf = true;\n      this._page.mainFrame()._recalculateNetworkIdle();\n    }, 500);\n  }\n\n  _stopNetworkIdleTimer() {\n    if (this._networkIdleTimer)\n      clearTimeout(this._networkIdleTimer);\n    this._networkIdleTimer = undefined;\n    this._firedNetworkIdleSelf = false;\n  }\n\n  async extendInjectedScript(source: string, arg?: any): Promise<js.JSHandle> {\n    const context = await this._context('main');\n    const injectedScriptHandle = await context.injectedScript();\n    return injectedScriptHandle.evaluateHandle((injectedScript, { source, arg }) => {\n      return injectedScript.extend(source, arg);\n    }, { source, arg });\n  }\n\n  async resetStorageForCurrentOriginBestEffort(newStorage: channels.OriginStorage | undefined) {\n    const context = await this._utilityContext();\n    await context.evaluate(async ({ ls }) => {\n      // Clean DOMStorage.\n      sessionStorage.clear();\n      localStorage.clear();\n\n      // Add new DOM Storage values.\n      for (const entry of ls || [])\n        localStorage[entry.name] = entry.value;\n\n      // Clean Service Workers\n      const registrations = navigator.serviceWorker ? await navigator.serviceWorker.getRegistrations() : [];\n      await Promise.all(registrations.map(async r => {\n        // Heuristic for service workers that stalled during main script fetch or importScripts:\n        // Waiting for them to finish unregistering takes ages so we do not await.\n        // However, they will unregister immediately after fetch finishes and should not affect next page load.\n        // Unfortunately, loading next page in Chromium still takes 5 seconds waiting for\n        // some operation on this bogus service worker to finish.\n        if (!r.installing && !r.waiting && !r.active)\n          r.unregister().catch(() => {});\n        else\n          await r.unregister().catch(() => {});\n      }));\n\n      // Clean IndexedDB\n      for (const db of await indexedDB.databases?.() || []) {\n        // Do not wait for the callback - it is called on timer in Chromium (slow).\n        if (db.name)\n          indexedDB.deleteDatabase(db.name!);\n      }\n    }, { ls: newStorage?.localStorage }).catch(() => {});\n  }\n\n  private _asLocator(selector: string) {\n    return asLocator(this._page.attribution.playwright.options.sdkLanguage, selector);\n  }\n}\n\nclass SignalBarrier {\n  private _progress: Progress | null;\n  private _protectCount = 0;\n  private _promise = new ManualPromise<void>();\n\n  constructor(progress: Progress | null) {\n    this._progress = progress;\n    this.retain();\n  }\n\n  waitFor(): PromiseLike<void> {\n    this.release();\n    return this._promise;\n  }\n\n  async addFrameNavigation(frame: Frame) {\n    // Auto-wait top-level navigations only.\n    if (frame.parentFrame())\n      return;\n    this.retain();\n    const waiter = helper.waitForEvent(null, frame, Frame.Events.InternalNavigation, (e: NavigationEvent) => {\n      if (!e.isPublic)\n        return false;\n      if (!e.error && this._progress)\n        this._progress.log(`  navigated to \"${frame._url}\"`);\n      return true;\n    });\n    await LongStandingScope.raceMultiple([\n      frame._page.openScope,\n      frame._detachedScope,\n    ], waiter.promise).catch(() => {});\n    waiter.dispose();\n    this.release();\n  }\n\n  retain() {\n    ++this._protectCount;\n  }\n\n  release() {\n    --this._protectCount;\n    if (!this._protectCount)\n      this._promise.resolve();\n  }\n}\n\nfunction verifyLifecycle(name: string, waitUntil: types.LifecycleEvent): types.LifecycleEvent {\n  if (waitUntil as unknown === 'networkidle0')\n    waitUntil = 'networkidle';\n  if (!types.kLifecycleEvents.has(waitUntil))\n    throw new Error(`${name}: expected one of (load|domcontentloaded|networkidle|commit)`);\n  return waitUntil;\n}\n\nfunction renderUnexpectedValue(expression: string, received: any): string {\n  if (expression === 'to.be.checked')\n    return received ? 'checked' : 'unchecked';\n  if (expression === 'to.be.unchecked')\n    return received ? 'unchecked' : 'checked';\n  if (expression === 'to.be.visible')\n    return received ? 'visible' : 'hidden';\n  if (expression === 'to.be.hidden')\n    return received ? 'hidden' : 'visible';\n  if (expression === 'to.be.enabled')\n    return received ? 'enabled' : 'disabled';\n  if (expression === 'to.be.disabled')\n    return received ? 'disabled' : 'enabled';\n  if (expression === 'to.be.editable')\n    return received ? 'editable' : 'readonly';\n  if (expression === 'to.be.readonly')\n    return received ? 'readonly' : 'editable';\n  if (expression === 'to.be.empty')\n    return received ? 'empty' : 'not empty';\n  if (expression === 'to.be.focused')\n    return received ? 'focused' : 'not focused';\n  return received;\n}\n"],"mappings":"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"}