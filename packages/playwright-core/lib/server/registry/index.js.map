{"version":3,"file":"index.js","names":["os","_interopRequireWildcard","require","_path","_interopRequireDefault","util","fs","_utilsBundle","_network","_userAgent","_utils","_fileUtils","_hostPlatform","_spawnAsync","_dependencies","_browserFetcher","_debugLogger","obj","__esModule","default","_getRequireWildcardCache","e","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","PACKAGE_PATH","path","join","__dirname","BIN_PATH","PLAYWRIGHT_CDN_MIRRORS","process","env","PW_TEST_CDN_THAT_SHOULD_WORK","length","cdn","EXECUTABLE_PATHS","DOWNLOAD_PATHS","undefined","registryDirectory","exports","result","envDefined","getFromENV","cacheDirectory","platform","XDG_CACHE_HOME","homedir","LOCALAPPDATA","Error","isAbsolute","resolve","cwd","isBrowserDirectory","browserDirectory","baseName","basename","browserName","allDownloadable","startsWith","readDescriptors","browsersJSON","map","name","revisionOverride","revisionOverrides","hostPlatform","revision","browserDirectoryPrefix","descriptor","browserVersion","installByDefault","dir","replace","Registry","constructor","_executables","descriptors","findExecutablePath","tokens","executablePathOrDie","sdkLanguage","installCommand","buildPlaywrightCLICommand","canAccessFile","currentDockerVersion","readDockerVersionSync","preferredDockerVersion","dockerVersion","dockerImageNameTemplate","isOutdatedDockerImage","dockerImageName","prettyMessage","driverVersion","wrapInASCIIBox","chromium","find","d","chromiumExecutable","push","type","directory","executablePath","installType","_validateHostRequirements","downloadURLs","_downloadURLs","_install","_downloadExecutable","_dependencyGroup","_isHermeticInstallation","chromiumTipOfTree","chromiumTipOfTreeExecutable","_createChromiumChannel","_installChromiumChannel","_installMSEdgeChannel","_createBidiChannel","firefox","firefoxExecutable","firefoxBeta","firefoxBetaExecutable","webkit","webkitExecutable","webkitLinuxLddDirectories","ffmpeg","ffmpegExecutable","Promise","android","lookAt","install","shouldThrow","suffix","prefixes","PROGRAMFILES","filter","Boolean","prefix","location","installation","executables","findExecutable","b","defaultExecutables","_addRequirementsAndDedupe","Set","executable","add","Array","from","linuxLddDirectories","dlOpenLibraries","windowsExeAndDllDirectories","validateDependenciesLinux","arch","validateDependenciesWindows","installDeps","executablesToInstallDeps","dryRun","targets","installDependenciesWindows","installDependenciesLinux","executablesToInstall","forceReinstall","promises","mkdir","recursive","lockfilePath","linksDir","releaseLock","lockfile","lock","retries","factor","onCompromised","err","message","writeFile","calculateSha1","_validateInstallationCache","embedderName","getEmbedderName","getAsBooleanFromENV","command","code","rmCommand","uninstall","all","links","readdir","catch","link","unlink","numberOfBrowsersLeft","validateHostRequirementsForExecutablesIfNeeded","stderr","write","_validateHostRequirementsForExecutableIfNeeded","kMaximumReValidationPeriod","markerFile","stat","then","Date","now","mtime","getTime","debugLogger","log","error","paths","downloadPathTemplate","downloadPath","format","mirror","downloadHostEnv","customHostOverride","isOfficiallySupportedPlatform","logPolitely","displayName","split","word","charAt","toUpperCase","slice","title","downloadFileName","downloadConnectionTimeoutEnv","downloadConnectionTimeout","downloadBrowserWithProgressBar","stack","channel","scripts","scriptArgs","products","lowercaseAllKeys","JSON","parse","fetchData","url","productName","product","searchConfig","darwin","artifact","win32","release","releases","architecture","artifacts","artifactname","scriptName","isPowerShell","endsWith","args","spawnAsync","stdio","elevatedPermissions","transformCommandsForRoot","console","usedBrowserPaths","fileName","linkPath","linkTarget","readFile","toString","usedBrowserPath","browserRevision","parseInt","shouldHaveMarkerFile","existsAsync","browserDirectoryToMarkerFilePath","downloadedBrowsers","file","directories","delete","removeFolders","parameters","packageManagerCommand","getPackageManagerExecCommand","installDefaultBrowsersForNpmInstall","defaultBrowserNames","registry","installBrowsersForNpmInstall","browsers","findChromiumChannel","json","isArray","key","value","entries","toLowerCase"],"sources":["../../../src/server/registry/index.ts"],"sourcesContent":["/**\n * Copyright 2017 Google Inc. All rights reserved.\n * Modifications copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as os from 'os';\nimport path from 'path';\nimport * as util from 'util';\nimport * as fs from 'fs';\nimport { lockfile } from '../../utilsBundle';\nimport { fetchData } from '../../utils/network';\nimport { getEmbedderName } from '../../utils/userAgent';\nimport { getFromENV, getAsBooleanFromENV, calculateSha1, wrapInASCIIBox, getPackageManagerExecCommand } from '../../utils';\nimport { removeFolders, existsAsync, canAccessFile } from '../../utils/fileUtils';\nimport { type HostPlatform, hostPlatform, isOfficiallySupportedPlatform } from '../../utils/hostPlatform';\nimport { spawnAsync } from '../../utils/spawnAsync';\nimport type { DependencyGroup } from './dependencies';\nimport { transformCommandsForRoot, dockerVersion, readDockerVersionSync } from './dependencies';\nimport { installDependenciesLinux, installDependenciesWindows, validateDependenciesLinux, validateDependenciesWindows } from './dependencies';\nimport { downloadBrowserWithProgressBar, logPolitely } from './browserFetcher';\nexport { writeDockerVersion } from './dependencies';\nimport { debugLogger } from '../../utils/debugLogger';\n\nconst PACKAGE_PATH = path.join(__dirname, '..', '..', '..');\nconst BIN_PATH = path.join(__dirname, '..', '..', '..', 'bin');\n\nconst PLAYWRIGHT_CDN_MIRRORS = [\n  'https://playwright.azureedge.net',\n  'https://playwright-akamai.azureedge.net',\n  'https://playwright-verizon.azureedge.net',\n];\n\nif (process.env.PW_TEST_CDN_THAT_SHOULD_WORK) {\n  for (let i = 0; i < PLAYWRIGHT_CDN_MIRRORS.length; i++) {\n    const cdn = PLAYWRIGHT_CDN_MIRRORS[i];\n    if (cdn !== process.env.PW_TEST_CDN_THAT_SHOULD_WORK)\n      PLAYWRIGHT_CDN_MIRRORS[i] = cdn + '.does-not-resolve.playwright.dev';\n  }\n}\n\nconst EXECUTABLE_PATHS = {\n  'chromium': {\n    'linux': ['chrome-linux', 'chrome'],\n    'mac': ['chrome-mac', 'Chromium.app', 'Contents', 'MacOS', 'Chromium'],\n    'win': ['chrome-win', 'chrome.exe'],\n  },\n  'firefox': {\n    'linux': ['firefox', 'firefox'],\n    'mac': ['firefox', 'Nightly.app', 'Contents', 'MacOS', 'firefox'],\n    'win': ['firefox', 'firefox.exe'],\n  },\n  'webkit': {\n    'linux': ['pw_run.sh'],\n    'mac': ['pw_run.sh'],\n    'win': ['Playwright.exe'],\n  },\n  'ffmpeg': {\n    'linux': ['ffmpeg-linux'],\n    'mac': ['ffmpeg-mac'],\n    'win': ['ffmpeg-win64.exe'],\n  },\n};\n\ntype DownloadPaths = Record<HostPlatform, string | undefined>;\nconst DOWNLOAD_PATHS: Record<BrowserName | InternalTool, DownloadPaths> = {\n  'chromium': {\n    '<unknown>': undefined,\n    'ubuntu18.04-x64': undefined,\n    'ubuntu20.04-x64': 'builds/chromium/%s/chromium-linux.zip',\n    'ubuntu22.04-x64': 'builds/chromium/%s/chromium-linux.zip',\n    'ubuntu24.04-x64': 'builds/chromium/%s/chromium-linux.zip',\n    'ubuntu18.04-arm64': undefined,\n    'ubuntu20.04-arm64': 'builds/chromium/%s/chromium-linux-arm64.zip',\n    'ubuntu22.04-arm64': 'builds/chromium/%s/chromium-linux-arm64.zip',\n    'ubuntu24.04-arm64': 'builds/chromium/%s/chromium-linux-arm64.zip',\n    'debian11-x64': 'builds/chromium/%s/chromium-linux.zip',\n    'debian11-arm64': 'builds/chromium/%s/chromium-linux-arm64.zip',\n    'debian12-x64': 'builds/chromium/%s/chromium-linux.zip',\n    'debian12-arm64': 'builds/chromium/%s/chromium-linux-arm64.zip',\n    'mac10.13': 'builds/chromium/%s/chromium-mac.zip',\n    'mac10.14': 'builds/chromium/%s/chromium-mac.zip',\n    'mac10.15': 'builds/chromium/%s/chromium-mac.zip',\n    'mac11': 'builds/chromium/%s/chromium-mac.zip',\n    'mac11-arm64': 'builds/chromium/%s/chromium-mac-arm64.zip',\n    'mac12': 'builds/chromium/%s/chromium-mac.zip',\n    'mac12-arm64': 'builds/chromium/%s/chromium-mac-arm64.zip',\n    'mac13': 'builds/chromium/%s/chromium-mac.zip',\n    'mac13-arm64': 'builds/chromium/%s/chromium-mac-arm64.zip',\n    'mac14': 'builds/chromium/%s/chromium-mac.zip',\n    'mac14-arm64': 'builds/chromium/%s/chromium-mac-arm64.zip',\n    'win64': 'builds/chromium/%s/chromium-win64.zip',\n  },\n  'chromium-tip-of-tree': {\n    '<unknown>': undefined,\n    'ubuntu18.04-x64': undefined,\n    'ubuntu20.04-x64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux.zip',\n    'ubuntu22.04-x64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux.zip',\n    'ubuntu24.04-x64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux.zip',\n    'ubuntu18.04-arm64': undefined,\n    'ubuntu20.04-arm64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux-arm64.zip',\n    'ubuntu22.04-arm64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux-arm64.zip',\n    'ubuntu24.04-arm64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux-arm64.zip',\n    'debian11-x64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux.zip',\n    'debian11-arm64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux-arm64.zip',\n    'debian12-x64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux.zip',\n    'debian12-arm64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux-arm64.zip',\n    'mac10.13': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac.zip',\n    'mac10.14': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac.zip',\n    'mac10.15': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac.zip',\n    'mac11': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac.zip',\n    'mac11-arm64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac-arm64.zip',\n    'mac12': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac.zip',\n    'mac12-arm64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac-arm64.zip',\n    'mac13': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac.zip',\n    'mac13-arm64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac-arm64.zip',\n    'mac14': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac.zip',\n    'mac14-arm64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac-arm64.zip',\n    'win64': 'builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-win64.zip',\n  },\n  'firefox': {\n    '<unknown>': undefined,\n    'ubuntu18.04-x64': undefined,\n    'ubuntu20.04-x64': 'builds/firefox/%s/firefox-ubuntu-20.04.zip',\n    'ubuntu22.04-x64': 'builds/firefox/%s/firefox-ubuntu-22.04.zip',\n    'ubuntu24.04-x64': 'builds/firefox/%s/firefox-ubuntu-24.04.zip',\n    'ubuntu18.04-arm64': undefined,\n    'ubuntu20.04-arm64': 'builds/firefox/%s/firefox-ubuntu-20.04-arm64.zip',\n    'ubuntu22.04-arm64': 'builds/firefox/%s/firefox-ubuntu-22.04-arm64.zip',\n    'ubuntu24.04-arm64': 'builds/firefox/%s/firefox-ubuntu-24.04-arm64.zip',\n    'debian11-x64': 'builds/firefox/%s/firefox-debian-11.zip',\n    'debian11-arm64': 'builds/firefox/%s/firefox-debian-11-arm64.zip',\n    'debian12-x64': 'builds/firefox/%s/firefox-debian-12.zip',\n    'debian12-arm64': 'builds/firefox/%s/firefox-debian-12-arm64.zip',\n    'mac10.13': 'builds/firefox/%s/firefox-mac.zip',\n    'mac10.14': 'builds/firefox/%s/firefox-mac.zip',\n    'mac10.15': 'builds/firefox/%s/firefox-mac.zip',\n    'mac11': 'builds/firefox/%s/firefox-mac.zip',\n    'mac11-arm64': 'builds/firefox/%s/firefox-mac-arm64.zip',\n    'mac12': 'builds/firefox/%s/firefox-mac.zip',\n    'mac12-arm64': 'builds/firefox/%s/firefox-mac-arm64.zip',\n    'mac13': 'builds/firefox/%s/firefox-mac.zip',\n    'mac13-arm64': 'builds/firefox/%s/firefox-mac-arm64.zip',\n    'mac14': 'builds/firefox/%s/firefox-mac.zip',\n    'mac14-arm64': 'builds/firefox/%s/firefox-mac-arm64.zip',\n    'win64': 'builds/firefox/%s/firefox-win64.zip',\n  },\n  'firefox-beta': {\n    '<unknown>': undefined,\n    'ubuntu18.04-x64': undefined,\n    'ubuntu20.04-x64': 'builds/firefox-beta/%s/firefox-beta-ubuntu-20.04.zip',\n    'ubuntu22.04-x64': 'builds/firefox-beta/%s/firefox-beta-ubuntu-22.04.zip',\n    'ubuntu24.04-x64': 'builds/firefox-beta/%s/firefox-beta-ubuntu-24.04.zip',\n    'ubuntu18.04-arm64': undefined,\n    'ubuntu20.04-arm64': undefined,\n    'ubuntu22.04-arm64': 'builds/firefox-beta/%s/firefox-beta-ubuntu-22.04-arm64.zip',\n    'ubuntu24.04-arm64': 'builds/firefox-beta/%s/firefox-beta-ubuntu-24.04-arm64.zip',\n    'debian11-x64': 'builds/firefox-beta/%s/firefox-beta-debian-11.zip',\n    'debian11-arm64': 'builds/firefox-beta/%s/firefox-beta-debian-11-arm64.zip',\n    'debian12-x64': 'builds/firefox-beta/%s/firefox-beta-debian-12.zip',\n    'debian12-arm64': 'builds/firefox-beta/%s/firefox-beta-debian-12-arm64.zip',\n    'mac10.13': 'builds/firefox-beta/%s/firefox-beta-mac.zip',\n    'mac10.14': 'builds/firefox-beta/%s/firefox-beta-mac.zip',\n    'mac10.15': 'builds/firefox-beta/%s/firefox-beta-mac.zip',\n    'mac11': 'builds/firefox-beta/%s/firefox-beta-mac.zip',\n    'mac11-arm64': 'builds/firefox-beta/%s/firefox-beta-mac-arm64.zip',\n    'mac12': 'builds/firefox-beta/%s/firefox-beta-mac.zip',\n    'mac12-arm64': 'builds/firefox-beta/%s/firefox-beta-mac-arm64.zip',\n    'mac13': 'builds/firefox-beta/%s/firefox-beta-mac.zip',\n    'mac13-arm64': 'builds/firefox-beta/%s/firefox-beta-mac-arm64.zip',\n    'mac14': 'builds/firefox-beta/%s/firefox-beta-mac.zip',\n    'mac14-arm64': 'builds/firefox-beta/%s/firefox-beta-mac-arm64.zip',\n    'win64': 'builds/firefox-beta/%s/firefox-beta-win64.zip',\n  },\n  'webkit': {\n    '<unknown>': undefined,\n    'ubuntu18.04-x64': undefined,\n    'ubuntu20.04-x64': 'builds/webkit/%s/webkit-ubuntu-20.04.zip',\n    'ubuntu22.04-x64': 'builds/webkit/%s/webkit-ubuntu-22.04.zip',\n    'ubuntu24.04-x64': 'builds/webkit/%s/webkit-ubuntu-24.04.zip',\n    'ubuntu18.04-arm64': undefined,\n    'ubuntu20.04-arm64': 'builds/webkit/%s/webkit-ubuntu-20.04-arm64.zip',\n    'ubuntu22.04-arm64': 'builds/webkit/%s/webkit-ubuntu-22.04-arm64.zip',\n    'ubuntu24.04-arm64': 'builds/webkit/%s/webkit-ubuntu-24.04-arm64.zip',\n    'debian11-x64': 'builds/webkit/%s/webkit-debian-11.zip',\n    'debian11-arm64': 'builds/webkit/%s/webkit-debian-11-arm64.zip',\n    'debian12-x64': 'builds/webkit/%s/webkit-debian-12.zip',\n    'debian12-arm64': 'builds/webkit/%s/webkit-debian-12-arm64.zip',\n    'mac10.13': undefined,\n    'mac10.14': 'builds/deprecated-webkit-mac-10.14/%s/deprecated-webkit-mac-10.14.zip',\n    'mac10.15': 'builds/deprecated-webkit-mac-10.15/%s/deprecated-webkit-mac-10.15.zip',\n    'mac11': 'builds/webkit/%s/webkit-mac-11.zip',\n    'mac11-arm64': 'builds/webkit/%s/webkit-mac-11-arm64.zip',\n    'mac12': 'builds/webkit/%s/webkit-mac-12.zip',\n    'mac12-arm64': 'builds/webkit/%s/webkit-mac-12-arm64.zip',\n    'mac13': 'builds/webkit/%s/webkit-mac-13.zip',\n    'mac13-arm64': 'builds/webkit/%s/webkit-mac-13-arm64.zip',\n    'mac14': 'builds/webkit/%s/webkit-mac-14.zip',\n    'mac14-arm64': 'builds/webkit/%s/webkit-mac-14-arm64.zip',\n    'win64': 'builds/webkit/%s/webkit-win64.zip',\n  },\n  'ffmpeg': {\n    '<unknown>': undefined,\n    'ubuntu18.04-x64': undefined,\n    'ubuntu20.04-x64': 'builds/ffmpeg/%s/ffmpeg-linux.zip',\n    'ubuntu22.04-x64': 'builds/ffmpeg/%s/ffmpeg-linux.zip',\n    'ubuntu24.04-x64': 'builds/ffmpeg/%s/ffmpeg-linux.zip',\n    'ubuntu18.04-arm64': undefined,\n    'ubuntu20.04-arm64': 'builds/ffmpeg/%s/ffmpeg-linux-arm64.zip',\n    'ubuntu22.04-arm64': 'builds/ffmpeg/%s/ffmpeg-linux-arm64.zip',\n    'ubuntu24.04-arm64': 'builds/ffmpeg/%s/ffmpeg-linux-arm64.zip',\n    'debian11-x64': 'builds/ffmpeg/%s/ffmpeg-linux.zip',\n    'debian11-arm64': 'builds/ffmpeg/%s/ffmpeg-linux-arm64.zip',\n    'debian12-x64': 'builds/ffmpeg/%s/ffmpeg-linux.zip',\n    'debian12-arm64': 'builds/ffmpeg/%s/ffmpeg-linux-arm64.zip',\n    'mac10.13': 'builds/ffmpeg/%s/ffmpeg-mac.zip',\n    'mac10.14': 'builds/ffmpeg/%s/ffmpeg-mac.zip',\n    'mac10.15': 'builds/ffmpeg/%s/ffmpeg-mac.zip',\n    'mac11': 'builds/ffmpeg/%s/ffmpeg-mac.zip',\n    'mac11-arm64': 'builds/ffmpeg/%s/ffmpeg-mac-arm64.zip',\n    'mac12': 'builds/ffmpeg/%s/ffmpeg-mac.zip',\n    'mac12-arm64': 'builds/ffmpeg/%s/ffmpeg-mac-arm64.zip',\n    'mac13': 'builds/ffmpeg/%s/ffmpeg-mac.zip',\n    'mac13-arm64': 'builds/ffmpeg/%s/ffmpeg-mac-arm64.zip',\n    'mac14': 'builds/ffmpeg/%s/ffmpeg-mac.zip',\n    'mac14-arm64': 'builds/ffmpeg/%s/ffmpeg-mac-arm64.zip',\n    'win64': 'builds/ffmpeg/%s/ffmpeg-win64.zip',\n  },\n  'android': {\n    '<unknown>': 'builds/android/%s/android.zip',\n    'ubuntu18.04-x64': undefined,\n    'ubuntu20.04-x64': 'builds/android/%s/android.zip',\n    'ubuntu22.04-x64': 'builds/android/%s/android.zip',\n    'ubuntu24.04-x64': 'builds/android/%s/android.zip',\n    'ubuntu18.04-arm64': undefined,\n    'ubuntu20.04-arm64': 'builds/android/%s/android.zip',\n    'ubuntu22.04-arm64': 'builds/android/%s/android.zip',\n    'ubuntu24.04-arm64': 'builds/android/%s/android.zip',\n    'debian11-x64': 'builds/android/%s/android.zip',\n    'debian11-arm64': 'builds/android/%s/android.zip',\n    'debian12-x64': 'builds/android/%s/android.zip',\n    'debian12-arm64': 'builds/android/%s/android.zip',\n    'mac10.13': 'builds/android/%s/android.zip',\n    'mac10.14': 'builds/android/%s/android.zip',\n    'mac10.15': 'builds/android/%s/android.zip',\n    'mac11': 'builds/android/%s/android.zip',\n    'mac11-arm64': 'builds/android/%s/android.zip',\n    'mac12': 'builds/android/%s/android.zip',\n    'mac12-arm64': 'builds/android/%s/android.zip',\n    'mac13': 'builds/android/%s/android.zip',\n    'mac13-arm64': 'builds/android/%s/android.zip',\n    'mac14': 'builds/android/%s/android.zip',\n    'mac14-arm64': 'builds/android/%s/android.zip',\n    'win64': 'builds/android/%s/android.zip',\n  },\n  // TODO(bidi): implement downloads.\n  'bidi': {\n  } as DownloadPaths,\n};\n\nexport const registryDirectory = (() => {\n  let result: string;\n\n  const envDefined = getFromENV('PLAYWRIGHT_BROWSERS_PATH');\n  if (envDefined === '0') {\n    result = path.join(__dirname, '..', '..', '..', '.local-browsers');\n  } else if (envDefined) {\n    result = envDefined;\n  } else {\n    let cacheDirectory: string;\n    if (process.platform === 'linux')\n      cacheDirectory = process.env.XDG_CACHE_HOME || path.join(os.homedir(), '.cache');\n    else if (process.platform === 'darwin')\n      cacheDirectory = path.join(os.homedir(), 'Library', 'Caches');\n    else if (process.platform === 'win32')\n      cacheDirectory = process.env.LOCALAPPDATA || path.join(os.homedir(), 'AppData', 'Local');\n    else\n      throw new Error('Unsupported platform: ' + process.platform);\n    result = path.join(cacheDirectory, 'ms-playwright');\n  }\n\n  if (!path.isAbsolute(result)) {\n    // It is important to resolve to the absolute path:\n    //   - for unzipping to work correctly;\n    //   - so that registry directory matches between installation and execution.\n    // INIT_CWD points to the root of `npm/yarn install` and is probably what\n    // the user meant when typing the relative path.\n    result = path.resolve(getFromENV('INIT_CWD') || process.cwd(), result);\n  }\n  return result;\n})();\n\nfunction isBrowserDirectory(browserDirectory: string): boolean {\n  const baseName = path.basename(browserDirectory);\n  for (const browserName of allDownloadable) {\n    if (baseName.startsWith(browserName + '-'))\n      return true;\n  }\n  return false;\n}\n\ntype BrowsersJSON = {\n  comment: string\n  browsers: {\n    name: string,\n    revision: string,\n    browserVersion?: string,\n    installByDefault: boolean,\n    revisionOverrides?: {[os: string]: string},\n  }[]\n};\n\ntype BrowsersJSONDescriptor = {\n  name: string,\n  revision: string,\n  browserVersion?: string,\n  installByDefault: boolean,\n  dir: string,\n};\n\nfunction readDescriptors(browsersJSON: BrowsersJSON) {\n  return (browsersJSON['browsers']).map(obj => {\n    const name = obj.name;\n    const revisionOverride = (obj.revisionOverrides || {})[hostPlatform];\n    const revision = revisionOverride || obj.revision;\n    const browserDirectoryPrefix = revisionOverride ? `${name}_${hostPlatform}_special` : `${name}`;\n    const descriptor: BrowsersJSONDescriptor = {\n      name,\n      revision,\n      // We only put browser version for the supported operating systems.\n      browserVersion: revisionOverride ? undefined : obj.browserVersion,\n      installByDefault: !!obj.installByDefault,\n      // Method `isBrowserDirectory` determines directory to be browser iff\n      // it starts with some browser name followed by '-'. Some browser names\n      // are prefixes of others, e.g. 'webkit' is a prefix of `webkit-technology-preview`.\n      // To avoid older registries erroneously removing 'webkit-technology-preview', we have to\n      // ensure that browser folders to never include dashes inside.\n      dir: path.join(registryDirectory, browserDirectoryPrefix.replace(/-/g, '_') + '-' + revision),\n    };\n    return descriptor;\n  });\n}\n\nexport type BrowserName = 'chromium' | 'firefox' | 'webkit' | 'bidi';\ntype InternalTool = 'ffmpeg' | 'firefox-beta' | 'chromium-tip-of-tree' | 'android';\ntype BidiChannel = 'bidi-firefox-stable';\ntype ChromiumChannel = 'chrome' | 'chrome-beta' | 'chrome-dev' | 'chrome-canary' | 'msedge' | 'msedge-beta' | 'msedge-dev' | 'msedge-canary';\nconst allDownloadable = ['chromium', 'firefox', 'webkit', 'ffmpeg', 'firefox-beta', 'chromium-tip-of-tree'];\n\nexport interface Executable {\n  type: 'browser' | 'tool' | 'channel';\n  name: BrowserName | InternalTool | ChromiumChannel | BidiChannel;\n  browserName: BrowserName | undefined;\n  installType: 'download-by-default' | 'download-on-demand' | 'install-script' | 'none';\n  directory: string | undefined;\n  downloadURLs?: string[],\n  browserVersion?: string,\n  executablePathOrDie(sdkLanguage: string): string;\n  executablePath(sdkLanguage: string): string | undefined;\n  _validateHostRequirements(sdkLanguage: string): Promise<void>;\n}\n\ninterface ExecutableImpl extends Executable {\n  _install?: () => Promise<void>;\n  _dependencyGroup?: DependencyGroup;\n  _isHermeticInstallation?: boolean;\n}\n\nexport class Registry {\n  private _executables: ExecutableImpl[];\n\n  constructor(browsersJSON: BrowsersJSON) {\n    const descriptors = readDescriptors(browsersJSON);\n    const findExecutablePath = (dir: string, name: keyof typeof EXECUTABLE_PATHS) => {\n      let tokens = undefined;\n      if (process.platform === 'linux')\n        tokens = EXECUTABLE_PATHS[name]['linux'];\n      else if (process.platform === 'darwin')\n        tokens = EXECUTABLE_PATHS[name]['mac'];\n      else if (process.platform === 'win32')\n        tokens = EXECUTABLE_PATHS[name]['win'];\n      return tokens ? path.join(dir, ...tokens) : undefined;\n    };\n    const executablePathOrDie = (name: string, e: string | undefined, installByDefault: boolean, sdkLanguage: string) => {\n      if (!e)\n        throw new Error(`${name} is not supported on ${hostPlatform}`);\n      const installCommand = buildPlaywrightCLICommand(sdkLanguage, `install${installByDefault ? '' : ' ' + name}`);\n      if (!canAccessFile(e)) {\n        const currentDockerVersion = readDockerVersionSync();\n        const preferredDockerVersion = currentDockerVersion ? dockerVersion(currentDockerVersion.dockerImageNameTemplate) : null;\n        const isOutdatedDockerImage = currentDockerVersion && preferredDockerVersion && currentDockerVersion.dockerImageName !== preferredDockerVersion.dockerImageName;\n        const prettyMessage = isOutdatedDockerImage ? [\n          `Looks like ${sdkLanguage === 'javascript' ? 'Playwright Test or ' : ''}Playwright was just updated to ${preferredDockerVersion.driverVersion}.`,\n          `Please update docker image as well.`,\n          `-  current: ${currentDockerVersion.dockerImageName}`,\n          `- required: ${preferredDockerVersion.dockerImageName}`,\n          ``,\n          `<3 Playwright Team`,\n        ].join('\\n') : [\n          `Looks like ${sdkLanguage === 'javascript' ? 'Playwright Test or ' : ''}Playwright was just installed or updated.`,\n          `Please run the following command to download new browser${installByDefault ? 's' : ''}:`,\n          ``,\n          `    ${installCommand}`,\n          ``,\n          `<3 Playwright Team`,\n        ].join('\\n');\n        throw new Error(`Executable doesn't exist at ${e}\\n${wrapInASCIIBox(prettyMessage, 1)}`);\n      }\n      return e;\n    };\n    this._executables = [];\n\n    const chromium = descriptors.find(d => d.name === 'chromium')!;\n    const chromiumExecutable = findExecutablePath(chromium.dir, 'chromium');\n    this._executables.push({\n      type: 'browser',\n      name: 'chromium',\n      browserName: 'chromium',\n      directory: chromium.dir,\n      executablePath: () => chromiumExecutable,\n      executablePathOrDie: (sdkLanguage: string) => executablePathOrDie('chromium', chromiumExecutable, chromium.installByDefault, sdkLanguage),\n      installType: chromium.installByDefault ? 'download-by-default' : 'download-on-demand',\n      _validateHostRequirements: (sdkLanguage: string) => this._validateHostRequirements(sdkLanguage, 'chromium', chromium.dir, ['chrome-linux'], [], ['chrome-win']),\n      downloadURLs: this._downloadURLs(chromium),\n      browserVersion: chromium.browserVersion,\n      _install: () => this._downloadExecutable(chromium, chromiumExecutable),\n      _dependencyGroup: 'chromium',\n      _isHermeticInstallation: true,\n    });\n\n    const chromiumTipOfTree = descriptors.find(d => d.name === 'chromium-tip-of-tree')!;\n    const chromiumTipOfTreeExecutable = findExecutablePath(chromiumTipOfTree.dir, 'chromium');\n    this._executables.push({\n      type: 'tool',\n      name: 'chromium-tip-of-tree',\n      browserName: 'chromium',\n      directory: chromiumTipOfTree.dir,\n      executablePath: () => chromiumTipOfTreeExecutable,\n      executablePathOrDie: (sdkLanguage: string) => executablePathOrDie('chromium-tip-of-tree', chromiumTipOfTreeExecutable, chromiumTipOfTree.installByDefault, sdkLanguage),\n      installType: chromiumTipOfTree.installByDefault ? 'download-by-default' : 'download-on-demand',\n      _validateHostRequirements: (sdkLanguage: string) => this._validateHostRequirements(sdkLanguage, 'chromium', chromiumTipOfTree.dir, ['chrome-linux'], [], ['chrome-win']),\n      downloadURLs: this._downloadURLs(chromiumTipOfTree),\n      browserVersion: chromiumTipOfTree.browserVersion,\n      _install: () => this._downloadExecutable(chromiumTipOfTree, chromiumTipOfTreeExecutable),\n      _dependencyGroup: 'chromium',\n      _isHermeticInstallation: true,\n    });\n\n    this._executables.push(this._createChromiumChannel('chrome', {\n      'linux': '/opt/google/chrome/chrome',\n      'darwin': '/Applications/Google Chrome.app/Contents/MacOS/Google Chrome',\n      'win32': `\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe`,\n    }, () => this._installChromiumChannel('chrome', {\n      'linux': 'reinstall_chrome_stable_linux.sh',\n      'darwin': 'reinstall_chrome_stable_mac.sh',\n      'win32': 'reinstall_chrome_stable_win.ps1',\n    })));\n\n    this._executables.push(this._createChromiumChannel('chrome-beta', {\n      'linux': '/opt/google/chrome-beta/chrome',\n      'darwin': '/Applications/Google Chrome Beta.app/Contents/MacOS/Google Chrome Beta',\n      'win32': `\\\\Google\\\\Chrome Beta\\\\Application\\\\chrome.exe`,\n    }, () => this._installChromiumChannel('chrome-beta', {\n      'linux': 'reinstall_chrome_beta_linux.sh',\n      'darwin': 'reinstall_chrome_beta_mac.sh',\n      'win32': 'reinstall_chrome_beta_win.ps1',\n    })));\n\n    this._executables.push(this._createChromiumChannel('chrome-dev', {\n      'linux': '/opt/google/chrome-unstable/chrome',\n      'darwin': '/Applications/Google Chrome Dev.app/Contents/MacOS/Google Chrome Dev',\n      'win32': `\\\\Google\\\\Chrome Dev\\\\Application\\\\chrome.exe`,\n    }));\n\n    this._executables.push(this._createChromiumChannel('chrome-canary', {\n      'linux': '',\n      'darwin': '/Applications/Google Chrome Canary.app/Contents/MacOS/Google Chrome Canary',\n      'win32': `\\\\Google\\\\Chrome SxS\\\\Application\\\\chrome.exe`,\n    }));\n\n    this._executables.push(this._createChromiumChannel('msedge', {\n      'linux': '/opt/microsoft/msedge/msedge',\n      'darwin': '/Applications/Microsoft Edge.app/Contents/MacOS/Microsoft Edge',\n      'win32': `\\\\Microsoft\\\\Edge\\\\Application\\\\msedge.exe`,\n    }, () => this._installMSEdgeChannel('msedge', {\n      'linux': 'reinstall_msedge_stable_linux.sh',\n      'darwin': 'reinstall_msedge_stable_mac.sh',\n      'win32': 'reinstall_msedge_stable_win.ps1',\n    })));\n\n    this._executables.push(this._createChromiumChannel('msedge-beta', {\n      'linux': '/opt/microsoft/msedge-beta/msedge',\n      'darwin': '/Applications/Microsoft Edge Beta.app/Contents/MacOS/Microsoft Edge Beta',\n      'win32': `\\\\Microsoft\\\\Edge Beta\\\\Application\\\\msedge.exe`,\n    }, () => this._installMSEdgeChannel('msedge-beta', {\n      'darwin': 'reinstall_msedge_beta_mac.sh',\n      'linux': 'reinstall_msedge_beta_linux.sh',\n      'win32': 'reinstall_msedge_beta_win.ps1',\n    })));\n\n    this._executables.push(this._createChromiumChannel('msedge-dev', {\n      'linux': '/opt/microsoft/msedge-dev/msedge',\n      'darwin': '/Applications/Microsoft Edge Dev.app/Contents/MacOS/Microsoft Edge Dev',\n      'win32': `\\\\Microsoft\\\\Edge Dev\\\\Application\\\\msedge.exe`,\n    }, () => this._installMSEdgeChannel('msedge-dev', {\n      'darwin': 'reinstall_msedge_dev_mac.sh',\n      'linux': 'reinstall_msedge_dev_linux.sh',\n      'win32': 'reinstall_msedge_dev_win.ps1',\n    })));\n\n    this._executables.push(this._createChromiumChannel('msedge-canary', {\n      'linux': '',\n      'darwin': '/Applications/Microsoft Edge Canary.app/Contents/MacOS/Microsoft Edge Canary',\n      'win32': `\\\\Microsoft\\\\Edge SxS\\\\Application\\\\msedge.exe`,\n    }));\n\n    this._executables.push(this._createBidiChannel('bidi-firefox-stable', {\n      'linux': '/usr/bin/firefox',\n      'darwin': '/Applications/Firefox.app/Contents/MacOS/firefox',\n      'win32': '\\\\Mozilla Firefox\\\\firefox.exe',\n    }));\n\n    const firefox = descriptors.find(d => d.name === 'firefox')!;\n    const firefoxExecutable = findExecutablePath(firefox.dir, 'firefox');\n    this._executables.push({\n      type: 'browser',\n      name: 'firefox',\n      browserName: 'firefox',\n      directory: firefox.dir,\n      executablePath: () => firefoxExecutable,\n      executablePathOrDie: (sdkLanguage: string) => executablePathOrDie('firefox', firefoxExecutable, firefox.installByDefault, sdkLanguage),\n      installType: firefox.installByDefault ? 'download-by-default' : 'download-on-demand',\n      _validateHostRequirements: (sdkLanguage: string) => this._validateHostRequirements(sdkLanguage, 'firefox', firefox.dir, ['firefox'], [], ['firefox']),\n      downloadURLs: this._downloadURLs(firefox),\n      browserVersion: firefox.browserVersion,\n      _install: () => this._downloadExecutable(firefox, firefoxExecutable),\n      _dependencyGroup: 'firefox',\n      _isHermeticInstallation: true,\n    });\n\n    const firefoxBeta = descriptors.find(d => d.name === 'firefox-beta')!;\n    const firefoxBetaExecutable = findExecutablePath(firefoxBeta.dir, 'firefox');\n    this._executables.push({\n      type: 'tool',\n      name: 'firefox-beta',\n      browserName: 'firefox',\n      directory: firefoxBeta.dir,\n      executablePath: () => firefoxBetaExecutable,\n      executablePathOrDie: (sdkLanguage: string) => executablePathOrDie('firefox-beta', firefoxBetaExecutable, firefoxBeta.installByDefault, sdkLanguage),\n      installType: firefoxBeta.installByDefault ? 'download-by-default' : 'download-on-demand',\n      _validateHostRequirements: (sdkLanguage: string) => this._validateHostRequirements(sdkLanguage, 'firefox', firefoxBeta.dir, ['firefox'], [], ['firefox']),\n      downloadURLs: this._downloadURLs(firefoxBeta),\n      browserVersion: firefoxBeta.browserVersion,\n      _install: () => this._downloadExecutable(firefoxBeta, firefoxBetaExecutable),\n      _dependencyGroup: 'firefox',\n      _isHermeticInstallation: true,\n    });\n\n    const webkit = descriptors.find(d => d.name === 'webkit')!;\n    const webkitExecutable = findExecutablePath(webkit.dir, 'webkit');\n    const webkitLinuxLddDirectories = [\n      path.join('minibrowser-gtk'),\n      path.join('minibrowser-gtk', 'bin'),\n      path.join('minibrowser-gtk', 'lib'),\n      path.join('minibrowser-gtk', 'sys', 'lib'),\n      path.join('minibrowser-wpe'),\n      path.join('minibrowser-wpe', 'bin'),\n      path.join('minibrowser-wpe', 'lib'),\n      path.join('minibrowser-wpe', 'sys', 'lib'),\n    ];\n    this._executables.push({\n      type: 'browser',\n      name: 'webkit',\n      browserName: 'webkit',\n      directory: webkit.dir,\n      executablePath: () => webkitExecutable,\n      executablePathOrDie: (sdkLanguage: string) => executablePathOrDie('webkit', webkitExecutable, webkit.installByDefault, sdkLanguage),\n      installType: webkit.installByDefault ? 'download-by-default' : 'download-on-demand',\n      _validateHostRequirements: (sdkLanguage: string) => this._validateHostRequirements(sdkLanguage, 'webkit', webkit.dir, webkitLinuxLddDirectories, ['libGLESv2.so.2', 'libx264.so'], ['']),\n      downloadURLs: this._downloadURLs(webkit),\n      browserVersion: webkit.browserVersion,\n      _install: () => this._downloadExecutable(webkit, webkitExecutable),\n      _dependencyGroup: 'webkit',\n      _isHermeticInstallation: true,\n    });\n\n    const ffmpeg = descriptors.find(d => d.name === 'ffmpeg')!;\n    const ffmpegExecutable = findExecutablePath(ffmpeg.dir, 'ffmpeg');\n    this._executables.push({\n      type: 'tool',\n      name: 'ffmpeg',\n      browserName: undefined,\n      directory: ffmpeg.dir,\n      executablePath: () => ffmpegExecutable,\n      executablePathOrDie: (sdkLanguage: string) => executablePathOrDie('ffmpeg', ffmpegExecutable, ffmpeg.installByDefault, sdkLanguage),\n      installType: ffmpeg.installByDefault ? 'download-by-default' : 'download-on-demand',\n      _validateHostRequirements: () => Promise.resolve(),\n      downloadURLs: this._downloadURLs(ffmpeg),\n      _install: () => this._downloadExecutable(ffmpeg, ffmpegExecutable),\n      _dependencyGroup: 'tools',\n      _isHermeticInstallation: true,\n    });\n    const android = descriptors.find(d => d.name === 'android')!;\n    this._executables.push({\n      type: 'tool',\n      name: 'android',\n      browserName: undefined,\n      directory: android.dir,\n      executablePath: () => undefined,\n      executablePathOrDie: () => '',\n      installType: 'download-on-demand',\n      _validateHostRequirements: () => Promise.resolve(),\n      downloadURLs: this._downloadURLs(android),\n      _install: () => this._downloadExecutable(android),\n      _dependencyGroup: 'tools',\n      _isHermeticInstallation: true,\n    });\n\n    this._executables.push({\n      type: 'browser',\n      name: 'bidi',\n      browserName: 'bidi',\n      directory: undefined,\n      executablePath: () => undefined,\n      executablePathOrDie: () => '',\n      installType: 'none',\n      _validateHostRequirements: () => Promise.resolve(),\n      downloadURLs: [],\n      _install: () => Promise.resolve(),\n      _dependencyGroup: 'tools',\n      _isHermeticInstallation: true,\n    });\n  }\n\n  private _createChromiumChannel(name: ChromiumChannel, lookAt: Record<'linux' | 'darwin' | 'win32', string>, install?: () => Promise<void>): ExecutableImpl {\n    const executablePath = (sdkLanguage: string, shouldThrow: boolean) => {\n      const suffix = lookAt[process.platform as 'linux' | 'darwin' | 'win32'];\n      if (!suffix) {\n        if (shouldThrow)\n          throw new Error(`Chromium distribution '${name}' is not supported on ${process.platform}`);\n        return undefined;\n      }\n      const prefixes = (process.platform === 'win32' ? [\n        process.env.LOCALAPPDATA, process.env.PROGRAMFILES, process.env['PROGRAMFILES(X86)']\n      ].filter(Boolean) : ['']) as string[];\n\n      for (const prefix of prefixes) {\n        const executablePath = path.join(prefix, suffix);\n        if (canAccessFile(executablePath))\n          return executablePath;\n      }\n      if (!shouldThrow)\n        return undefined;\n\n      const location = prefixes.length ? ` at ${path.join(prefixes[0], suffix)}` : ``;\n      const installation = install ? `\\nRun \"${buildPlaywrightCLICommand(sdkLanguage, 'install ' + name)}\"` : '';\n      throw new Error(`Chromium distribution '${name}' is not found${location}${installation}`);\n    };\n    return {\n      type: 'channel',\n      name,\n      browserName: 'chromium',\n      directory: undefined,\n      executablePath: (sdkLanguage: string) => executablePath(sdkLanguage, false),\n      executablePathOrDie: (sdkLanguage: string) => executablePath(sdkLanguage, true)!,\n      installType: install ? 'install-script' : 'none',\n      _validateHostRequirements: () => Promise.resolve(),\n      _isHermeticInstallation: false,\n      _install: install,\n    };\n  }\n\n  private _createBidiChannel(name: BidiChannel, lookAt: Record<'linux' | 'darwin' | 'win32', string>, install?: () => Promise<void>): ExecutableImpl {\n    const executablePath = (sdkLanguage: string, shouldThrow: boolean) => {\n      const suffix = lookAt[process.platform as 'linux' | 'darwin' | 'win32'];\n      if (!suffix) {\n        if (shouldThrow)\n          throw new Error(`Firefox distribution '${name}' is not supported on ${process.platform}`);\n        return undefined;\n      }\n      const prefixes = (process.platform === 'win32' ? [\n        process.env.LOCALAPPDATA, process.env.PROGRAMFILES, process.env['PROGRAMFILES(X86)']\n      ].filter(Boolean) : ['']) as string[];\n\n      for (const prefix of prefixes) {\n        const executablePath = path.join(prefix, suffix);\n        if (canAccessFile(executablePath))\n          return executablePath;\n      }\n      if (!shouldThrow)\n        return undefined;\n\n      const location = prefixes.length ? ` at ${path.join(prefixes[0], suffix)}` : ``;\n      const installation = install ? `\\nRun \"${buildPlaywrightCLICommand(sdkLanguage, 'install ' + name)}\"` : '';\n      throw new Error(`Firefox distribution '${name}' is not found${location}${installation}`);\n    };\n    return {\n      type: 'channel',\n      name,\n      browserName: 'bidi',\n      directory: undefined,\n      executablePath: (sdkLanguage: string) => executablePath(sdkLanguage, false),\n      executablePathOrDie: (sdkLanguage: string) => executablePath(sdkLanguage, true)!,\n      installType: install ? 'install-script' : 'none',\n      _validateHostRequirements: () => Promise.resolve(),\n      _isHermeticInstallation: false,\n      _install: install,\n    };\n  }\n\n  executables(): Executable[] {\n    return this._executables;\n  }\n\n  findExecutable(name: BrowserName): Executable;\n  findExecutable(name: string): Executable | undefined;\n  findExecutable(name: string): Executable | undefined {\n    return this._executables.find(b => b.name === name);\n  }\n\n  defaultExecutables(): Executable[] {\n    return this._executables.filter(e => e.installType === 'download-by-default');\n  }\n\n  private _addRequirementsAndDedupe(executables: Executable[]): ExecutableImpl[] {\n    const set = new Set<ExecutableImpl>();\n    for (const executable of executables as ExecutableImpl[]) {\n      set.add(executable);\n      if (executable.browserName === 'chromium')\n        set.add(this.findExecutable('ffmpeg')!);\n    }\n    return Array.from(set);\n  }\n\n  private async _validateHostRequirements(sdkLanguage: string, browserName: BrowserName, browserDirectory: string, linuxLddDirectories: string[], dlOpenLibraries: string[], windowsExeAndDllDirectories: string[]) {\n    if (os.platform() === 'linux')\n      return await validateDependenciesLinux(sdkLanguage, linuxLddDirectories.map(d => path.join(browserDirectory, d)), dlOpenLibraries);\n    if (os.platform() === 'win32' && os.arch() === 'x64')\n      return await validateDependenciesWindows(windowsExeAndDllDirectories.map(d => path.join(browserDirectory, d)));\n  }\n\n  async installDeps(executablesToInstallDeps: Executable[], dryRun: boolean) {\n    const executables = this._addRequirementsAndDedupe(executablesToInstallDeps);\n    const targets = new Set<DependencyGroup>();\n    for (const executable of executables) {\n      if (executable._dependencyGroup)\n        targets.add(executable._dependencyGroup);\n    }\n    targets.add('tools');\n    if (os.platform() === 'win32')\n      return await installDependenciesWindows(targets, dryRun);\n    if (os.platform() === 'linux')\n      return await installDependenciesLinux(targets, dryRun);\n  }\n\n  async install(executablesToInstall: Executable[], forceReinstall: boolean) {\n    const executables = this._addRequirementsAndDedupe(executablesToInstall);\n    await fs.promises.mkdir(registryDirectory, { recursive: true });\n    const lockfilePath = path.join(registryDirectory, '__dirlock');\n    const linksDir = path.join(registryDirectory, '.links');\n\n    let releaseLock;\n    try {\n      releaseLock = await lockfile.lock(registryDirectory, {\n        retries: {\n          // Retry 20 times during 10 minutes with\n          // exponential back-off.\n          // See documentation at: https://www.npmjs.com/package/retry#retrytimeoutsoptions\n          retries: 20,\n          factor: 1.27579,\n        },\n        onCompromised: (err: Error) => {\n          throw new Error(`${err.message} Path: ${lockfilePath}`);\n        },\n        lockfilePath,\n      });\n      // Create a link first, so that cache validation does not remove our own browsers.\n      await fs.promises.mkdir(linksDir, { recursive: true });\n      await fs.promises.writeFile(path.join(linksDir, calculateSha1(PACKAGE_PATH)), PACKAGE_PATH);\n\n      // Remove stale browsers.\n      await this._validateInstallationCache(linksDir);\n\n      // Install browsers for this package.\n      for (const executable of executables) {\n        if (!executable._install)\n          throw new Error(`ERROR: Playwright does not support installing ${executable.name}`);\n\n        const { embedderName } = getEmbedderName();\n        if (!getAsBooleanFromENV('CI') && !executable._isHermeticInstallation && !forceReinstall && executable.executablePath(embedderName)) {\n          const command = buildPlaywrightCLICommand(embedderName, 'install --force ' + executable.name);\n          throw new Error('\\n' + wrapInASCIIBox([\n            `ATTENTION: \"${executable.name}\" is already installed on the system!`,\n            ``,\n            `\"${executable.name}\" installation is not hermetic; installing newer version`,\n            `requires *removal* of a current installation first.`,\n            ``,\n            `To *uninstall* current version and re-install latest \"${executable.name}\":`,\n            ``,\n            `- Close all running instances of \"${executable.name}\", if any`,\n            `- Use \"--force\" to install browser:`,\n            ``,\n            `    ${command}`,\n            ``,\n            `<3 Playwright Team`,\n          ].join('\\n'), 1));\n        }\n        await executable._install();\n      }\n    } catch (e) {\n      if (e.code === 'ELOCKED') {\n        const rmCommand = process.platform === 'win32' ? 'rm -R' : 'rm -rf';\n        throw new Error('\\n' + wrapInASCIIBox([\n          `An active lockfile is found at:`,\n          ``,\n          `  ${lockfilePath}`,\n          ``,\n          `Either:`,\n          `- wait a few minutes if other Playwright is installing browsers in parallel`,\n          `- remove lock manually with:`,\n          ``,\n          `    ${rmCommand} ${lockfilePath}`,\n          ``,\n          `<3 Playwright Team`,\n        ].join('\\n'), 1));\n      } else {\n        throw e;\n      }\n    } finally {\n      if (releaseLock)\n        await releaseLock();\n    }\n  }\n\n  async uninstall(all: boolean): Promise<{ numberOfBrowsersLeft: number }> {\n    const linksDir = path.join(registryDirectory, '.links');\n    if (all) {\n      const links = await fs.promises.readdir(linksDir).catch(() => []);\n      for (const link of links)\n        await fs.promises.unlink(path.join(linksDir, link));\n    } else {\n      await fs.promises.unlink(path.join(linksDir, calculateSha1(PACKAGE_PATH))).catch(() => {});\n    }\n\n    // Remove stale browsers.\n    await this._validateInstallationCache(linksDir);\n    return {\n      numberOfBrowsersLeft: (await fs.promises.readdir(registryDirectory).catch(() => [])).filter(browserDirectory => isBrowserDirectory(browserDirectory)).length\n    };\n  }\n\n  async validateHostRequirementsForExecutablesIfNeeded(executables: Executable[], sdkLanguage: string) {\n    if (getAsBooleanFromENV('PLAYWRIGHT_SKIP_VALIDATE_HOST_REQUIREMENTS')) {\n      process.stderr.write('Skipping host requirements validation logic because `PLAYWRIGHT_SKIP_VALIDATE_HOST_REQUIREMENTS` env variable is set.\\n');\n      return;\n    }\n    for (const executable of executables)\n      await this._validateHostRequirementsForExecutableIfNeeded(executable, sdkLanguage);\n  }\n\n  private async _validateHostRequirementsForExecutableIfNeeded(executable: Executable, sdkLanguage: string) {\n    const kMaximumReValidationPeriod = 30 * 24 * 60 * 60 * 1000; // 30 days\n    // Executable does not require validation.\n    if (!executable.directory)\n      return;\n    const markerFile = path.join(executable.directory, 'DEPENDENCIES_VALIDATED');\n    // Executable is already validated.\n    if (await fs.promises.stat(markerFile).then(stat => (Date.now() - stat.mtime.getTime()) < kMaximumReValidationPeriod).catch(() => false))\n      return;\n\n    debugLogger.log('install', `validating host requirements for \"${executable.name}\"`);\n    try {\n      await executable._validateHostRequirements(sdkLanguage);\n      debugLogger.log('install', `validation passed for ${executable.name}`);\n    } catch (error) {\n      debugLogger.log('install', `validation failed for ${executable.name}`);\n      throw error;\n    }\n\n    await fs.promises.writeFile(markerFile, '').catch(() => {});\n  }\n\n  private _downloadURLs(descriptor: BrowsersJSONDescriptor): string[] {\n    const paths = (DOWNLOAD_PATHS as any)[descriptor.name];\n    const downloadPathTemplate: string|undefined = paths[hostPlatform] || paths['<unknown>'];\n    if (!downloadPathTemplate)\n      return [];\n    const downloadPath = util.format(downloadPathTemplate, descriptor.revision);\n\n    let downloadURLs = PLAYWRIGHT_CDN_MIRRORS.map(mirror => `${mirror}/${downloadPath}`) ;\n    let downloadHostEnv;\n    if (descriptor.name.startsWith('chromium'))\n      downloadHostEnv = 'PLAYWRIGHT_CHROMIUM_DOWNLOAD_HOST';\n    else if (descriptor.name.startsWith('firefox'))\n      downloadHostEnv = 'PLAYWRIGHT_FIREFOX_DOWNLOAD_HOST';\n    else if (descriptor.name.startsWith('webkit'))\n      downloadHostEnv = 'PLAYWRIGHT_WEBKIT_DOWNLOAD_HOST';\n\n    const customHostOverride = (downloadHostEnv && getFromENV(downloadHostEnv)) || getFromENV('PLAYWRIGHT_DOWNLOAD_HOST');\n    if (customHostOverride)\n      downloadURLs = [`${customHostOverride}/${downloadPath}`];\n    return downloadURLs;\n  }\n\n  private async _downloadExecutable(descriptor: BrowsersJSONDescriptor, executablePath?: string) {\n    const downloadURLs = this._downloadURLs(descriptor);\n    if (!downloadURLs.length)\n      throw new Error(`ERROR: Playwright does not support ${descriptor.name} on ${hostPlatform}`);\n    if (!isOfficiallySupportedPlatform)\n      logPolitely(`BEWARE: your OS is not officially supported by Playwright; downloading fallback build for ${hostPlatform}.`);\n\n    const displayName = descriptor.name.split('-').map(word => {\n      return word === 'ffmpeg' ? 'FFMPEG' : word.charAt(0).toUpperCase() + word.slice(1);\n    }).join(' ');\n    const title = descriptor.browserVersion\n      ? `${displayName} ${descriptor.browserVersion} (playwright build v${descriptor.revision})`\n      : `${displayName} playwright build v${descriptor.revision}`;\n\n    const downloadFileName = `playwright-download-${descriptor.name}-${hostPlatform}-${descriptor.revision}.zip`;\n    const downloadConnectionTimeoutEnv = getFromENV('PLAYWRIGHT_DOWNLOAD_CONNECTION_TIMEOUT');\n    const downloadConnectionTimeout = +(downloadConnectionTimeoutEnv || '0') || 30_000;\n    await downloadBrowserWithProgressBar(title, descriptor.dir, executablePath, downloadURLs, downloadFileName, downloadConnectionTimeout).catch(e => {\n      throw new Error(`Failed to download ${title}, caused by\\n${e.stack}`);\n    });\n  }\n\n  private async _installMSEdgeChannel(channel: 'msedge'|'msedge-beta'|'msedge-dev', scripts: Record<'linux' | 'darwin' | 'win32', string>) {\n    const scriptArgs: string[] = [];\n    if (process.platform !== 'linux') {\n      const products = lowercaseAllKeys(JSON.parse(await fetchData({ url: 'https://edgeupdates.microsoft.com/api/products' })));\n\n      const productName = {\n        'msedge': 'Stable',\n        'msedge-beta': 'Beta',\n        'msedge-dev': 'Dev',\n      }[channel];\n      const product = products.find((product: any) => product.product === productName);\n      const searchConfig = ({\n        darwin: { platform: 'MacOS', arch: 'universal', artifact: 'pkg' },\n        win32: { platform: 'Windows', arch: 'x64', artifact: 'msi' },\n      } as any)[process.platform];\n      const release = searchConfig ? product.releases.find((release: any) => release.platform === searchConfig.platform && release.architecture === searchConfig.arch && release.artifacts.length > 0) : null;\n      const artifact = release ? release.artifacts.find((artifact: any) => artifact.artifactname === searchConfig.artifact) : null;\n      if (artifact)\n        scriptArgs.push(artifact.location /* url */);\n      else\n        throw new Error(`Cannot install ${channel} on ${process.platform}`);\n    }\n    await this._installChromiumChannel(channel, scripts, scriptArgs);\n  }\n\n  private async _installChromiumChannel(channel: string, scripts: Record<'linux' | 'darwin' | 'win32', string>, scriptArgs: string[] = []) {\n    const scriptName = scripts[process.platform as 'linux' | 'darwin' | 'win32'];\n    if (!scriptName)\n      throw new Error(`Cannot install ${channel} on ${process.platform}`);\n    const cwd = BIN_PATH;\n    const isPowerShell = scriptName.endsWith('.ps1');\n    if (isPowerShell) {\n      const args = [\n        '-ExecutionPolicy', 'Bypass', '-File',\n        path.join(BIN_PATH, scriptName),\n        ...scriptArgs\n      ];\n      const { code } = await spawnAsync('powershell.exe', args, { cwd, stdio: 'inherit' });\n      if (code !== 0)\n        throw new Error(`Failed to install ${channel}`);\n    } else {\n      const { command, args, elevatedPermissions } = await transformCommandsForRoot([`bash \"${path.join(BIN_PATH, scriptName)}\" ${scriptArgs.join('')}`]);\n      if (elevatedPermissions)\n        console.log('Switching to root user to install dependencies...'); // eslint-disable-line no-console\n      const { code } = await spawnAsync(command, args, { cwd, stdio: 'inherit' });\n      if (code !== 0)\n        throw new Error(`Failed to install ${channel}`);\n    }\n  }\n\n  private async _validateInstallationCache(linksDir: string) {\n    // 1. Collect used downloads and package descriptors.\n    const usedBrowserPaths: Set<string> = new Set();\n    for (const fileName of await fs.promises.readdir(linksDir)) {\n      const linkPath = path.join(linksDir, fileName);\n      let linkTarget = '';\n      try {\n        linkTarget = (await fs.promises.readFile(linkPath)).toString();\n        const browsersJSON = require(path.join(linkTarget, 'browsers.json'));\n        const descriptors = readDescriptors(browsersJSON);\n        for (const browserName of allDownloadable) {\n          // We retain browsers if they are found in the descriptor.\n          // Note, however, that there are older versions out in the wild that rely on\n          // the \"download\" field in the browser descriptor and use its value\n          // to retain and download browsers.\n          // As of v1.10, we decided to abandon \"download\" field.\n          const descriptor = descriptors.find(d => d.name === browserName);\n          if (!descriptor)\n            continue;\n          const usedBrowserPath = descriptor.dir;\n          const browserRevision = parseInt(descriptor.revision, 10);\n          // Old browser installations don't have marker file.\n          // We switched chromium from 999999 to 1000, 300000 is the new Y2K.\n          const shouldHaveMarkerFile = (browserName === 'chromium' && (browserRevision >= 786218 || browserRevision < 300000)) ||\n              (browserName === 'firefox' && browserRevision >= 1128) ||\n              (browserName === 'webkit' && browserRevision >= 1307) ||\n              // All new applications have a marker file right away.\n              (browserName !== 'firefox' && browserName !== 'chromium' && browserName !== 'webkit');\n          if (!shouldHaveMarkerFile || (await existsAsync(browserDirectoryToMarkerFilePath(usedBrowserPath))))\n            usedBrowserPaths.add(usedBrowserPath);\n        }\n      } catch (e) {\n        await fs.promises.unlink(linkPath).catch(e => {});\n      }\n    }\n\n    // 2. Delete all unused browsers.\n    if (!getAsBooleanFromENV('PLAYWRIGHT_SKIP_BROWSER_GC')) {\n      let downloadedBrowsers = (await fs.promises.readdir(registryDirectory)).map(file => path.join(registryDirectory, file));\n      downloadedBrowsers = downloadedBrowsers.filter(file => isBrowserDirectory(file));\n      const directories = new Set<string>(downloadedBrowsers);\n      for (const browserDirectory of usedBrowserPaths)\n        directories.delete(browserDirectory);\n      for (const directory of directories)\n        logPolitely('Removing unused browser at ' + directory);\n      await removeFolders([...directories]);\n    }\n  }\n}\n\nexport function browserDirectoryToMarkerFilePath(browserDirectory: string): string {\n  return path.join(browserDirectory, 'INSTALLATION_COMPLETE');\n}\n\nexport function buildPlaywrightCLICommand(sdkLanguage: string, parameters: string): string {\n  switch (sdkLanguage) {\n    case 'python':\n      return `playwright ${parameters}`;\n    case 'java':\n      return `mvn exec:java -e -D exec.mainClass=com.microsoft.playwright.CLI -D exec.args=\"${parameters}\"`;\n    case 'csharp':\n      return `pwsh bin/Debug/netX/playwright.ps1 ${parameters}`;\n    default: {\n      const packageManagerCommand = getPackageManagerExecCommand();\n      return `${packageManagerCommand} playwright ${parameters}`;\n    }\n  }\n}\n\nexport async function installDefaultBrowsersForNpmInstall() {\n  const defaultBrowserNames = registry.defaultExecutables().map(e => e.name);\n  return installBrowsersForNpmInstall(defaultBrowserNames);\n}\n\nexport async function installBrowsersForNpmInstall(browsers: string[]) {\n  // PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD should have a value of 0 or 1\n  if (getAsBooleanFromENV('PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD')) {\n    logPolitely('Skipping browsers download because `PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD` env variable is set');\n    return false;\n  }\n  const executables: Executable[] = [];\n  for (const browserName of browsers) {\n    const executable = registry.findExecutable(browserName);\n    if (!executable || executable.installType === 'none')\n      throw new Error(`Cannot install ${browserName}`);\n    executables.push(executable);\n  }\n\n  await registry.install(executables, false /* forceReinstall */);\n}\n\nexport function findChromiumChannel(sdkLanguage: string): string | undefined {\n  // Fall back to the stable channels of popular vendors to work out of the box.\n  // Null means no installation and no channels found.\n  let channel = null;\n  for (const name of ['chromium', 'chrome', 'msedge']) {\n    try {\n      registry.findExecutable(name)!.executablePathOrDie(sdkLanguage);\n      channel = name === 'chromium' ? undefined : name;\n      break;\n    } catch (e) {\n    }\n  }\n\n  if (channel === null) {\n    const installCommand = buildPlaywrightCLICommand(sdkLanguage, `install chromium`);\n    const prettyMessage = [\n      `No chromium-based browser found on the system.`,\n      `Please run the following command to download one:`,\n      ``,\n      `    ${installCommand}`,\n      ``,\n      `<3 Playwright Team`,\n    ].join('\\n');\n    throw new Error('\\n' + wrapInASCIIBox(prettyMessage, 1));\n  }\n  return channel;\n}\n\nfunction lowercaseAllKeys(json: any): any {\n  if (typeof json !== 'object' || !json)\n    return json;\n\n  if (Array.isArray(json))\n    return json.map(lowercaseAllKeys);\n\n  const result: any = {};\n  for (const [key, value] of Object.entries(json))\n    result[key.toLowerCase()] = lowercaseAllKeys(value);\n  return result;\n}\n\nexport const registry = new Registry(require('../../../browsers.json'));\n"],"mappings":"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"}