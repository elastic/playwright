{"version":3,"file":"playwright.js","names":["_android","require","_backendAdb","_chromium","_electron","_firefox","_selectors","_webkit","_instrumentation","_utils","_debugController","_bidiFirefox","Playwright","SdkObject","constructor","options","attribution","instrumentation","createInstrumentation","undefined","selectors","chromium","android","electron","bidi","firefox","webkit","debugController","_allPages","Set","_allBrowsers","playwright","addListener","onBrowserOpen","browser","add","onBrowserClose","delete","onPageOpen","page","onPageClose","onCallLog","sdkObject","metadata","logName","message","debugLogger","log","Chromium","BidiFirefox","Firefox","WebKit","Electron","Android","AdbBackend","Selectors","DebugController","hideHighlight","Promise","all","map","p","catch","allBrowsers","allPages","exports","createPlaywright"],"sources":["../../src/server/playwright.ts"],"sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Android } from './android/android';\nimport { AdbBackend } from './android/backendAdb';\nimport type { Browser } from './browser';\nimport { Chromium } from './chromium/chromium';\nimport { Electron } from './electron/electron';\nimport { Firefox } from './firefox/firefox';\nimport { Selectors } from './selectors';\nimport { WebKit } from './webkit/webkit';\nimport type { CallMetadata } from './instrumentation';\nimport { createInstrumentation, SdkObject } from './instrumentation';\nimport { debugLogger, type Language } from '../utils';\nimport type { Page } from './page';\nimport { DebugController } from './debugController';\nimport type { BrowserType } from './browserType';\nimport { BidiFirefox } from './bidi/bidiFirefox';\n\ntype PlaywrightOptions = {\n  socksProxyPort?: number;\n  sdkLanguage: Language;\n  isInternalPlaywright?: boolean;\n  isServer?: boolean;\n};\n\nexport class Playwright extends SdkObject {\n  readonly selectors: Selectors;\n  readonly chromium: BrowserType;\n  readonly android: Android;\n  readonly electron: Electron;\n  readonly bidi;\n  readonly firefox: BrowserType;\n  readonly webkit: BrowserType;\n  readonly options: PlaywrightOptions;\n  readonly debugController: DebugController;\n  private _allPages = new Set<Page>();\n  private _allBrowsers = new Set<Browser>();\n\n  constructor(options: PlaywrightOptions) {\n    super({ attribution: {}, instrumentation: createInstrumentation() } as any, undefined, 'Playwright');\n    this.options = options;\n    this.attribution.playwright = this;\n    this.instrumentation.addListener({\n      onBrowserOpen: browser => this._allBrowsers.add(browser),\n      onBrowserClose: browser => this._allBrowsers.delete(browser),\n      onPageOpen: page => this._allPages.add(page),\n      onPageClose: page => this._allPages.delete(page),\n      onCallLog: (sdkObject: SdkObject, metadata: CallMetadata, logName: string, message: string) => {\n        debugLogger.log(logName as any, message);\n      }\n    }, null);\n    this.chromium = new Chromium(this);\n    this.bidi = new BidiFirefox(this);\n    this.firefox = new Firefox(this);\n    this.webkit = new WebKit(this);\n    this.electron = new Electron(this);\n    this.android = new Android(this, new AdbBackend());\n    this.selectors = new Selectors();\n    this.debugController = new DebugController(this);\n  }\n\n  async hideHighlight() {\n    await Promise.all([...this._allPages].map(p => p.hideHighlight().catch(() => {})));\n  }\n\n  allBrowsers(): Browser[] {\n    return [...this._allBrowsers];\n  }\n\n  allPages(): Page[] {\n    return [...this._allPages];\n  }\n}\n\nexport function createPlaywright(options: PlaywrightOptions) {\n  return new Playwright(options);\n}\n"],"mappings":"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"}