{"version":3,"file":"javascript.js","names":["_language","require","_deviceDescriptors","_utils","JavaScriptLanguageGenerator","constructor","isTest","id","groupName","name","highlighter","_isTest","generateAction","actionInContext","action","pageAlias","frame","formatter","JavaScriptFormatter","add","url","quote","format","locators","framePath","map","selector","_asLocator","subject","join","signals","toSignalMap","dialog","popup","popupAlias","download","downloadAlias","wrapWithStep","description","_generateActionCall","Error","method","clickCount","options","toClickOptions","optionsString","formatOptions","text","formatObject","files","length","modifiers","toKeyboardModifiers","shortcut","key","substring","checked","assertion","value","asLocator","generateHeader","generateTestHeader","generateStandaloneHeader","generateFooter","saveStorage","generateTestFooter","generateStandaloneFooter","useText","formatContextOptions","contextOptions","deviceName","browserName","formatObjectOrVoid","launchOptions","storageStateLine","exports","hasArguments","keys","Object","indent","Array","isArray","o","filter","undefined","sort","tokens","push","String","result","device","deviceDescriptors","serializedObject","sanitizeDeviceOptions","lines","split","splice","offset","_baseIndent","_baseOffset","_lines","repeat","prepend","trim","line","concat","newLine","spaces","previousLine","startsWith","extraSpaces","test","callCarryOver","endsWith","escapeWithQuotes","body"],"sources":["../../../src/server/codegen/javascript.ts"],"sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { BrowserContextOptions } from '../../../types/types';\nimport type { ActionInContext, Language, LanguageGenerator, LanguageGeneratorOptions } from './types';\nimport { sanitizeDeviceOptions, toSignalMap, toKeyboardModifiers, toClickOptions } from './language';\nimport { deviceDescriptors } from '../deviceDescriptors';\nimport { escapeWithQuotes, asLocator } from '../../utils';\n\nexport class JavaScriptLanguageGenerator implements LanguageGenerator {\n  id: string;\n  groupName = 'Node.js';\n  name: string;\n  highlighter = 'javascript' as Language;\n  private _isTest: boolean;\n\n  constructor(isTest: boolean) {\n    this.id = isTest ? 'playwright-test' : 'javascript';\n    this.name = isTest ? 'Test Runner' : 'Library';\n    this._isTest = isTest;\n  }\n\n  generateAction(actionInContext: ActionInContext): string {\n    const action = actionInContext.action;\n    if (this._isTest && (action.name === 'openPage' || action.name === 'closePage'))\n      return '';\n\n    const pageAlias = actionInContext.frame.pageAlias;\n    const formatter = new JavaScriptFormatter(2);\n\n    if (action.name === 'openPage') {\n      formatter.add(`const ${pageAlias} = await context.newPage();`);\n      if (action.url && action.url !== 'about:blank' && action.url !== 'chrome://newtab/')\n        formatter.add(`await ${pageAlias}.goto(${quote(action.url)});`);\n      return formatter.format();\n    }\n\n    const locators = actionInContext.frame.framePath.map(selector => `.${this._asLocator(selector)}.contentFrame()`);\n    const subject = `${pageAlias}${locators.join('')}`;\n    const signals = toSignalMap(action);\n\n    if (signals.dialog) {\n      formatter.add(`  ${pageAlias}.once('dialog', dialog => {\n    console.log(\\`Dialog message: $\\{dialog.message()}\\`);\n    dialog.dismiss().catch(() => {});\n  });`);\n    }\n\n    if (signals.popup)\n      formatter.add(`const ${signals.popup.popupAlias}Promise = ${pageAlias}.waitForEvent('popup');`);\n    if (signals.download)\n      formatter.add(`const download${signals.download.downloadAlias}Promise = ${pageAlias}.waitForEvent('download');`);\n\n    formatter.add(wrapWithStep(actionInContext.description, this._generateActionCall(subject, actionInContext)));\n\n    if (signals.popup)\n      formatter.add(`const ${signals.popup.popupAlias} = await ${signals.popup.popupAlias}Promise;`);\n    if (signals.download)\n      formatter.add(`const download${signals.download.downloadAlias} = await download${signals.download.downloadAlias}Promise;`);\n\n    return formatter.format();\n  }\n\n  private _generateActionCall(subject: string, actionInContext: ActionInContext): string {\n    const action = actionInContext.action;\n    switch (action.name) {\n      case 'openPage':\n        throw Error('Not reached');\n      case 'closePage':\n        return `await ${subject}.close();`;\n      case 'click': {\n        let method = 'click';\n        if (action.clickCount === 2)\n          method = 'dblclick';\n        const options = toClickOptions(action);\n        const optionsString = formatOptions(options, false);\n        return `await ${subject}.${this._asLocator(action.selector)}.${method}(${optionsString});`;\n      }\n      case 'check':\n        return `await ${subject}.${this._asLocator(action.selector)}.check();`;\n      case 'uncheck':\n        return `await ${subject}.${this._asLocator(action.selector)}.uncheck();`;\n      case 'fill':\n        return `await ${subject}.${this._asLocator(action.selector)}.fill(${quote(action.text)});`;\n      case 'setInputFiles':\n        return `await ${subject}.${this._asLocator(action.selector)}.setInputFiles(${formatObject(action.files.length === 1 ? action.files[0] : action.files)});`;\n      case 'press': {\n        const modifiers = toKeyboardModifiers(action.modifiers);\n        const shortcut = [...modifiers, action.key].join('+');\n        return `await ${subject}.${this._asLocator(action.selector)}.press(${quote(shortcut)});`;\n      }\n      case 'navigate':\n        return `await ${subject}.goto(${quote(action.url)});`;\n      case 'select':\n        return `await ${subject}.${this._asLocator(action.selector)}.selectOption(${formatObject(action.options.length > 1 ? action.options : action.options[0])});`;\n      case 'assertText':\n        return `${this._isTest ? '' : '// '}await expect(${subject}.${this._asLocator(action.selector)}).${action.substring ? 'toContainText' : 'toHaveText'}(${quote(action.text)});`;\n      case 'assertChecked':\n        return `${this._isTest ? '' : '// '}await expect(${subject}.${this._asLocator(action.selector)})${action.checked ? '' : '.not'}.toBeChecked();`;\n      case 'assertVisible':\n        return `${this._isTest ? '' : '// '}await expect(${subject}.${this._asLocator(action.selector)}).toBeVisible();`;\n      case 'assertValue': {\n        const assertion = action.value ? `toHaveValue(${quote(action.value)})` : `toBeEmpty()`;\n        return `${this._isTest ? '' : '// '}await expect(${subject}.${this._asLocator(action.selector)}).${assertion};`;\n      }\n    }\n  }\n\n  private _asLocator(selector: string) {\n    return asLocator('javascript', selector);\n  }\n\n  generateHeader(options: LanguageGeneratorOptions): string {\n    if (this._isTest)\n      return this.generateTestHeader(options);\n    return this.generateStandaloneHeader(options);\n  }\n\n  generateFooter(saveStorage: string | undefined): string {\n    if (this._isTest)\n      return this.generateTestFooter(saveStorage);\n    return this.generateStandaloneFooter(saveStorage);\n  }\n\n  generateTestHeader(options: LanguageGeneratorOptions): string {\n    const formatter = new JavaScriptFormatter();\n    const useText = formatContextOptions(options.contextOptions, options.deviceName);\n    formatter.add(`\n      import { test, expect${options.deviceName ? ', devices' : ''} } from '@playwright/test';\n${useText ? '\\ntest.use(' + useText + ');\\n' : ''}\n      test('test', async ({ page }) => {`);\n    return formatter.format();\n  }\n\n  generateTestFooter(saveStorage: string | undefined): string {\n    return `});`;\n  }\n\n  generateStandaloneHeader(options: LanguageGeneratorOptions): string {\n    const formatter = new JavaScriptFormatter();\n    formatter.add(`\n      const { ${options.browserName}${options.deviceName ? ', devices' : ''} } = require('playwright');\n\n      (async () => {\n        const browser = await ${options.browserName}.launch(${formatObjectOrVoid(options.launchOptions)});\n        const context = await browser.newContext(${formatContextOptions(options.contextOptions, options.deviceName)});`);\n    return formatter.format();\n  }\n\n  generateStandaloneFooter(saveStorage: string | undefined): string {\n    const storageStateLine = saveStorage ? `\\n  await context.storageState({ path: ${quote(saveStorage)} });` : '';\n    return `\\n  // ---------------------${storageStateLine}\n  await context.close();\n  await browser.close();\n})();`;\n  }\n}\n\nfunction formatOptions(value: any, hasArguments: boolean): string {\n  const keys = Object.keys(value);\n  if (!keys.length)\n    return '';\n  return (hasArguments ? ', ' : '') + formatObject(value);\n}\n\nfunction formatObject(value: any, indent = '  '): string {\n  if (typeof value === 'string')\n    return quote(value);\n  if (Array.isArray(value))\n    return `[${value.map(o => formatObject(o)).join(', ')}]`;\n  if (typeof value === 'object') {\n    const keys = Object.keys(value).filter(key => value[key] !== undefined).sort();\n    if (!keys.length)\n      return '{}';\n    const tokens: string[] = [];\n    for (const key of keys)\n      tokens.push(`${key}: ${formatObject(value[key])}`);\n    return `{\\n${indent}${tokens.join(`,\\n${indent}`)}\\n}`;\n  }\n  return String(value);\n}\n\nfunction formatObjectOrVoid(value: any, indent = '  '): string {\n  const result = formatObject(value, indent);\n  return result === '{}' ? '' : result;\n}\n\nfunction formatContextOptions(options: BrowserContextOptions, deviceName: string | undefined): string {\n  const device = deviceName && deviceDescriptors[deviceName];\n  if (!device)\n    return formatObjectOrVoid(options);\n  // Filter out all the properties from the device descriptor.\n  let serializedObject = formatObjectOrVoid(sanitizeDeviceOptions(device, options));\n  // When there are no additional context options, we still want to spread the device inside.\n  if (!serializedObject)\n    serializedObject = '{\\n}';\n  const lines = serializedObject.split('\\n');\n  lines.splice(1, 0, `...devices[${quote(deviceName!)}],`);\n  return lines.join('\\n');\n}\n\nexport class JavaScriptFormatter {\n  private _baseIndent: string;\n  private _baseOffset: string;\n  private _lines: string[] = [];\n\n  constructor(offset = 0) {\n    this._baseIndent = ' '.repeat(2);\n    this._baseOffset = ' '.repeat(offset);\n  }\n\n  prepend(text: string) {\n    this._lines = text.trim().split('\\n').map(line => line.trim()).concat(this._lines);\n  }\n\n  add(text: string) {\n    this._lines.push(...text.trim().split('\\n').map(line => line.trim()));\n  }\n\n  newLine() {\n    this._lines.push('');\n  }\n\n  format(): string {\n    let spaces = '';\n    let previousLine = '';\n    return this._lines.map((line: string) => {\n      if (line === '')\n        return line;\n      if (line.startsWith('}') || line.startsWith(']'))\n        spaces = spaces.substring(this._baseIndent.length);\n\n      const extraSpaces = /^(for|while|if|try).*\\(.*\\)$/.test(previousLine) ? this._baseIndent : '';\n      previousLine = line;\n\n      const callCarryOver = line.startsWith('.set');\n      line = spaces + extraSpaces + (callCarryOver ? this._baseIndent : '') + line;\n      if (line.endsWith('{') || line.endsWith('['))\n        spaces += this._baseIndent;\n      return this._baseOffset + line;\n    }).join('\\n');\n  }\n}\n\nfunction quote(text: string) {\n  return escapeWithQuotes(text, '\\'');\n}\n\nfunction wrapWithStep(description: string | undefined, body: string) {\n  return description ? `await test.step(\\`${description}\\`, async () => {\n${body}\n});` : body;\n}\n"],"mappings":";;;;;;AAkBA,IAAAA,SAAA,GAAAC,OAAA;AACA,IAAAC,kBAAA,GAAAD,OAAA;AACA,IAAAE,MAAA,GAAAF,OAAA;AApBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAQO,MAAMG,2BAA2B,CAA8B;EAOpEC,WAAWA,CAACC,MAAe,EAAE;IAAA,KAN7BC,EAAE;IAAA,KACFC,SAAS,GAAG,SAAS;IAAA,KACrBC,IAAI;IAAA,KACJC,WAAW,GAAG,YAAY;IAAA,KAClBC,OAAO;IAGb,IAAI,CAACJ,EAAE,GAAGD,MAAM,GAAG,iBAAiB,GAAG,YAAY;IACnD,IAAI,CAACG,IAAI,GAAGH,MAAM,GAAG,aAAa,GAAG,SAAS;IAC9C,IAAI,CAACK,OAAO,GAAGL,MAAM;EACvB;EAEAM,cAAcA,CAACC,eAAgC,EAAU;IACvD,MAAMC,MAAM,GAAGD,eAAe,CAACC,MAAM;IACrC,IAAI,IAAI,CAACH,OAAO,KAAKG,MAAM,CAACL,IAAI,KAAK,UAAU,IAAIK,MAAM,CAACL,IAAI,KAAK,WAAW,CAAC,EAC7E,OAAO,EAAE;IAEX,MAAMM,SAAS,GAAGF,eAAe,CAACG,KAAK,CAACD,SAAS;IACjD,MAAME,SAAS,GAAG,IAAIC,mBAAmB,CAAC,CAAC,CAAC;IAE5C,IAAIJ,MAAM,CAACL,IAAI,KAAK,UAAU,EAAE;MAC9BQ,SAAS,CAACE,GAAG,CAAE,SAAQJ,SAAU,6BAA4B,CAAC;MAC9D,IAAID,MAAM,CAACM,GAAG,IAAIN,MAAM,CAACM,GAAG,KAAK,aAAa,IAAIN,MAAM,CAACM,GAAG,KAAK,kBAAkB,EACjFH,SAAS,CAACE,GAAG,CAAE,SAAQJ,SAAU,SAAQM,KAAK,CAACP,MAAM,CAACM,GAAG,CAAE,IAAG,CAAC;MACjE,OAAOH,SAAS,CAACK,MAAM,CAAC,CAAC;IAC3B;IAEA,MAAMC,QAAQ,GAAGV,eAAe,CAACG,KAAK,CAACQ,SAAS,CAACC,GAAG,CAACC,QAAQ,IAAK,IAAG,IAAI,CAACC,UAAU,CAACD,QAAQ,CAAE,iBAAgB,CAAC;IAChH,MAAME,OAAO,GAAI,GAAEb,SAAU,GAAEQ,QAAQ,CAACM,IAAI,CAAC,EAAE,CAAE,EAAC;IAClD,MAAMC,OAAO,GAAG,IAAAC,qBAAW,EAACjB,MAAM,CAAC;IAEnC,IAAIgB,OAAO,CAACE,MAAM,EAAE;MAClBf,SAAS,CAACE,GAAG,CAAE,KAAIJ,SAAU;AACnC;AACA;AACA,MAAM,CAAC;IACH;IAEA,IAAIe,OAAO,CAACG,KAAK,EACfhB,SAAS,CAACE,GAAG,CAAE,SAAQW,OAAO,CAACG,KAAK,CAACC,UAAW,aAAYnB,SAAU,yBAAwB,CAAC;IACjG,IAAIe,OAAO,CAACK,QAAQ,EAClBlB,SAAS,CAACE,GAAG,CAAE,iBAAgBW,OAAO,CAACK,QAAQ,CAACC,aAAc,aAAYrB,SAAU,4BAA2B,CAAC;IAElHE,SAAS,CAACE,GAAG,CAACkB,YAAY,CAACxB,eAAe,CAACyB,WAAW,EAAE,IAAI,CAACC,mBAAmB,CAACX,OAAO,EAAEf,eAAe,CAAC,CAAC,CAAC;IAE5G,IAAIiB,OAAO,CAACG,KAAK,EACfhB,SAAS,CAACE,GAAG,CAAE,SAAQW,OAAO,CAACG,KAAK,CAACC,UAAW,YAAWJ,OAAO,CAACG,KAAK,CAACC,UAAW,UAAS,CAAC;IAChG,IAAIJ,OAAO,CAACK,QAAQ,EAClBlB,SAAS,CAACE,GAAG,CAAE,iBAAgBW,OAAO,CAACK,QAAQ,CAACC,aAAc,oBAAmBN,OAAO,CAACK,QAAQ,CAACC,aAAc,UAAS,CAAC;IAE5H,OAAOnB,SAAS,CAACK,MAAM,CAAC,CAAC;EAC3B;EAEQiB,mBAAmBA,CAACX,OAAe,EAAEf,eAAgC,EAAU;IACrF,MAAMC,MAAM,GAAGD,eAAe,CAACC,MAAM;IACrC,QAAQA,MAAM,CAACL,IAAI;MACjB,KAAK,UAAU;QACb,MAAM+B,KAAK,CAAC,aAAa,CAAC;MAC5B,KAAK,WAAW;QACd,OAAQ,SAAQZ,OAAQ,WAAU;MACpC,KAAK,OAAO;QAAE;UACZ,IAAIa,MAAM,GAAG,OAAO;UACpB,IAAI3B,MAAM,CAAC4B,UAAU,KAAK,CAAC,EACzBD,MAAM,GAAG,UAAU;UACrB,MAAME,OAAO,GAAG,IAAAC,wBAAc,EAAC9B,MAAM,CAAC;UACtC,MAAM+B,aAAa,GAAGC,aAAa,CAACH,OAAO,EAAE,KAAK,CAAC;UACnD,OAAQ,SAAQf,OAAQ,IAAG,IAAI,CAACD,UAAU,CAACb,MAAM,CAACY,QAAQ,CAAE,IAAGe,MAAO,IAAGI,aAAc,IAAG;QAC5F;MACA,KAAK,OAAO;QACV,OAAQ,SAAQjB,OAAQ,IAAG,IAAI,CAACD,UAAU,CAACb,MAAM,CAACY,QAAQ,CAAE,WAAU;MACxE,KAAK,SAAS;QACZ,OAAQ,SAAQE,OAAQ,IAAG,IAAI,CAACD,UAAU,CAACb,MAAM,CAACY,QAAQ,CAAE,aAAY;MAC1E,KAAK,MAAM;QACT,OAAQ,SAAQE,OAAQ,IAAG,IAAI,CAACD,UAAU,CAACb,MAAM,CAACY,QAAQ,CAAE,SAAQL,KAAK,CAACP,MAAM,CAACiC,IAAI,CAAE,IAAG;MAC5F,KAAK,eAAe;QAClB,OAAQ,SAAQnB,OAAQ,IAAG,IAAI,CAACD,UAAU,CAACb,MAAM,CAACY,QAAQ,CAAE,kBAAiBsB,YAAY,CAAClC,MAAM,CAACmC,KAAK,CAACC,MAAM,KAAK,CAAC,GAAGpC,MAAM,CAACmC,KAAK,CAAC,CAAC,CAAC,GAAGnC,MAAM,CAACmC,KAAK,CAAE,IAAG;MAC3J,KAAK,OAAO;QAAE;UACZ,MAAME,SAAS,GAAG,IAAAC,6BAAmB,EAACtC,MAAM,CAACqC,SAAS,CAAC;UACvD,MAAME,QAAQ,GAAG,CAAC,GAAGF,SAAS,EAAErC,MAAM,CAACwC,GAAG,CAAC,CAACzB,IAAI,CAAC,GAAG,CAAC;UACrD,OAAQ,SAAQD,OAAQ,IAAG,IAAI,CAACD,UAAU,CAACb,MAAM,CAACY,QAAQ,CAAE,UAASL,KAAK,CAACgC,QAAQ,CAAE,IAAG;QAC1F;MACA,KAAK,UAAU;QACb,OAAQ,SAAQzB,OAAQ,SAAQP,KAAK,CAACP,MAAM,CAACM,GAAG,CAAE,IAAG;MACvD,KAAK,QAAQ;QACX,OAAQ,SAAQQ,OAAQ,IAAG,IAAI,CAACD,UAAU,CAACb,MAAM,CAACY,QAAQ,CAAE,iBAAgBsB,YAAY,CAAClC,MAAM,CAAC6B,OAAO,CAACO,MAAM,GAAG,CAAC,GAAGpC,MAAM,CAAC6B,OAAO,GAAG7B,MAAM,CAAC6B,OAAO,CAAC,CAAC,CAAC,CAAE,IAAG;MAC9J,KAAK,YAAY;QACf,OAAQ,GAAE,IAAI,CAAChC,OAAO,GAAG,EAAE,GAAG,KAAM,gBAAeiB,OAAQ,IAAG,IAAI,CAACD,UAAU,CAACb,MAAM,CAACY,QAAQ,CAAE,KAAIZ,MAAM,CAACyC,SAAS,GAAG,eAAe,GAAG,YAAa,IAAGlC,KAAK,CAACP,MAAM,CAACiC,IAAI,CAAE,IAAG;MAChL,KAAK,eAAe;QAClB,OAAQ,GAAE,IAAI,CAACpC,OAAO,GAAG,EAAE,GAAG,KAAM,gBAAeiB,OAAQ,IAAG,IAAI,CAACD,UAAU,CAACb,MAAM,CAACY,QAAQ,CAAE,IAAGZ,MAAM,CAAC0C,OAAO,GAAG,EAAE,GAAG,MAAO,iBAAgB;MACjJ,KAAK,eAAe;QAClB,OAAQ,GAAE,IAAI,CAAC7C,OAAO,GAAG,EAAE,GAAG,KAAM,gBAAeiB,OAAQ,IAAG,IAAI,CAACD,UAAU,CAACb,MAAM,CAACY,QAAQ,CAAE,kBAAiB;MAClH,KAAK,aAAa;QAAE;UAClB,MAAM+B,SAAS,GAAG3C,MAAM,CAAC4C,KAAK,GAAI,eAAcrC,KAAK,CAACP,MAAM,CAAC4C,KAAK,CAAE,GAAE,GAAI,aAAY;UACtF,OAAQ,GAAE,IAAI,CAAC/C,OAAO,GAAG,EAAE,GAAG,KAAM,gBAAeiB,OAAQ,IAAG,IAAI,CAACD,UAAU,CAACb,MAAM,CAACY,QAAQ,CAAE,KAAI+B,SAAU,GAAE;QACjH;IACF;EACF;EAEQ9B,UAAUA,CAACD,QAAgB,EAAE;IACnC,OAAO,IAAAiC,gBAAS,EAAC,YAAY,EAAEjC,QAAQ,CAAC;EAC1C;EAEAkC,cAAcA,CAACjB,OAAiC,EAAU;IACxD,IAAI,IAAI,CAAChC,OAAO,EACd,OAAO,IAAI,CAACkD,kBAAkB,CAAClB,OAAO,CAAC;IACzC,OAAO,IAAI,CAACmB,wBAAwB,CAACnB,OAAO,CAAC;EAC/C;EAEAoB,cAAcA,CAACC,WAA+B,EAAU;IACtD,IAAI,IAAI,CAACrD,OAAO,EACd,OAAO,IAAI,CAACsD,kBAAkB,CAACD,WAAW,CAAC;IAC7C,OAAO,IAAI,CAACE,wBAAwB,CAACF,WAAW,CAAC;EACnD;EAEAH,kBAAkBA,CAAClB,OAAiC,EAAU;IAC5D,MAAM1B,SAAS,GAAG,IAAIC,mBAAmB,CAAC,CAAC;IAC3C,MAAMiD,OAAO,GAAGC,oBAAoB,CAACzB,OAAO,CAAC0B,cAAc,EAAE1B,OAAO,CAAC2B,UAAU,CAAC;IAChFrD,SAAS,CAACE,GAAG,CAAE;AACnB,6BAA6BwB,OAAO,CAAC2B,UAAU,GAAG,WAAW,GAAG,EAAG;AACnE,EAAEH,OAAO,GAAG,aAAa,GAAGA,OAAO,GAAG,MAAM,GAAG,EAAG;AAClD,yCAAyC,CAAC;IACtC,OAAOlD,SAAS,CAACK,MAAM,CAAC,CAAC;EAC3B;EAEA2C,kBAAkBA,CAACD,WAA+B,EAAU;IAC1D,OAAQ,KAAI;EACd;EAEAF,wBAAwBA,CAACnB,OAAiC,EAAU;IAClE,MAAM1B,SAAS,GAAG,IAAIC,mBAAmB,CAAC,CAAC;IAC3CD,SAAS,CAACE,GAAG,CAAE;AACnB,gBAAgBwB,OAAO,CAAC4B,WAAY,GAAE5B,OAAO,CAAC2B,UAAU,GAAG,WAAW,GAAG,EAAG;AAC5E;AACA;AACA,gCAAgC3B,OAAO,CAAC4B,WAAY,WAAUC,kBAAkB,CAAC7B,OAAO,CAAC8B,aAAa,CAAE;AACxG,mDAAmDL,oBAAoB,CAACzB,OAAO,CAAC0B,cAAc,EAAE1B,OAAO,CAAC2B,UAAU,CAAE,IAAG,CAAC;IACpH,OAAOrD,SAAS,CAACK,MAAM,CAAC,CAAC;EAC3B;EAEA4C,wBAAwBA,CAACF,WAA+B,EAAU;IAChE,MAAMU,gBAAgB,GAAGV,WAAW,GAAI,0CAAyC3C,KAAK,CAAC2C,WAAW,CAAE,MAAK,GAAG,EAAE;IAC9G,OAAQ,+BAA8BU,gBAAiB;AAC3D;AACA;AACA,MAAM;EACJ;AACF;AAACC,OAAA,CAAAvE,2BAAA,GAAAA,2BAAA;AAED,SAAS0C,aAAaA,CAACY,KAAU,EAAEkB,YAAqB,EAAU;EAChE,MAAMC,IAAI,GAAGC,MAAM,CAACD,IAAI,CAACnB,KAAK,CAAC;EAC/B,IAAI,CAACmB,IAAI,CAAC3B,MAAM,EACd,OAAO,EAAE;EACX,OAAO,CAAC0B,YAAY,GAAG,IAAI,GAAG,EAAE,IAAI5B,YAAY,CAACU,KAAK,CAAC;AACzD;AAEA,SAASV,YAAYA,CAACU,KAAU,EAAEqB,MAAM,GAAG,IAAI,EAAU;EACvD,IAAI,OAAOrB,KAAK,KAAK,QAAQ,EAC3B,OAAOrC,KAAK,CAACqC,KAAK,CAAC;EACrB,IAAIsB,KAAK,CAACC,OAAO,CAACvB,KAAK,CAAC,EACtB,OAAQ,IAAGA,KAAK,CAACjC,GAAG,CAACyD,CAAC,IAAIlC,YAAY,CAACkC,CAAC,CAAC,CAAC,CAACrD,IAAI,CAAC,IAAI,CAAE,GAAE;EAC1D,IAAI,OAAO6B,KAAK,KAAK,QAAQ,EAAE;IAC7B,MAAMmB,IAAI,GAAGC,MAAM,CAACD,IAAI,CAACnB,KAAK,CAAC,CAACyB,MAAM,CAAC7B,GAAG,IAAII,KAAK,CAACJ,GAAG,CAAC,KAAK8B,SAAS,CAAC,CAACC,IAAI,CAAC,CAAC;IAC9E,IAAI,CAACR,IAAI,CAAC3B,MAAM,EACd,OAAO,IAAI;IACb,MAAMoC,MAAgB,GAAG,EAAE;IAC3B,KAAK,MAAMhC,GAAG,IAAIuB,IAAI,EACpBS,MAAM,CAACC,IAAI,CAAE,GAAEjC,GAAI,KAAIN,YAAY,CAACU,KAAK,CAACJ,GAAG,CAAC,CAAE,EAAC,CAAC;IACpD,OAAQ,MAAKyB,MAAO,GAAEO,MAAM,CAACzD,IAAI,CAAE,MAAKkD,MAAO,EAAC,CAAE,KAAI;EACxD;EACA,OAAOS,MAAM,CAAC9B,KAAK,CAAC;AACtB;AAEA,SAASc,kBAAkBA,CAACd,KAAU,EAAEqB,MAAM,GAAG,IAAI,EAAU;EAC7D,MAAMU,MAAM,GAAGzC,YAAY,CAACU,KAAK,EAAEqB,MAAM,CAAC;EAC1C,OAAOU,MAAM,KAAK,IAAI,GAAG,EAAE,GAAGA,MAAM;AACtC;AAEA,SAASrB,oBAAoBA,CAACzB,OAA8B,EAAE2B,UAA8B,EAAU;EACpG,MAAMoB,MAAM,GAAGpB,UAAU,IAAIqB,oCAAiB,CAACrB,UAAU,CAAC;EAC1D,IAAI,CAACoB,MAAM,EACT,OAAOlB,kBAAkB,CAAC7B,OAAO,CAAC;EACpC;EACA,IAAIiD,gBAAgB,GAAGpB,kBAAkB,CAAC,IAAAqB,+BAAqB,EAACH,MAAM,EAAE/C,OAAO,CAAC,CAAC;EACjF;EACA,IAAI,CAACiD,gBAAgB,EACnBA,gBAAgB,GAAG,MAAM;EAC3B,MAAME,KAAK,GAAGF,gBAAgB,CAACG,KAAK,CAAC,IAAI,CAAC;EAC1CD,KAAK,CAACE,MAAM,CAAC,CAAC,EAAE,CAAC,EAAG,cAAa3E,KAAK,CAACiD,UAAW,CAAE,IAAG,CAAC;EACxD,OAAOwB,KAAK,CAACjE,IAAI,CAAC,IAAI,CAAC;AACzB;AAEO,MAAMX,mBAAmB,CAAC;EAK/Bb,WAAWA,CAAC4F,MAAM,GAAG,CAAC,EAAE;IAAA,KAJhBC,WAAW;IAAA,KACXC,WAAW;IAAA,KACXC,MAAM,GAAa,EAAE;IAG3B,IAAI,CAACF,WAAW,GAAG,GAAG,CAACG,MAAM,CAAC,CAAC,CAAC;IAChC,IAAI,CAACF,WAAW,GAAG,GAAG,CAACE,MAAM,CAACJ,MAAM,CAAC;EACvC;EAEAK,OAAOA,CAACvD,IAAY,EAAE;IACpB,IAAI,CAACqD,MAAM,GAAGrD,IAAI,CAACwD,IAAI,CAAC,CAAC,CAACR,KAAK,CAAC,IAAI,CAAC,CAACtE,GAAG,CAAC+E,IAAI,IAAIA,IAAI,CAACD,IAAI,CAAC,CAAC,CAAC,CAACE,MAAM,CAAC,IAAI,CAACL,MAAM,CAAC;EACpF;EAEAjF,GAAGA,CAAC4B,IAAY,EAAE;IAChB,IAAI,CAACqD,MAAM,CAACb,IAAI,CAAC,GAAGxC,IAAI,CAACwD,IAAI,CAAC,CAAC,CAACR,KAAK,CAAC,IAAI,CAAC,CAACtE,GAAG,CAAC+E,IAAI,IAAIA,IAAI,CAACD,IAAI,CAAC,CAAC,CAAC,CAAC;EACvE;EAEAG,OAAOA,CAAA,EAAG;IACR,IAAI,CAACN,MAAM,CAACb,IAAI,CAAC,EAAE,CAAC;EACtB;EAEAjE,MAAMA,CAAA,EAAW;IACf,IAAIqF,MAAM,GAAG,EAAE;IACf,IAAIC,YAAY,GAAG,EAAE;IACrB,OAAO,IAAI,CAACR,MAAM,CAAC3E,GAAG,CAAE+E,IAAY,IAAK;MACvC,IAAIA,IAAI,KAAK,EAAE,EACb,OAAOA,IAAI;MACb,IAAIA,IAAI,CAACK,UAAU,CAAC,GAAG,CAAC,IAAIL,IAAI,CAACK,UAAU,CAAC,GAAG,CAAC,EAC9CF,MAAM,GAAGA,MAAM,CAACpD,SAAS,CAAC,IAAI,CAAC2C,WAAW,CAAChD,MAAM,CAAC;MAEpD,MAAM4D,WAAW,GAAG,8BAA8B,CAACC,IAAI,CAACH,YAAY,CAAC,GAAG,IAAI,CAACV,WAAW,GAAG,EAAE;MAC7FU,YAAY,GAAGJ,IAAI;MAEnB,MAAMQ,aAAa,GAAGR,IAAI,CAACK,UAAU,CAAC,MAAM,CAAC;MAC7CL,IAAI,GAAGG,MAAM,GAAGG,WAAW,IAAIE,aAAa,GAAG,IAAI,CAACd,WAAW,GAAG,EAAE,CAAC,GAAGM,IAAI;MAC5E,IAAIA,IAAI,CAACS,QAAQ,CAAC,GAAG,CAAC,IAAIT,IAAI,CAACS,QAAQ,CAAC,GAAG,CAAC,EAC1CN,MAAM,IAAI,IAAI,CAACT,WAAW;MAC5B,OAAO,IAAI,CAACC,WAAW,GAAGK,IAAI;IAChC,CAAC,CAAC,CAAC3E,IAAI,CAAC,IAAI,CAAC;EACf;AACF;AAAC8C,OAAA,CAAAzD,mBAAA,GAAAA,mBAAA;AAED,SAASG,KAAKA,CAAC0B,IAAY,EAAE;EAC3B,OAAO,IAAAmE,uBAAgB,EAACnE,IAAI,EAAE,IAAI,CAAC;AACrC;AAEA,SAASV,YAAYA,CAACC,WAA+B,EAAE6E,IAAY,EAAE;EACnE,OAAO7E,WAAW,GAAI,qBAAoBA,WAAY;AACxD,EAAE6E,IAAK;AACP,IAAI,GAAGA,IAAI;AACX"}