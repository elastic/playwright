{"version":3,"file":"clock.js","names":["Clock","constructor","browserContext","_browserContext","install","options","_channel","clockInstall","time","undefined","parseTime","fastForward","ticks","clockFastForward","parseTicks","pauseAt","clockPauseAt","resume","clockResume","runFor","clockRunFor","setFixedTime","clockSetFixedTime","setSystemTime","clockSetSystemTime","exports","timeNumber","timeString","isFinite","getTime","Error","ticksNumber","ticksString"],"sources":["../../src/client/clock.ts"],"sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type * as api from '../../types/types';\nimport type { BrowserContext } from './browserContext';\n\nexport class Clock implements api.Clock {\n  private _browserContext: BrowserContext;\n\n  constructor(browserContext: BrowserContext) {\n    this._browserContext = browserContext;\n  }\n\n  async install(options: { time?: number | string | Date } = { }) {\n    await this._browserContext._channel.clockInstall(options.time !== undefined ? parseTime(options.time) : {});\n  }\n\n  async fastForward(ticks: number | string) {\n    await this._browserContext._channel.clockFastForward(parseTicks(ticks));\n  }\n\n  async pauseAt(time: number | string | Date) {\n    await this._browserContext._channel.clockPauseAt(parseTime(time));\n  }\n\n  async resume() {\n    await this._browserContext._channel.clockResume({});\n  }\n\n  async runFor(ticks: number | string) {\n    await this._browserContext._channel.clockRunFor(parseTicks(ticks));\n  }\n\n  async setFixedTime(time: string | number | Date) {\n    await this._browserContext._channel.clockSetFixedTime(parseTime(time));\n  }\n\n  async setSystemTime(time: string | number | Date) {\n    await this._browserContext._channel.clockSetSystemTime(parseTime(time));\n  }\n}\n\nfunction parseTime(time: string | number | Date): { timeNumber?: number, timeString?: string } {\n  if (typeof time === 'number')\n    return { timeNumber: time };\n  if (typeof time === 'string')\n    return { timeString: time };\n  if (!isFinite(time.getTime()))\n    throw new Error(`Invalid date: ${time}`);\n  return { timeNumber: time.getTime() };\n}\n\nfunction parseTicks(ticks: string | number): { ticksNumber?: number, ticksString?: string } {\n  return {\n    ticksNumber: typeof ticks === 'number' ? ticks : undefined,\n    ticksString: typeof ticks === 'string' ? ticks : undefined\n  };\n}\n"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAKO,MAAMA,KAAK,CAAsB;EAGtCC,WAAWA,CAACC,cAA8B,EAAE;IAAA,KAFpCC,eAAe;IAGrB,IAAI,CAACA,eAAe,GAAGD,cAAc;EACvC;EAEA,MAAME,OAAOA,CAACC,OAA0C,GAAG,CAAE,CAAC,EAAE;IAC9D,MAAM,IAAI,CAACF,eAAe,CAACG,QAAQ,CAACC,YAAY,CAACF,OAAO,CAACG,IAAI,KAAKC,SAAS,GAAGC,SAAS,CAACL,OAAO,CAACG,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;EAC7G;EAEA,MAAMG,WAAWA,CAACC,KAAsB,EAAE;IACxC,MAAM,IAAI,CAACT,eAAe,CAACG,QAAQ,CAACO,gBAAgB,CAACC,UAAU,CAACF,KAAK,CAAC,CAAC;EACzE;EAEA,MAAMG,OAAOA,CAACP,IAA4B,EAAE;IAC1C,MAAM,IAAI,CAACL,eAAe,CAACG,QAAQ,CAACU,YAAY,CAACN,SAAS,CAACF,IAAI,CAAC,CAAC;EACnE;EAEA,MAAMS,MAAMA,CAAA,EAAG;IACb,MAAM,IAAI,CAACd,eAAe,CAACG,QAAQ,CAACY,WAAW,CAAC,CAAC,CAAC,CAAC;EACrD;EAEA,MAAMC,MAAMA,CAACP,KAAsB,EAAE;IACnC,MAAM,IAAI,CAACT,eAAe,CAACG,QAAQ,CAACc,WAAW,CAACN,UAAU,CAACF,KAAK,CAAC,CAAC;EACpE;EAEA,MAAMS,YAAYA,CAACb,IAA4B,EAAE;IAC/C,MAAM,IAAI,CAACL,eAAe,CAACG,QAAQ,CAACgB,iBAAiB,CAACZ,SAAS,CAACF,IAAI,CAAC,CAAC;EACxE;EAEA,MAAMe,aAAaA,CAACf,IAA4B,EAAE;IAChD,MAAM,IAAI,CAACL,eAAe,CAACG,QAAQ,CAACkB,kBAAkB,CAACd,SAAS,CAACF,IAAI,CAAC,CAAC;EACzE;AACF;AAACiB,OAAA,CAAAzB,KAAA,GAAAA,KAAA;AAED,SAASU,SAASA,CAACF,IAA4B,EAAgD;EAC7F,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAC1B,OAAO;IAAEkB,UAAU,EAAElB;EAAK,CAAC;EAC7B,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAC1B,OAAO;IAAEmB,UAAU,EAAEnB;EAAK,CAAC;EAC7B,IAAI,CAACoB,QAAQ,CAACpB,IAAI,CAACqB,OAAO,CAAC,CAAC,CAAC,EAC3B,MAAM,IAAIC,KAAK,CAAE,iBAAgBtB,IAAK,EAAC,CAAC;EAC1C,OAAO;IAAEkB,UAAU,EAAElB,IAAI,CAACqB,OAAO,CAAC;EAAE,CAAC;AACvC;AAEA,SAASf,UAAUA,CAACF,KAAsB,EAAkD;EAC1F,OAAO;IACLmB,WAAW,EAAE,OAAOnB,KAAK,KAAK,QAAQ,GAAGA,KAAK,GAAGH,SAAS;IAC1DuB,WAAW,EAAE,OAAOpB,KAAK,KAAK,QAAQ,GAAGA,KAAK,GAAGH;EACnD,CAAC;AACH"}