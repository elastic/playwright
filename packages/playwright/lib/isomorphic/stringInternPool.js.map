{"version":3,"file":"stringInternPool.js","names":["StringInternPool","constructor","_stringCache","Map","internString","s","result","get","set","exports","JsonStringInternalizer","pool","_pool","traverse","value","Array","isArray","i","length","intern","name"],"sources":["../../src/isomorphic/stringInternPool.ts"],"sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport class StringInternPool {\n  private _stringCache = new Map<string, string>();\n\n  public internString(s: string): string {\n    let result = this._stringCache.get(s);\n    if (!result) {\n      this._stringCache.set(s, s);\n      result = s;\n    }\n    return result;\n  }\n}\n\nexport class JsonStringInternalizer {\n  private readonly _pool;\n\n  constructor(pool: StringInternPool) {\n    this._pool = pool;\n  }\n\n  traverse(value: any) {\n    if (typeof value !== 'object')\n      return;\n    if (Array.isArray(value)) {\n      for (let i = 0; i < value.length; i++) {\n        if (typeof value[i] === 'string')\n          value[i] = this.intern(value[i]);\n        else\n          this.traverse(value[i]);\n      }\n    } else {\n      for (const name in value) {\n        if (typeof value[name] === 'string')\n          value[name] = this.intern(value[name]);\n        else\n          this.traverse(value[name]);\n      }\n    }\n  }\n\n  private intern(value: string): string {\n    return this._pool.internString(value);\n  }\n}\n"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEO,MAAMA,gBAAgB,CAAC;EAAAC,YAAA;IAAA,KACpBC,YAAY,GAAG,IAAIC,GAAG,CAAiB,CAAC;EAAA;EAEzCC,YAAYA,CAACC,CAAS,EAAU;IACrC,IAAIC,MAAM,GAAG,IAAI,CAACJ,YAAY,CAACK,GAAG,CAACF,CAAC,CAAC;IACrC,IAAI,CAACC,MAAM,EAAE;MACX,IAAI,CAACJ,YAAY,CAACM,GAAG,CAACH,CAAC,EAAEA,CAAC,CAAC;MAC3BC,MAAM,GAAGD,CAAC;IACZ;IACA,OAAOC,MAAM;EACf;AACF;AAACG,OAAA,CAAAT,gBAAA,GAAAA,gBAAA;AAEM,MAAMU,sBAAsB,CAAC;EAGlCT,WAAWA,CAACU,IAAsB,EAAE;IAAA,KAFnBC,KAAK;IAGpB,IAAI,CAACA,KAAK,GAAGD,IAAI;EACnB;EAEAE,QAAQA,CAACC,KAAU,EAAE;IACnB,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAC3B;IACF,IAAIC,KAAK,CAACC,OAAO,CAACF,KAAK,CAAC,EAAE;MACxB,KAAK,IAAIG,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,KAAK,CAACI,MAAM,EAAED,CAAC,EAAE,EAAE;QACrC,IAAI,OAAOH,KAAK,CAACG,CAAC,CAAC,KAAK,QAAQ,EAC9BH,KAAK,CAACG,CAAC,CAAC,GAAG,IAAI,CAACE,MAAM,CAACL,KAAK,CAACG,CAAC,CAAC,CAAC,CAAC,KAEjC,IAAI,CAACJ,QAAQ,CAACC,KAAK,CAACG,CAAC,CAAC,CAAC;MAC3B;IACF,CAAC,MAAM;MACL,KAAK,MAAMG,IAAI,IAAIN,KAAK,EAAE;QACxB,IAAI,OAAOA,KAAK,CAACM,IAAI,CAAC,KAAK,QAAQ,EACjCN,KAAK,CAACM,IAAI,CAAC,GAAG,IAAI,CAACD,MAAM,CAACL,KAAK,CAACM,IAAI,CAAC,CAAC,CAAC,KAEvC,IAAI,CAACP,QAAQ,CAACC,KAAK,CAACM,IAAI,CAAC,CAAC;MAC9B;IACF;EACF;EAEQD,MAAMA,CAACL,KAAa,EAAU;IACpC,OAAO,IAAI,CAACF,KAAK,CAACR,YAAY,CAACU,KAAK,CAAC;EACvC;AACF;AAACL,OAAA,CAAAC,sBAAA,GAAAA,sBAAA"}