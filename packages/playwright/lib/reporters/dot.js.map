{"version":3,"file":"dot.js","names":["_base","require","DotReporter","BaseReporter","constructor","args","_counter","printsToStdio","onBegin","suite","console","log","generateStartingMessage","onStdOut","chunk","test","result","config","quiet","process","stdout","write","onStdErr","stderr","onTestEnd","status","colors","yellow","willRetry","gray","outcome","green","red","onError","error","formatError","enabled","message","onEnd","epilogue","_default","exports","default"],"sources":["../../src/reporters/dot.ts"],"sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { colors, BaseReporter, formatError } from './base';\nimport type { FullResult, TestCase, TestResult, Suite, TestError } from '../../types/testReporter';\n\nclass DotReporter extends BaseReporter {\n  private _counter = 0;\n\n  override printsToStdio() {\n    return true;\n  }\n\n  override onBegin(suite: Suite) {\n    super.onBegin(suite);\n    console.log(this.generateStartingMessage());\n  }\n\n  override onStdOut(chunk: string | Buffer, test?: TestCase, result?: TestResult) {\n    super.onStdOut(chunk, test, result);\n    if (!this.config.quiet)\n      process.stdout.write(chunk);\n  }\n\n  override onStdErr(chunk: string | Buffer, test?: TestCase, result?: TestResult) {\n    super.onStdErr(chunk, test, result);\n    if (!this.config.quiet)\n      process.stderr.write(chunk);\n  }\n\n  override onTestEnd(test: TestCase, result: TestResult) {\n    super.onTestEnd(test, result);\n    if (this._counter === 80) {\n      process.stdout.write('\\n');\n      this._counter = 0;\n    }\n    ++this._counter;\n    if (result.status === 'skipped') {\n      process.stdout.write(colors.yellow('°'));\n      return;\n    }\n    if (this.willRetry(test)) {\n      process.stdout.write(colors.gray('×'));\n      return;\n    }\n    switch (test.outcome()) {\n      case 'expected': process.stdout.write(colors.green('·')); break;\n      case 'unexpected': process.stdout.write(colors.red(result.status === 'timedOut' ? 'T' : 'F')); break;\n      case 'flaky': process.stdout.write(colors.yellow('±')); break;\n    }\n  }\n\n  override onError(error: TestError): void {\n    super.onError(error);\n    console.log('\\n' + formatError(error, colors.enabled).message);\n    this._counter = 0;\n  }\n\n  override async onEnd(result: FullResult) {\n    await super.onEnd(result);\n    process.stdout.write('\\n');\n    this.epilogue(true);\n  }\n}\n\nexport default DotReporter;\n"],"mappings":"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"}